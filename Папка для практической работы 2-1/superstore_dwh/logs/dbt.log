[0m12:21:59.597687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aadc1db57e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aadc0d68220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aadc0d681c0>]}


============================== 12:21:59.600233 | f8a0f34c-a91f-4232-8486-77c892168e2d ==============================
[0m12:21:59.600233 [info ] [MainThread]: Running with dbt=1.10.11
[0m12:21:59.600926 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'version_check': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'cache_selected_only': 'False', 'log_format': 'default', 'warn_error': 'None', 'invocation_command': 'dbt run', 'log_path': '/home/dev/Downloads/pde_magistr/superstore_dwh/logs', 'debug': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'target_path': 'None', 'introspect': 'True', 'partial_parse': 'True', 'write_json': 'True', 'fail_fast': 'False', 'profiles_dir': '/home/dev/.dbt'}
[0m12:21:59.782078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8a0f34c-a91f-4232-8486-77c892168e2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aadc382d3f0>]}
[0m12:21:59.843185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8a0f34c-a91f-4232-8486-77c892168e2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aadc0c44250>]}
[0m12:21:59.844120 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m12:21:59.955673 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m12:21:59.956448 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:21:59.957078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f8a0f34c-a91f-4232-8486-77c892168e2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aadc09b40a0>]}
[0m12:22:01.090630 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.superstore_dwh.stg_orders' (models/staging/stg_orders.sql) depends on a source named 'stg.orders' which was not found
[0m12:22:01.091757 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.5490327, "process_in_blocks": "72", "process_kernel_time": 0.110463, "process_mem_max_rss": "112348", "process_out_blocks": "8", "process_user_time": 2.496884}
[0m12:22:01.092344 [debug] [MainThread]: Command `dbt run` failed at 12:22:01.092241 after 1.55 seconds
[0m12:22:01.092827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aadc1db57e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aadbf59c3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aadbf591f00>]}
[0m12:22:01.093319 [debug] [MainThread]: Flushing usage events
[0m12:22:01.778238 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:25:50.173039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b8b74b17b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b8b6468cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b8b6468c70>]}


============================== 12:25:50.175632 | c073e0f0-ea7f-4b1d-9b97-ceab4157feeb ==============================
[0m12:25:50.175632 [info ] [MainThread]: Running with dbt=1.10.11
[0m12:25:50.176295 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'debug': 'False', 'use_colors': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'log_cache_events': 'False', 'no_print': 'None', 'printer_width': '80', 'profiles_dir': '/home/dev/.dbt', 'static_parser': 'True', 'empty': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/home/dev/Downloads/pde_magistr/superstore_dwh/logs', 'write_json': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'fail_fast': 'False', 'version_check': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:25:50.339467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c073e0f0-ea7f-4b1d-9b97-ceab4157feeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b8b640fe80>]}
[0m12:25:50.401858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c073e0f0-ea7f-4b1d-9b97-ceab4157feeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b8b6ce6bc0>]}
[0m12:25:50.402747 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m12:25:50.488762 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m12:25:50.489714 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:25:50.490259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c073e0f0-ea7f-4b1d-9b97-ceab4157feeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b8b6371f90>]}
[0m12:25:51.798676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c073e0f0-ea7f-4b1d-9b97-ceab4157feeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b8b418da50>]}
[0m12:25:51.893483 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/manifest.json
[0m12:25:51.895087 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/semantic_manifest.json
[0m12:25:51.916860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c073e0f0-ea7f-4b1d-9b97-ceab4157feeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b8b394acb0>]}
[0m12:25:51.917450 [info ] [MainThread]: Found 9 models, 4 data tests, 1 source, 434 macros
[0m12:25:51.917899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c073e0f0-ea7f-4b1d-9b97-ceab4157feeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b8b394b310>]}
[0m12:25:51.919706 [info ] [MainThread]: 
[0m12:25:51.920206 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:25:51.920600 [info ] [MainThread]: 
[0m12:25:51.921176 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:25:51.926684 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore'
[0m12:25:51.935182 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore'
[0m12:25:51.942861 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore'
[0m12:25:52.027087 [debug] [ThreadPool]: Using postgres connection "list_superstore"
[0m12:25:52.027603 [debug] [ThreadPool]: Using postgres connection "list_superstore"
[0m12:25:52.028077 [debug] [ThreadPool]: On list_superstore: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore"} */

    select distinct nspname from pg_namespace
  
[0m12:25:52.028522 [debug] [ThreadPool]: On list_superstore: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore"} */

    select distinct nspname from pg_namespace
  
[0m12:25:52.029336 [debug] [ThreadPool]: Using postgres connection "list_superstore"
[0m12:25:52.030181 [debug] [ThreadPool]: On list_superstore: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore"} */

    select distinct nspname from pg_namespace
  
[0m12:25:52.029786 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:25:52.028956 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:25:52.030600 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:25:52.041172 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.012 seconds
[0m12:25:52.043631 [debug] [ThreadPool]: On list_superstore: Close
[0m12:25:52.044269 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.014 seconds
[0m12:25:52.045652 [debug] [ThreadPool]: On list_superstore: Close
[0m12:25:52.046978 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.016 seconds
[0m12:25:52.048238 [debug] [ThreadPool]: On list_superstore: Close
[0m12:25:52.049166 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_superstore, now create_superstore_public_dw_test)
[0m12:25:52.051095 [debug] [ThreadPool]: Creating schema "database: "superstore"
schema: "public_dw_test"
"
[0m12:25:52.051790 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_superstore, now create_superstore_public_stg)
[0m12:25:52.057091 [debug] [ThreadPool]: Using postgres connection "create_superstore_public_dw_test"
[0m12:25:52.057816 [debug] [ThreadPool]: Creating schema "database: "superstore"
schema: "public_stg"
"
[0m12:25:52.058289 [debug] [ThreadPool]: On create_superstore_public_dw_test: BEGIN
[0m12:25:52.060654 [debug] [ThreadPool]: Using postgres connection "create_superstore_public_stg"
[0m12:25:52.061132 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:25:52.061609 [debug] [ThreadPool]: On create_superstore_public_stg: BEGIN
[0m12:25:52.062250 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:25:52.068452 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m12:25:52.068967 [debug] [ThreadPool]: Using postgres connection "create_superstore_public_dw_test"
[0m12:25:52.069381 [debug] [ThreadPool]: On create_superstore_public_dw_test: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "create_superstore_public_dw_test"} */
create schema if not exists "public_dw_test"
[0m12:25:52.070133 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m12:25:52.072064 [debug] [ThreadPool]: On create_superstore_public_dw_test: COMMIT
[0m12:25:52.073530 [debug] [ThreadPool]: Using postgres connection "create_superstore_public_dw_test"
[0m12:25:52.074034 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m12:25:52.074510 [debug] [ThreadPool]: On create_superstore_public_dw_test: COMMIT
[0m12:25:52.074954 [debug] [ThreadPool]: Using postgres connection "create_superstore_public_stg"
[0m12:25:52.075608 [debug] [ThreadPool]: On create_superstore_public_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "create_superstore_public_stg"} */
create schema if not exists "public_stg"
[0m12:25:52.076363 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m12:25:52.076992 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m12:25:52.077461 [debug] [ThreadPool]: On create_superstore_public_dw_test: Close
[0m12:25:52.078426 [debug] [ThreadPool]: On create_superstore_public_stg: COMMIT
[0m12:25:52.078986 [debug] [ThreadPool]: Using postgres connection "create_superstore_public_stg"
[0m12:25:52.079399 [debug] [ThreadPool]: On create_superstore_public_stg: COMMIT
[0m12:25:52.080983 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m12:25:52.081458 [debug] [ThreadPool]: On create_superstore_public_stg: Close
[0m12:25:52.084800 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_superstore_public_stg, now list_superstore_public_dw_test)
[0m12:25:52.085410 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_superstore_public_dw_test, now list_superstore_public_stg)
[0m12:25:52.091379 [debug] [ThreadPool]: Using postgres connection "list_superstore_public_dw_test"
[0m12:25:52.092144 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_superstore, now list_superstore_public)
[0m12:25:52.094571 [debug] [ThreadPool]: Using postgres connection "list_superstore_public_stg"
[0m12:25:52.095087 [debug] [ThreadPool]: On list_superstore_public_dw_test: BEGIN
[0m12:25:52.097624 [debug] [ThreadPool]: On list_superstore_public_stg: BEGIN
[0m12:25:52.097190 [debug] [ThreadPool]: Using postgres connection "list_superstore_public"
[0m12:25:52.098041 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:25:52.098895 [debug] [ThreadPool]: On list_superstore_public: BEGIN
[0m12:25:52.098461 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:25:52.099459 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:25:52.109359 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m12:25:52.109833 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m12:25:52.110263 [debug] [ThreadPool]: Using postgres connection "list_superstore_public_dw_test"
[0m12:25:52.111181 [debug] [ThreadPool]: On list_superstore_public_dw_test: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore_public_dw_test"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dw_test'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dw_test'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dw_test'
  
[0m12:25:52.110696 [debug] [ThreadPool]: Using postgres connection "list_superstore_public"
[0m12:25:52.111854 [debug] [ThreadPool]: On list_superstore_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore_public"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:25:52.113834 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m12:25:52.114362 [debug] [ThreadPool]: Using postgres connection "list_superstore_public_stg"
[0m12:25:52.114749 [debug] [ThreadPool]: On list_superstore_public_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore_public_stg"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_stg'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_stg'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_stg'
  
[0m12:25:52.142384 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.030 seconds
[0m12:25:52.144147 [debug] [ThreadPool]: On list_superstore_public: ROLLBACK
[0m12:25:52.144588 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.033 seconds
[0m12:25:52.144934 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.030 seconds
[0m12:25:52.146285 [debug] [ThreadPool]: On list_superstore_public_dw_test: ROLLBACK
[0m12:25:52.147408 [debug] [ThreadPool]: On list_superstore_public_stg: ROLLBACK
[0m12:25:52.148145 [debug] [ThreadPool]: On list_superstore_public: Close
[0m12:25:52.148676 [debug] [ThreadPool]: On list_superstore_public_dw_test: Close
[0m12:25:52.150397 [debug] [ThreadPool]: On list_superstore_public_stg: Close
[0m12:25:52.157951 [debug] [MainThread]: Using postgres connection "master"
[0m12:25:52.158472 [debug] [MainThread]: On master: BEGIN
[0m12:25:52.158897 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:25:52.165487 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m12:25:52.166016 [debug] [MainThread]: Using postgres connection "master"
[0m12:25:52.166420 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m12:25:52.211618 [debug] [MainThread]: SQL status: SELECT 0 in 0.045 seconds
[0m12:25:52.213375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c073e0f0-ea7f-4b1d-9b97-ceab4157feeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b8b4100700>]}
[0m12:25:52.214128 [debug] [MainThread]: On master: ROLLBACK
[0m12:25:52.215033 [debug] [MainThread]: Using postgres connection "master"
[0m12:25:52.215518 [debug] [MainThread]: On master: BEGIN
[0m12:25:52.216363 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:25:52.216791 [debug] [MainThread]: On master: COMMIT
[0m12:25:52.217167 [debug] [MainThread]: Using postgres connection "master"
[0m12:25:52.217523 [debug] [MainThread]: On master: COMMIT
[0m12:25:52.218131 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:25:52.218530 [debug] [MainThread]: On master: Close
[0m12:25:52.236988 [debug] [Thread-1 (]: Began running node model.superstore_dwh.calendar_dim
[0m12:25:52.237661 [info ] [Thread-1 (]: 1 of 9 START sql table model public_dw_test.calendar_dim ....................... [RUN]
[0m12:25:52.238218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_superstore_public_dw_test, now model.superstore_dwh.calendar_dim)
[0m12:25:52.238780 [debug] [Thread-2 (]: Began running node model.superstore_dwh.my_first_dbt_model
[0m12:25:52.239268 [debug] [Thread-1 (]: Began compiling node model.superstore_dwh.calendar_dim
[0m12:25:52.239875 [info ] [Thread-2 (]: 2 of 9 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m12:25:52.240507 [debug] [Thread-3 (]: Began running node model.superstore_dwh.stg_orders
[0m12:25:52.250373 [info ] [Thread-3 (]: 3 of 9 START sql view model public_stg.stg_orders .............................. [RUN]
[0m12:25:52.251310 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_superstore_public, now model.superstore_dwh.stg_orders)
[0m12:25:52.247809 [debug] [Thread-1 (]: Writing injected SQL for node "model.superstore_dwh.calendar_dim"
[0m12:25:52.249388 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_superstore_public_stg, now model.superstore_dwh.my_first_dbt_model)
[0m12:25:52.253279 [debug] [Thread-2 (]: Began compiling node model.superstore_dwh.my_first_dbt_model
[0m12:25:52.251783 [debug] [Thread-3 (]: Began compiling node model.superstore_dwh.stg_orders
[0m12:25:52.254002 [debug] [Thread-1 (]: Began executing node model.superstore_dwh.calendar_dim
[0m12:25:52.258986 [debug] [Thread-2 (]: Writing injected SQL for node "model.superstore_dwh.my_first_dbt_model"
[0m12:25:52.262837 [debug] [Thread-3 (]: Writing injected SQL for node "model.superstore_dwh.stg_orders"
[0m12:25:52.299441 [debug] [Thread-3 (]: Began executing node model.superstore_dwh.stg_orders
[0m12:25:52.322132 [debug] [Thread-1 (]: Writing runtime sql for node "model.superstore_dwh.calendar_dim"
[0m12:25:52.335076 [debug] [Thread-2 (]: Began executing node model.superstore_dwh.my_first_dbt_model
[0m12:25:52.341224 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.calendar_dim"
[0m12:25:52.341755 [debug] [Thread-1 (]: On model.superstore_dwh.calendar_dim: BEGIN
[0m12:25:52.342183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:25:52.340849 [debug] [Thread-2 (]: Writing runtime sql for node "model.superstore_dwh.my_first_dbt_model"
[0m12:25:52.344272 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.my_first_dbt_model"
[0m12:25:52.345326 [debug] [Thread-2 (]: On model.superstore_dwh.my_first_dbt_model: BEGIN
[0m12:25:52.344863 [debug] [Thread-3 (]: Writing runtime sql for node "model.superstore_dwh.stg_orders"
[0m12:25:52.347375 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.stg_orders"
[0m12:25:52.346077 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:25:52.347866 [debug] [Thread-3 (]: On model.superstore_dwh.stg_orders: BEGIN
[0m12:25:52.351417 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:25:52.363833 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m12:25:52.365471 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.calendar_dim"
[0m12:25:52.366478 [debug] [Thread-1 (]: On model.superstore_dwh.calendar_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.calendar_dim"} */

  
    

  create  table "superstore"."public_dw_test"."calendar_dim__dbt_tmp"
  
  
    as
  
  (
    -- Создает таблицу-календарь
SELECT
    to_char(date,'yyyymmdd')::int as dateid,
    extract('year' from date)::int as year,
    extract('quarter' from date)::int as quarter,
    extract('month' from date)::int as month,
    extract('week' from date)::int as week,
    date::date,
    to_char(date, 'dy') as week_day,
    -- Проверка на високосный год
    CASE
        WHEN extract('day' from (date + interval '2 month - 1 day')) = 29 THEN 'leap'
        ELSE 'not leap'
    END as leap
FROM generate_series(
    date '2010-01-01',
    date '2030-12-31',
    interval '1 day'
) AS t(date)
  );
  
[0m12:25:52.368292 [debug] [Thread-3 (]: SQL status: BEGIN in 0.017 seconds
[0m12:25:52.368893 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.stg_orders"
[0m12:25:52.369733 [debug] [Thread-3 (]: On model.superstore_dwh.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.stg_orders"} */

  create view "superstore"."public_stg"."stg_orders__dbt_tmp"
    
    
  as (
    -- models/staging/stg_orders.sql
-- Эта модель читает данные из исходной таблицы stg.orders,
-- приводит их к нужным типам и исправляет ошибку с почтовым кодом.
-- Все последующие модели будут ссылаться на эту, а не на исходную таблицу.

SELECT
    -- Приводим все к нижнему регистру для консистентности в dbt
    "order_id",
    ("order_date")::date as order_date,
    ("ship_date")::date as ship_date,
    "ship_mode",
    "customer_id",
    "customer_name",
    "segment",
    "country",
    "city",
    "state",
    -- Исправляем проблему с Burlington прямо здесь, один раз и навсегда
    CASE
        WHEN "city" = 'Burlington' AND "postal_code" IS NULL THEN '05401'
        ELSE "postal_code"
    END as postal_code,
    "region",
    "product_id",
    "category",
    "subcategory" as sub_category, -- переименовываем для соответствия
    "product_name",
    "sales",
    "quantity",
    "discount",
    "profit"
FROM "superstore"."stg"."orders"
  );
[0m12:25:52.370591 [debug] [Thread-2 (]: SQL status: BEGIN in 0.025 seconds
[0m12:25:52.371769 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.my_first_dbt_model"
[0m12:25:52.373617 [debug] [Thread-2 (]: On model.superstore_dwh.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.my_first_dbt_model"} */

  
    

  create  table "superstore"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m12:25:52.443236 [debug] [Thread-2 (]: SQL status: SELECT 2 in 0.069 seconds
[0m12:25:52.455103 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.my_first_dbt_model"
[0m12:25:52.456176 [debug] [Thread-2 (]: On model.superstore_dwh.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.my_first_dbt_model"} */
alter table "superstore"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m12:25:52.457137 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:25:52.470993 [debug] [Thread-2 (]: On model.superstore_dwh.my_first_dbt_model: COMMIT
[0m12:25:52.471625 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.my_first_dbt_model"
[0m12:25:52.472635 [debug] [Thread-2 (]: On model.superstore_dwh.my_first_dbt_model: COMMIT
[0m12:25:52.485996 [debug] [Thread-2 (]: SQL status: COMMIT in 0.013 seconds
[0m12:25:52.493223 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.122 seconds
[0m12:25:52.496525 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.stg_orders"
[0m12:25:52.497035 [debug] [Thread-2 (]: Applying DROP to: "superstore"."public"."my_first_dbt_model__dbt_backup"
[0m12:25:52.497574 [debug] [Thread-3 (]: On model.superstore_dwh.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.stg_orders"} */
alter table "superstore"."public_stg"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m12:25:52.502207 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.my_first_dbt_model"
[0m12:25:52.503103 [debug] [Thread-2 (]: On model.superstore_dwh.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.my_first_dbt_model"} */
drop table if exists "superstore"."public"."my_first_dbt_model__dbt_backup" cascade
[0m12:25:52.503558 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:25:52.505597 [debug] [Thread-3 (]: On model.superstore_dwh.stg_orders: COMMIT
[0m12:25:52.506042 [debug] [Thread-1 (]: SQL status: SELECT 7670 in 0.139 seconds
[0m12:25:52.506424 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m12:25:52.506991 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.stg_orders"
[0m12:25:52.511017 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.calendar_dim"
[0m12:25:52.515426 [debug] [Thread-1 (]: On model.superstore_dwh.calendar_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.calendar_dim"} */
alter table "superstore"."public_dw_test"."calendar_dim__dbt_tmp" rename to "calendar_dim"
[0m12:25:52.514913 [debug] [Thread-3 (]: On model.superstore_dwh.stg_orders: COMMIT
[0m12:25:52.514178 [debug] [Thread-2 (]: On model.superstore_dwh.my_first_dbt_model: Close
[0m12:25:52.517881 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c073e0f0-ea7f-4b1d-9b97-ceab4157feeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b8b4dc0e80>]}
[0m12:25:52.518642 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:25:52.519470 [info ] [Thread-2 (]: 2 of 9 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.27s]
[0m12:25:52.521686 [debug] [Thread-1 (]: On model.superstore_dwh.calendar_dim: COMMIT
[0m12:25:52.522242 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m12:25:52.523004 [debug] [Thread-2 (]: Finished running node model.superstore_dwh.my_first_dbt_model
[0m12:25:52.523574 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.calendar_dim"
[0m12:25:52.528121 [debug] [Thread-3 (]: Applying DROP to: "superstore"."public_stg"."stg_orders__dbt_backup"
[0m12:25:52.529058 [debug] [Thread-1 (]: On model.superstore_dwh.calendar_dim: COMMIT
[0m12:25:52.532108 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.stg_orders"
[0m12:25:52.533486 [debug] [Thread-4 (]: Began running node model.superstore_dwh.my_second_dbt_model
[0m12:25:52.535036 [info ] [Thread-4 (]: 4 of 9 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m12:25:52.534276 [debug] [Thread-3 (]: On model.superstore_dwh.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.stg_orders"} */
drop view if exists "superstore"."public_stg"."stg_orders__dbt_backup" cascade
[0m12:25:52.536198 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.superstore_dwh.my_second_dbt_model'
[0m12:25:52.536979 [debug] [Thread-4 (]: Began compiling node model.superstore_dwh.my_second_dbt_model
[0m12:25:52.537576 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:25:52.540500 [debug] [Thread-4 (]: Writing injected SQL for node "model.superstore_dwh.my_second_dbt_model"
[0m12:25:52.543642 [debug] [Thread-4 (]: Began executing node model.superstore_dwh.my_second_dbt_model
[0m12:25:52.542948 [debug] [Thread-3 (]: On model.superstore_dwh.stg_orders: Close
[0m12:25:52.541145 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m12:25:52.547775 [debug] [Thread-4 (]: Writing runtime sql for node "model.superstore_dwh.my_second_dbt_model"
[0m12:25:52.552132 [debug] [Thread-1 (]: Applying DROP to: "superstore"."public_dw_test"."calendar_dim__dbt_backup"
[0m12:25:52.556956 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c073e0f0-ea7f-4b1d-9b97-ceab4157feeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b8b39b7b20>]}
[0m12:25:52.557949 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.my_second_dbt_model"
[0m12:25:52.560509 [debug] [Thread-4 (]: On model.superstore_dwh.my_second_dbt_model: BEGIN
[0m12:25:52.560972 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:25:52.558974 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.calendar_dim"
[0m12:25:52.563123 [debug] [Thread-1 (]: On model.superstore_dwh.calendar_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.calendar_dim"} */
drop table if exists "superstore"."public_dw_test"."calendar_dim__dbt_backup" cascade
[0m12:25:52.559754 [info ] [Thread-3 (]: 3 of 9 OK created sql view model public_stg.stg_orders ......................... [[32mCREATE VIEW[0m in 0.31s]
[0m12:25:52.565360 [debug] [Thread-3 (]: Finished running node model.superstore_dwh.stg_orders
[0m12:25:52.567801 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m12:25:52.570351 [debug] [Thread-1 (]: On model.superstore_dwh.calendar_dim: Close
[0m12:25:52.571113 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c073e0f0-ea7f-4b1d-9b97-ceab4157feeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b8b49fda50>]}
[0m12:25:52.577031 [info ] [Thread-1 (]: 1 of 9 OK created sql table model public_dw_test.calendar_dim .................. [[32mSELECT 7670[0m in 0.33s]
[0m12:25:52.579250 [debug] [Thread-1 (]: Finished running node model.superstore_dwh.calendar_dim
[0m12:25:52.580311 [debug] [Thread-2 (]: Began running node model.superstore_dwh.customer_dim
[0m12:25:52.581760 [debug] [Thread-1 (]: Began running node model.superstore_dwh.geo_dim
[0m12:25:52.582228 [debug] [Thread-3 (]: Began running node model.superstore_dwh.product_dim
[0m12:25:52.584282 [info ] [Thread-2 (]: 5 of 9 START sql table model public_dw_test.customer_dim ....................... [RUN]
[0m12:25:52.588801 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.my_first_dbt_model, now model.superstore_dwh.customer_dim)
[0m12:25:52.582969 [debug] [Thread-4 (]: SQL status: BEGIN in 0.022 seconds
[0m12:25:52.590126 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.my_second_dbt_model"
[0m12:25:52.590680 [debug] [Thread-4 (]: On model.superstore_dwh.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.my_second_dbt_model"} */

  create view "superstore"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "superstore"."public"."my_first_dbt_model"
where id = 1
  );
[0m12:25:52.585223 [info ] [Thread-1 (]: 6 of 9 START sql table model public_dw_test.geo_dim ............................ [RUN]
[0m12:25:52.591678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.calendar_dim, now model.superstore_dwh.geo_dim)
[0m12:25:52.589390 [debug] [Thread-2 (]: Began compiling node model.superstore_dwh.customer_dim
[0m12:25:52.592194 [debug] [Thread-1 (]: Began compiling node model.superstore_dwh.geo_dim
[0m12:25:52.599895 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m12:25:52.586170 [info ] [Thread-3 (]: 7 of 9 START sql table model public_dw_test.product_dim ........................ [RUN]
[0m12:25:52.611133 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.stg_orders, now model.superstore_dwh.product_dim)
[0m12:25:52.611626 [debug] [Thread-3 (]: Began compiling node model.superstore_dwh.product_dim
[0m12:25:52.605881 [debug] [Thread-1 (]: Writing injected SQL for node "model.superstore_dwh.geo_dim"
[0m12:25:52.620813 [debug] [Thread-1 (]: Began executing node model.superstore_dwh.geo_dim
[0m12:25:52.610448 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.my_second_dbt_model"
[0m12:25:52.629272 [debug] [Thread-4 (]: On model.superstore_dwh.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.my_second_dbt_model"} */
alter table "superstore"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m12:25:52.600636 [debug] [Thread-2 (]: Writing injected SQL for node "model.superstore_dwh.customer_dim"
[0m12:25:52.630163 [debug] [Thread-2 (]: Began executing node model.superstore_dwh.customer_dim
[0m12:25:52.627338 [debug] [Thread-1 (]: Writing runtime sql for node "model.superstore_dwh.geo_dim"
[0m12:25:52.641889 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m12:25:52.641245 [debug] [Thread-2 (]: Writing runtime sql for node "model.superstore_dwh.customer_dim"
[0m12:25:52.640013 [debug] [Thread-3 (]: Writing injected SQL for node "model.superstore_dwh.product_dim"
[0m12:25:52.645966 [debug] [Thread-3 (]: Began executing node model.superstore_dwh.product_dim
[0m12:25:52.643612 [debug] [Thread-4 (]: On model.superstore_dwh.my_second_dbt_model: COMMIT
[0m12:25:52.653608 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.my_second_dbt_model"
[0m12:25:52.654362 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.customer_dim"
[0m12:25:52.654977 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.geo_dim"
[0m12:25:52.656657 [debug] [Thread-1 (]: On model.superstore_dwh.geo_dim: BEGIN
[0m12:25:52.657075 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:25:52.652234 [debug] [Thread-3 (]: Writing runtime sql for node "model.superstore_dwh.product_dim"
[0m12:25:52.656161 [debug] [Thread-2 (]: On model.superstore_dwh.customer_dim: BEGIN
[0m12:25:52.655547 [debug] [Thread-4 (]: On model.superstore_dwh.my_second_dbt_model: COMMIT
[0m12:25:52.659266 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.product_dim"
[0m12:25:52.660893 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:25:52.663028 [debug] [Thread-3 (]: On model.superstore_dwh.product_dim: BEGIN
[0m12:25:52.665814 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m12:25:52.671211 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:25:52.680475 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m12:25:52.682125 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.geo_dim"
[0m12:25:52.685715 [debug] [Thread-1 (]: On model.superstore_dwh.geo_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.geo_dim"} */

  
    

  create  table "superstore"."public_dw_test"."geo_dim__dbt_tmp"
  
  
    as
  
  (
    -- Создает географический справочник
SELECT
    100 + row_number() OVER (ORDER BY "postal_code", "city", "state") as geo_id,
    "country",
    "city",
    "state",
    "postal_code"
FROM (
    SELECT DISTINCT "country", "city", "state", "postal_code" FROM "superstore"."public_stg"."stg_orders"
) as unique_geo
  );
  
[0m12:25:52.689083 [debug] [Thread-4 (]: Applying DROP to: "superstore"."public"."my_second_dbt_model__dbt_backup"
[0m12:25:52.698061 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.my_second_dbt_model"
[0m12:25:52.700736 [debug] [Thread-4 (]: On model.superstore_dwh.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.my_second_dbt_model"} */
drop view if exists "superstore"."public"."my_second_dbt_model__dbt_backup" cascade
[0m12:25:52.701789 [debug] [Thread-2 (]: SQL status: BEGIN in 0.041 seconds
[0m12:25:52.702310 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.customer_dim"
[0m12:25:52.702815 [debug] [Thread-2 (]: On model.superstore_dwh.customer_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.customer_dim"} */

  
    

  create  table "superstore"."public_dw_test"."customer_dim__dbt_tmp"
  
  
    as
  
  (
    -- Создает справочник клиентов
SELECT
    100 + row_number() OVER (ORDER BY "customer_id") as cust_id,
    "customer_id",
    "customer_name"
FROM (
    SELECT DISTINCT "customer_id", "customer_name" FROM "superstore"."public_stg"."stg_orders"
) as unique_customers
  );
  
[0m12:25:52.704710 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.003 seconds
[0m12:25:52.706255 [debug] [Thread-4 (]: On model.superstore_dwh.my_second_dbt_model: Close
[0m12:25:52.707079 [debug] [Thread-1 (]: SQL status: SELECT 832 in 0.021 seconds
[0m12:25:52.707711 [debug] [Thread-3 (]: SQL status: BEGIN in 0.037 seconds
[0m12:25:52.712681 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.product_dim"
[0m12:25:52.714122 [debug] [Thread-3 (]: On model.superstore_dwh.product_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.product_dim"} */

  
    

  create  table "superstore"."public_dw_test"."product_dim__dbt_tmp"
  
  
    as
  
  (
    -- Создает справочник продуктов
SELECT
    100 + row_number() OVER (ORDER BY "product_id") as prod_id,
    "product_id",
    "product_name",
    "category",
    "sub_category",
    "segment"
FROM (
    SELECT DISTINCT "product_id", "product_name", "category", "sub_category", "segment" FROM "superstore"."public_stg"."stg_orders"
) as unique_products
  );
  
[0m12:25:52.713457 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c073e0f0-ea7f-4b1d-9b97-ceab4157feeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b8b51fd270>]}
[0m12:25:52.711590 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.geo_dim"
[0m12:25:52.718354 [debug] [Thread-1 (]: On model.superstore_dwh.geo_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.geo_dim"} */
alter table "superstore"."public_dw_test"."geo_dim__dbt_tmp" rename to "geo_dim"
[0m12:25:52.716785 [info ] [Thread-4 (]: 4 of 9 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.18s]
[0m12:25:52.720375 [debug] [Thread-4 (]: Finished running node model.superstore_dwh.my_second_dbt_model
[0m12:25:52.721150 [debug] [Thread-4 (]: Began running node model.superstore_dwh.shipping_dim
[0m12:25:52.721742 [info ] [Thread-4 (]: 8 of 9 START sql table model public_dw_test.shipping_dim ....................... [RUN]
[0m12:25:52.724455 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.my_second_dbt_model, now model.superstore_dwh.shipping_dim)
[0m12:25:52.725355 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m12:25:52.730121 [debug] [Thread-1 (]: On model.superstore_dwh.geo_dim: COMMIT
[0m12:25:52.727243 [debug] [Thread-2 (]: SQL status: SELECT 993 in 0.024 seconds
[0m12:25:52.727823 [debug] [Thread-4 (]: Began compiling node model.superstore_dwh.shipping_dim
[0m12:25:52.733829 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.geo_dim"
[0m12:25:52.754998 [debug] [Thread-1 (]: On model.superstore_dwh.geo_dim: COMMIT
[0m12:25:52.743322 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.customer_dim"
[0m12:25:52.756218 [debug] [Thread-2 (]: On model.superstore_dwh.customer_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.customer_dim"} */
alter table "superstore"."public_dw_test"."customer_dim__dbt_tmp" rename to "customer_dim"
[0m12:25:52.756836 [debug] [Thread-4 (]: Writing injected SQL for node "model.superstore_dwh.shipping_dim"
[0m12:25:52.758412 [debug] [Thread-4 (]: Began executing node model.superstore_dwh.shipping_dim
[0m12:25:52.757256 [debug] [Thread-3 (]: SQL status: SELECT 4544 in 0.043 seconds
[0m12:25:52.762620 [debug] [Thread-4 (]: Writing runtime sql for node "model.superstore_dwh.shipping_dim"
[0m12:25:52.763099 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m12:25:52.767642 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m12:25:52.767142 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.product_dim"
[0m12:25:52.774222 [debug] [Thread-3 (]: On model.superstore_dwh.product_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.product_dim"} */
alter table "superstore"."public_dw_test"."product_dim__dbt_tmp" rename to "product_dim"
[0m12:25:52.769573 [debug] [Thread-2 (]: On model.superstore_dwh.customer_dim: COMMIT
[0m12:25:52.775387 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.customer_dim"
[0m12:25:52.775835 [debug] [Thread-2 (]: On model.superstore_dwh.customer_dim: COMMIT
[0m12:25:52.774793 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.shipping_dim"
[0m12:25:52.776394 [debug] [Thread-4 (]: On model.superstore_dwh.shipping_dim: BEGIN
[0m12:25:52.773602 [debug] [Thread-1 (]: Applying DROP to: "superstore"."public_dw_test"."geo_dim__dbt_backup"
[0m12:25:52.776831 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:25:52.777697 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:25:52.778947 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.geo_dim"
[0m12:25:52.781913 [debug] [Thread-3 (]: On model.superstore_dwh.product_dim: COMMIT
[0m12:25:52.783211 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.product_dim"
[0m12:25:52.783736 [debug] [Thread-3 (]: On model.superstore_dwh.product_dim: COMMIT
[0m12:25:52.782646 [debug] [Thread-1 (]: On model.superstore_dwh.geo_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.geo_dim"} */
drop table if exists "superstore"."public_dw_test"."geo_dim__dbt_backup" cascade
[0m12:25:52.784317 [debug] [Thread-2 (]: SQL status: COMMIT in 0.008 seconds
[0m12:25:52.787802 [debug] [Thread-2 (]: Applying DROP to: "superstore"."public_dw_test"."customer_dim__dbt_backup"
[0m12:25:52.789765 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.customer_dim"
[0m12:25:52.788258 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m12:25:52.791725 [debug] [Thread-1 (]: On model.superstore_dwh.geo_dim: Close
[0m12:25:52.788682 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m12:25:52.790274 [debug] [Thread-2 (]: On model.superstore_dwh.customer_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.customer_dim"} */
drop table if exists "superstore"."public_dw_test"."customer_dim__dbt_backup" cascade
[0m12:25:52.798085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c073e0f0-ea7f-4b1d-9b97-ceab4157feeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b8b4d66aa0>]}
[0m12:25:52.798630 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.001 seconds
[0m12:25:52.797011 [debug] [Thread-3 (]: Applying DROP to: "superstore"."public_dw_test"."product_dim__dbt_backup"
[0m12:25:52.802819 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.product_dim"
[0m12:25:52.799437 [info ] [Thread-1 (]: 6 of 9 OK created sql table model public_dw_test.geo_dim ....................... [[32mSELECT 832[0m in 0.21s]
[0m12:25:52.801655 [debug] [Thread-2 (]: On model.superstore_dwh.customer_dim: Close
[0m12:25:52.805372 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c073e0f0-ea7f-4b1d-9b97-ceab4157feeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b8b4d02350>]}
[0m12:25:52.804507 [debug] [Thread-1 (]: Finished running node model.superstore_dwh.geo_dim
[0m12:25:52.803804 [debug] [Thread-3 (]: On model.superstore_dwh.product_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.product_dim"} */
drop table if exists "superstore"."public_dw_test"."product_dim__dbt_backup" cascade
[0m12:25:52.807224 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.000 seconds
[0m12:25:52.806234 [info ] [Thread-2 (]: 5 of 9 OK created sql table model public_dw_test.customer_dim .................. [[32mSELECT 993[0m in 0.22s]
[0m12:25:52.803288 [debug] [Thread-4 (]: SQL status: BEGIN in 0.026 seconds
[0m12:25:52.809142 [debug] [Thread-3 (]: On model.superstore_dwh.product_dim: Close
[0m12:25:52.809860 [debug] [Thread-2 (]: Finished running node model.superstore_dwh.customer_dim
[0m12:25:52.810355 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.shipping_dim"
[0m12:25:52.815629 [debug] [Thread-4 (]: On model.superstore_dwh.shipping_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.shipping_dim"} */

  
    

  create  table "superstore"."public_dw_test"."shipping_dim__dbt_tmp"
  
  
    as
  
  (
    -- Создает справочник видов доставки
SELECT
    100 + row_number() OVER (ORDER BY "ship_mode") as ship_id,
    "ship_mode"
FROM (
    SELECT DISTINCT "ship_mode" FROM "superstore"."public_stg"."stg_orders"
) as unique_shipping_modes
  );
  
[0m12:25:52.814799 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c073e0f0-ea7f-4b1d-9b97-ceab4157feeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b8b4d36350>]}
[0m12:25:52.816724 [info ] [Thread-3 (]: 7 of 9 OK created sql table model public_dw_test.product_dim ................... [[32mSELECT 4544[0m in 0.20s]
[0m12:25:52.817583 [debug] [Thread-3 (]: Finished running node model.superstore_dwh.product_dim
[0m12:25:52.823245 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.007 seconds
[0m12:25:52.829030 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.shipping_dim"
[0m12:25:52.829650 [debug] [Thread-4 (]: On model.superstore_dwh.shipping_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.shipping_dim"} */
alter table "superstore"."public_dw_test"."shipping_dim__dbt_tmp" rename to "shipping_dim"
[0m12:25:52.830639 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:25:52.832239 [debug] [Thread-4 (]: On model.superstore_dwh.shipping_dim: COMMIT
[0m12:25:52.835014 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.shipping_dim"
[0m12:25:52.835743 [debug] [Thread-4 (]: On model.superstore_dwh.shipping_dim: COMMIT
[0m12:25:52.837996 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m12:25:52.840871 [debug] [Thread-4 (]: Applying DROP to: "superstore"."public_dw_test"."shipping_dim__dbt_backup"
[0m12:25:52.842080 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.shipping_dim"
[0m12:25:52.842647 [debug] [Thread-4 (]: On model.superstore_dwh.shipping_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.shipping_dim"} */
drop table if exists "superstore"."public_dw_test"."shipping_dim__dbt_backup" cascade
[0m12:25:52.843439 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.000 seconds
[0m12:25:52.844788 [debug] [Thread-4 (]: On model.superstore_dwh.shipping_dim: Close
[0m12:25:52.846034 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c073e0f0-ea7f-4b1d-9b97-ceab4157feeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b8b1d9bf10>]}
[0m12:25:52.847176 [info ] [Thread-4 (]: 8 of 9 OK created sql table model public_dw_test.shipping_dim .................. [[32mSELECT 4[0m in 0.12s]
[0m12:25:52.848332 [debug] [Thread-4 (]: Finished running node model.superstore_dwh.shipping_dim
[0m12:25:52.849283 [debug] [Thread-1 (]: Began running node model.superstore_dwh.sales_fact
[0m12:25:52.850516 [info ] [Thread-1 (]: 9 of 9 START sql table model public_dw_test.sales_fact ......................... [RUN]
[0m12:25:52.851380 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.geo_dim, now model.superstore_dwh.sales_fact)
[0m12:25:52.852311 [debug] [Thread-1 (]: Began compiling node model.superstore_dwh.sales_fact
[0m12:25:52.857064 [debug] [Thread-1 (]: Writing injected SQL for node "model.superstore_dwh.sales_fact"
[0m12:25:52.857934 [debug] [Thread-1 (]: Began executing node model.superstore_dwh.sales_fact
[0m12:25:52.862129 [debug] [Thread-1 (]: Writing runtime sql for node "model.superstore_dwh.sales_fact"
[0m12:25:52.862955 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.sales_fact"
[0m12:25:52.863474 [debug] [Thread-1 (]: On model.superstore_dwh.sales_fact: BEGIN
[0m12:25:52.864001 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:25:52.870771 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m12:25:52.871354 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.sales_fact"
[0m12:25:52.871943 [debug] [Thread-1 (]: On model.superstore_dwh.sales_fact: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.sales_fact"} */

  
    

  create  table "superstore"."public_dw_test"."sales_fact__dbt_tmp"
  
  
    as
  
  (
    -- Создает таблицу фактов, объединяя все измерения
SELECT
    -- Суррогатные ключи из измерений
    cd.cust_id,
    pd.prod_id,
    sd.ship_id,
    gd.geo_id,
    -- Ключи для календаря
    to_char(o.order_date, 'yyyymmdd')::int AS order_date_id,
    to_char(o.ship_date, 'yyyymmdd')::int AS ship_date_id,
    -- Бизнес-ключ и метрики
    o.order_id,
    o.sales,
    o.profit,
    o.quantity,
    o.discount
FROM "superstore"."public_stg"."stg_orders" AS o
LEFT JOIN "superstore"."public_dw_test"."customer_dim" AS cd ON o.customer_id = cd.customer_id
LEFT JOIN "superstore"."public_dw_test"."product_dim" AS pd ON o.product_id = pd.product_id
LEFT JOIN "superstore"."public_dw_test"."shipping_dim" AS sd ON o.ship_mode = sd.ship_mode
LEFT JOIN "superstore"."public_dw_test"."geo_dim" AS gd ON o.postal_code = gd.postal_code AND o.city = gd.city AND o.state = gd.state
  );
  
[0m12:25:52.962455 [debug] [Thread-1 (]: SQL status: SELECT 25867 in 0.089 seconds
[0m12:25:52.966504 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.sales_fact"
[0m12:25:52.967103 [debug] [Thread-1 (]: On model.superstore_dwh.sales_fact: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.sales_fact"} */
alter table "superstore"."public_dw_test"."sales_fact__dbt_tmp" rename to "sales_fact"
[0m12:25:52.969779 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:25:52.971561 [debug] [Thread-1 (]: On model.superstore_dwh.sales_fact: COMMIT
[0m12:25:52.972799 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.sales_fact"
[0m12:25:52.973416 [debug] [Thread-1 (]: On model.superstore_dwh.sales_fact: COMMIT
[0m12:25:52.982226 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m12:25:52.986856 [debug] [Thread-1 (]: Applying DROP to: "superstore"."public_dw_test"."sales_fact__dbt_backup"
[0m12:25:52.990309 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.sales_fact"
[0m12:25:52.990803 [debug] [Thread-1 (]: On model.superstore_dwh.sales_fact: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.sales_fact"} */
drop table if exists "superstore"."public_dw_test"."sales_fact__dbt_backup" cascade
[0m12:25:52.993123 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m12:25:52.996175 [debug] [Thread-1 (]: On model.superstore_dwh.sales_fact: Close
[0m12:25:52.997012 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c073e0f0-ea7f-4b1d-9b97-ceab4157feeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b8b1dba0b0>]}
[0m12:25:52.997749 [info ] [Thread-1 (]: 9 of 9 OK created sql table model public_dw_test.sales_fact .................... [[32mSELECT 25867[0m in 0.15s]
[0m12:25:53.001178 [debug] [Thread-1 (]: Finished running node model.superstore_dwh.sales_fact
[0m12:25:53.002704 [debug] [MainThread]: Using postgres connection "master"
[0m12:25:53.004632 [debug] [MainThread]: On master: BEGIN
[0m12:25:53.005066 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:25:53.019559 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m12:25:53.021953 [debug] [MainThread]: On master: COMMIT
[0m12:25:53.022386 [debug] [MainThread]: Using postgres connection "master"
[0m12:25:53.022744 [debug] [MainThread]: On master: COMMIT
[0m12:25:53.023386 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:25:53.023819 [debug] [MainThread]: On master: Close
[0m12:25:53.027163 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:25:53.029281 [debug] [MainThread]: Connection 'model.superstore_dwh.customer_dim' was properly closed.
[0m12:25:53.029825 [debug] [MainThread]: Connection 'model.superstore_dwh.product_dim' was properly closed.
[0m12:25:53.030182 [debug] [MainThread]: Connection 'model.superstore_dwh.sales_fact' was properly closed.
[0m12:25:53.030543 [debug] [MainThread]: Connection 'model.superstore_dwh.shipping_dim' was properly closed.
[0m12:25:53.034628 [info ] [MainThread]: 
[0m12:25:53.035695 [info ] [MainThread]: Finished running 7 table models, 2 view models in 0 hours 0 minutes and 1.11 seconds (1.11s).
[0m12:25:53.039059 [debug] [MainThread]: Command end result
[0m12:25:53.098319 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/manifest.json
[0m12:25:53.104336 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/semantic_manifest.json
[0m12:25:53.123418 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dev/Downloads/pde_magistr/superstore_dwh/target/run_results.json
[0m12:25:53.123906 [info ] [MainThread]: 
[0m12:25:53.125376 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:25:53.126519 [info ] [MainThread]: 
[0m12:25:53.127619 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=9
[0m12:25:53.129209 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.0118573, "process_in_blocks": "88", "process_kernel_time": 0.239574, "process_mem_max_rss": "126468", "process_out_blocks": "3032", "process_user_time": 3.365971}
[0m12:25:53.129978 [debug] [MainThread]: Command `dbt run` succeeded at 12:25:53.129835 after 3.01 seconds
[0m12:25:53.130450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b8b74b17b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b8b640fe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b8b4d213f0>]}
[0m12:25:53.130944 [debug] [MainThread]: Flushing usage events
[0m12:25:54.012243 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:32:53.524274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e39a83ad6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e39a7360af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e39a7360a90>]}


============================== 12:32:53.526952 | 3ee3b34e-6240-4e9b-95a4-f47d4a5e124b ==============================
[0m12:32:53.526952 [info ] [MainThread]: Running with dbt=1.10.11
[0m12:32:53.527521 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'debug': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'use_experimental_parser': 'False', 'use_colors': 'True', 'empty': 'None', 'quiet': 'False', 'target_path': 'None', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'log_path': '/home/dev/Downloads/pde_magistr/superstore_dwh/logs', 'warn_error': 'None', 'printer_width': '80', 'write_json': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt clean', 'version_check': 'True', 'log_cache_events': 'False', 'profiles_dir': '/home/dev/.dbt'}
[0m12:32:53.658807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ee3b34e-6240-4e9b-95a4-f47d4a5e124b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e39a8270fa0>]}
[0m12:32:53.670340 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20312485, "process_in_blocks": "0", "process_kernel_time": 0.072869, "process_mem_max_rss": "96332", "process_out_blocks": "8", "process_user_time": 1.277705}
[0m12:32:53.670906 [debug] [MainThread]: Command `dbt clean` succeeded at 12:32:53.670807 after 0.20 seconds
[0m12:32:53.671342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e39a83ad6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e39a8270fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e39a72719f0>]}
[0m12:32:53.671893 [debug] [MainThread]: Flushing usage events
[0m12:32:54.366893 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:33:10.521493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f358b0a57e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f358a05cd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f358a05cca0>]}


============================== 12:33:10.524021 | 69a6ba34-b5b0-44c5-a1a3-ce79d20a129c ==============================
[0m12:33:10.524021 [info ] [MainThread]: Running with dbt=1.10.11
[0m12:33:10.524700 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'introspect': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/dev/.dbt', 'static_parser': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'version_check': 'True', 'no_print': 'None', 'invocation_command': 'dbt run', 'log_cache_events': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'debug': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'log_path': '/home/dev/Downloads/pde_magistr/superstore_dwh/logs', 'target_path': 'None', 'partial_parse': 'True'}
[0m12:33:10.686159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69a6ba34-b5b0-44c5-a1a3-ce79d20a129c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f358cb1d480>]}
[0m12:33:10.758388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '69a6ba34-b5b0-44c5-a1a3-ce79d20a129c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3589dcc400>]}
[0m12:33:10.760042 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m12:33:10.880985 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m12:33:10.881762 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:33:10.882203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '69a6ba34-b5b0-44c5-a1a3-ce79d20a129c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35899580a0>]}
[0m12:33:12.218088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '69a6ba34-b5b0-44c5-a1a3-ce79d20a129c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3587538130>]}
[0m12:33:12.313210 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/manifest.json
[0m12:33:12.314872 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/semantic_manifest.json
[0m12:33:12.325975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '69a6ba34-b5b0-44c5-a1a3-ce79d20a129c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3587517070>]}
[0m12:33:12.326564 [info ] [MainThread]: Found 9 models, 4 data tests, 1 source, 435 macros
[0m12:33:12.327030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69a6ba34-b5b0-44c5-a1a3-ce79d20a129c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3587516230>]}
[0m12:33:12.328877 [info ] [MainThread]: 
[0m12:33:12.329344 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:33:12.329819 [info ] [MainThread]: 
[0m12:33:12.330378 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:33:12.335234 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore'
[0m12:33:12.348478 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore'
[0m12:33:12.349869 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore'
[0m12:33:12.433678 [debug] [ThreadPool]: Using postgres connection "list_superstore"
[0m12:33:12.434178 [debug] [ThreadPool]: On list_superstore: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore"} */

    select distinct nspname from pg_namespace
  
[0m12:33:12.434688 [debug] [ThreadPool]: Using postgres connection "list_superstore"
[0m12:33:12.435095 [debug] [ThreadPool]: Using postgres connection "list_superstore"
[0m12:33:12.436410 [debug] [ThreadPool]: On list_superstore: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore"} */

    select distinct nspname from pg_namespace
  
[0m12:33:12.435979 [debug] [ThreadPool]: On list_superstore: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore"} */

    select distinct nspname from pg_namespace
  
[0m12:33:12.436805 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:33:12.435465 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:33:12.437237 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:33:12.450314 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.013 seconds
[0m12:33:12.453011 [debug] [ThreadPool]: On list_superstore: Close
[0m12:33:12.453900 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.018 seconds
[0m12:33:12.455281 [debug] [ThreadPool]: On list_superstore: Close
[0m12:33:12.455846 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.019 seconds
[0m12:33:12.457198 [debug] [ThreadPool]: On list_superstore: Close
[0m12:33:12.460889 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_superstore, now list_superstore_public)
[0m12:33:12.462556 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_superstore, now list_superstore_dw_test)
[0m12:33:12.461640 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_superstore, now list_superstore_stg)
[0m12:33:12.469201 [debug] [ThreadPool]: Using postgres connection "list_superstore_public"
[0m12:33:12.474323 [debug] [ThreadPool]: On list_superstore_public: BEGIN
[0m12:33:12.473721 [debug] [ThreadPool]: Using postgres connection "list_superstore_stg"
[0m12:33:12.475147 [debug] [ThreadPool]: On list_superstore_stg: BEGIN
[0m12:33:12.474752 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:33:12.471739 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_test"
[0m12:33:12.475532 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:33:12.476472 [debug] [ThreadPool]: On list_superstore_dw_test: BEGIN
[0m12:33:12.477380 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:33:12.485082 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m12:33:12.485662 [debug] [ThreadPool]: Using postgres connection "list_superstore_stg"
[0m12:33:12.486110 [debug] [ThreadPool]: On list_superstore_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore_stg"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'stg'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'stg'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'stg'
  
[0m12:33:12.489283 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m12:33:12.491176 [debug] [ThreadPool]: On list_superstore_stg: ROLLBACK
[0m12:33:12.491743 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m12:33:12.492541 [debug] [ThreadPool]: Using postgres connection "list_superstore_public"
[0m12:33:12.493383 [debug] [ThreadPool]: On list_superstore_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore_public"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:33:12.494768 [debug] [ThreadPool]: On list_superstore_stg: Close
[0m12:33:12.497171 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m12:33:12.497760 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_test"
[0m12:33:12.498200 [debug] [ThreadPool]: On list_superstore_dw_test: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore_dw_test"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_test'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_test'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_test'
  
[0m12:33:12.498766 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.005 seconds
[0m12:33:12.500007 [debug] [ThreadPool]: On list_superstore_public: ROLLBACK
[0m12:33:12.501753 [debug] [ThreadPool]: On list_superstore_public: Close
[0m12:33:12.503679 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m12:33:12.504897 [debug] [ThreadPool]: On list_superstore_dw_test: ROLLBACK
[0m12:33:12.505533 [debug] [ThreadPool]: On list_superstore_dw_test: Close
[0m12:33:12.511819 [debug] [MainThread]: Using postgres connection "master"
[0m12:33:12.512449 [debug] [MainThread]: On master: BEGIN
[0m12:33:12.512975 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:33:12.519698 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m12:33:12.520289 [debug] [MainThread]: Using postgres connection "master"
[0m12:33:12.520740 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m12:33:12.523736 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m12:33:12.525659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69a6ba34-b5b0-44c5-a1a3-ce79d20a129c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f358750a950>]}
[0m12:33:12.526319 [debug] [MainThread]: On master: ROLLBACK
[0m12:33:12.526987 [debug] [MainThread]: Using postgres connection "master"
[0m12:33:12.527368 [debug] [MainThread]: On master: BEGIN
[0m12:33:12.528162 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:33:12.528551 [debug] [MainThread]: On master: COMMIT
[0m12:33:12.529008 [debug] [MainThread]: Using postgres connection "master"
[0m12:33:12.529366 [debug] [MainThread]: On master: COMMIT
[0m12:33:12.530012 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:33:12.530710 [debug] [MainThread]: On master: Close
[0m12:33:12.533349 [debug] [Thread-1 (]: Began running node model.superstore_dwh.calendar_dim
[0m12:33:12.533989 [debug] [Thread-2 (]: Began running node model.superstore_dwh.my_first_dbt_model
[0m12:33:12.534972 [debug] [Thread-3 (]: Began running node model.superstore_dwh.stg_orders
[0m12:33:12.534552 [info ] [Thread-1 (]: 1 of 9 START sql table model dw_test.calendar_dim .............................. [RUN]
[0m12:33:12.535733 [info ] [Thread-2 (]: 2 of 9 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m12:33:12.536885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_superstore_dw_test, now model.superstore_dwh.calendar_dim)
[0m12:33:12.536359 [info ] [Thread-3 (]: 3 of 9 START sql view model stg.stg_orders ..................................... [RUN]
[0m12:33:12.538633 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_superstore_stg, now model.superstore_dwh.stg_orders)
[0m12:33:12.538119 [debug] [Thread-1 (]: Began compiling node model.superstore_dwh.calendar_dim
[0m12:33:12.537599 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_superstore_public, now model.superstore_dwh.my_first_dbt_model)
[0m12:33:12.547149 [debug] [Thread-2 (]: Began compiling node model.superstore_dwh.my_first_dbt_model
[0m12:33:12.546561 [debug] [Thread-1 (]: Writing injected SQL for node "model.superstore_dwh.calendar_dim"
[0m12:33:12.551912 [debug] [Thread-1 (]: Began executing node model.superstore_dwh.calendar_dim
[0m12:33:12.551122 [debug] [Thread-2 (]: Writing injected SQL for node "model.superstore_dwh.my_first_dbt_model"
[0m12:33:12.539099 [debug] [Thread-3 (]: Began compiling node model.superstore_dwh.stg_orders
[0m12:33:12.563222 [debug] [Thread-2 (]: Began executing node model.superstore_dwh.my_first_dbt_model
[0m12:33:12.584444 [debug] [Thread-3 (]: Writing injected SQL for node "model.superstore_dwh.stg_orders"
[0m12:33:12.598902 [debug] [Thread-3 (]: Began executing node model.superstore_dwh.stg_orders
[0m12:33:12.598064 [debug] [Thread-2 (]: Writing runtime sql for node "model.superstore_dwh.my_first_dbt_model"
[0m12:33:12.606709 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.my_first_dbt_model"
[0m12:33:12.607240 [debug] [Thread-2 (]: On model.superstore_dwh.my_first_dbt_model: BEGIN
[0m12:33:12.593640 [debug] [Thread-1 (]: Writing runtime sql for node "model.superstore_dwh.calendar_dim"
[0m12:33:12.618924 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:33:12.627718 [debug] [Thread-3 (]: Writing runtime sql for node "model.superstore_dwh.stg_orders"
[0m12:33:12.628905 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.calendar_dim"
[0m12:33:12.630600 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.stg_orders"
[0m12:33:12.631586 [debug] [Thread-3 (]: On model.superstore_dwh.stg_orders: BEGIN
[0m12:33:12.631983 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:33:12.631132 [debug] [Thread-1 (]: On model.superstore_dwh.calendar_dim: BEGIN
[0m12:33:12.632835 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:12.637805 [debug] [Thread-2 (]: SQL status: BEGIN in 0.019 seconds
[0m12:33:12.638382 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.my_first_dbt_model"
[0m12:33:12.638924 [debug] [Thread-2 (]: On model.superstore_dwh.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.my_first_dbt_model"} */

  
    

  create  table "superstore"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m12:33:12.640387 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m12:33:12.641321 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.calendar_dim"
[0m12:33:12.641827 [debug] [Thread-1 (]: On model.superstore_dwh.calendar_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.calendar_dim"} */

  
    

  create  table "superstore"."dw_test"."calendar_dim__dbt_tmp"
  
  
    as
  
  (
    -- Создает таблицу-календарь
SELECT
    to_char(date,'yyyymmdd')::int as dateid,
    extract('year' from date)::int as year,
    extract('quarter' from date)::int as quarter,
    extract('month' from date)::int as month,
    extract('week' from date)::int as week,
    date::date,
    to_char(date, 'dy') as week_day,
    -- Проверка на високосный год
    CASE
        WHEN extract('day' from (date + interval '2 month - 1 day')) = 29 THEN 'leap'
        ELSE 'not leap'
    END as leap
FROM generate_series(
    date '2010-01-01',
    date '2030-12-31',
    interval '1 day'
) AS t(date)
  );
  
[0m12:33:12.642679 [debug] [Thread-2 (]: SQL status: SELECT 2 in 0.003 seconds
[0m12:33:12.655955 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.my_first_dbt_model"
[0m12:33:12.657123 [debug] [Thread-2 (]: On model.superstore_dwh.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.my_first_dbt_model"} */
alter table "superstore"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m12:33:12.656440 [debug] [Thread-3 (]: SQL status: BEGIN in 0.024 seconds
[0m12:33:12.658984 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.stg_orders"
[0m12:33:12.659489 [debug] [Thread-3 (]: On model.superstore_dwh.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.stg_orders"} */

  create view "superstore"."stg"."stg_orders__dbt_tmp"
    
    
  as (
    -- models/staging/stg_orders.sql
-- Эта модель читает данные из исходной таблицы stg.orders,
-- приводит их к нужным типам и исправляет ошибку с почтовым кодом.
-- Все последующие модели будут ссылаться на эту, а не на исходную таблицу.

SELECT
    -- Приводим все к нижнему регистру для консистентности в dbt
    "order_id",
    ("order_date")::date as order_date,
    ("ship_date")::date as ship_date,
    "ship_mode",
    "customer_id",
    "customer_name",
    "segment",
    "country",
    "city",
    "state",
    -- Исправляем проблему с Burlington прямо здесь, один раз и навсегда
    CASE
        WHEN "city" = 'Burlington' AND "postal_code" IS NULL THEN '05401'
        ELSE "postal_code"
    END as postal_code,
    "region",
    "product_id",
    "category",
    "subcategory" as sub_category, -- переименовываем для соответствия
    "product_name",
    "sales",
    "quantity",
    "discount",
    "profit"
FROM "superstore"."stg"."orders"
  );
[0m12:33:12.661847 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m12:33:12.665082 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.my_first_dbt_model"
[0m12:33:12.665670 [debug] [Thread-2 (]: On model.superstore_dwh.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.my_first_dbt_model"} */
alter table "superstore"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m12:33:12.666521 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:33:12.674844 [debug] [Thread-1 (]: SQL status: SELECT 7670 in 0.032 seconds
[0m12:33:12.684053 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.calendar_dim"
[0m12:33:12.686108 [debug] [Thread-2 (]: On model.superstore_dwh.my_first_dbt_model: COMMIT
[0m12:33:12.687593 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.my_first_dbt_model"
[0m12:33:12.687108 [debug] [Thread-1 (]: On model.superstore_dwh.calendar_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.calendar_dim"} */
alter table "superstore"."dw_test"."calendar_dim__dbt_tmp" rename to "calendar_dim"
[0m12:33:12.686608 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.027 seconds
[0m12:33:12.688080 [debug] [Thread-2 (]: On model.superstore_dwh.my_first_dbt_model: COMMIT
[0m12:33:12.691246 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.stg_orders"
[0m12:33:12.691818 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:33:12.693059 [debug] [Thread-3 (]: On model.superstore_dwh.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.stg_orders"} */
alter table "superstore"."stg"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m12:33:12.694934 [debug] [Thread-1 (]: On model.superstore_dwh.calendar_dim: COMMIT
[0m12:33:12.695746 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.calendar_dim"
[0m12:33:12.696364 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m12:33:12.696825 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:33:12.697247 [debug] [Thread-1 (]: On model.superstore_dwh.calendar_dim: COMMIT
[0m12:33:12.704450 [debug] [Thread-3 (]: On model.superstore_dwh.stg_orders: COMMIT
[0m12:33:12.705215 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.stg_orders"
[0m12:33:12.705716 [debug] [Thread-3 (]: On model.superstore_dwh.stg_orders: COMMIT
[0m12:33:12.703131 [debug] [Thread-2 (]: Applying DROP to: "superstore"."public"."my_first_dbt_model__dbt_backup"
[0m12:33:12.710298 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.my_first_dbt_model"
[0m12:33:12.711932 [debug] [Thread-2 (]: On model.superstore_dwh.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.my_first_dbt_model"} */
drop table if exists "superstore"."public"."my_first_dbt_model__dbt_backup" cascade
[0m12:33:12.711420 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m12:33:12.710951 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m12:33:12.715009 [debug] [Thread-3 (]: Applying DROP to: "superstore"."stg"."stg_orders__dbt_backup"
[0m12:33:12.718461 [debug] [Thread-1 (]: Applying DROP to: "superstore"."dw_test"."calendar_dim__dbt_backup"
[0m12:33:12.720929 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.stg_orders"
[0m12:33:12.721869 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.calendar_dim"
[0m12:33:12.722414 [debug] [Thread-3 (]: On model.superstore_dwh.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.stg_orders"} */
drop view if exists "superstore"."stg"."stg_orders__dbt_backup" cascade
[0m12:33:12.723003 [debug] [Thread-1 (]: On model.superstore_dwh.calendar_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.calendar_dim"} */
drop table if exists "superstore"."dw_test"."calendar_dim__dbt_backup" cascade
[0m12:33:12.723876 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m12:33:12.724393 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:33:12.726852 [debug] [Thread-1 (]: On model.superstore_dwh.calendar_dim: Close
[0m12:33:12.728582 [debug] [Thread-3 (]: On model.superstore_dwh.stg_orders: Close
[0m12:33:12.733018 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69a6ba34-b5b0-44c5-a1a3-ce79d20a129c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3588989d80>]}
[0m12:33:12.734123 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69a6ba34-b5b0-44c5-a1a3-ce79d20a129c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3587d2f280>]}
[0m12:33:12.733614 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.021 seconds
[0m12:33:12.734890 [info ] [Thread-3 (]: 3 of 9 OK created sql view model stg.stg_orders ................................ [[32mCREATE VIEW[0m in 0.19s]
[0m12:33:12.737118 [debug] [Thread-2 (]: On model.superstore_dwh.my_first_dbt_model: Close
[0m12:33:12.735756 [info ] [Thread-1 (]: 1 of 9 OK created sql table model dw_test.calendar_dim ......................... [[32mSELECT 7670[0m in 0.20s]
[0m12:33:12.737996 [debug] [Thread-3 (]: Finished running node model.superstore_dwh.stg_orders
[0m12:33:12.738840 [debug] [Thread-1 (]: Finished running node model.superstore_dwh.calendar_dim
[0m12:33:12.739508 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69a6ba34-b5b0-44c5-a1a3-ce79d20a129c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f358859f250>]}
[0m12:33:12.741481 [debug] [Thread-1 (]: Began running node model.superstore_dwh.product_dim
[0m12:33:12.740510 [debug] [Thread-4 (]: Began running node model.superstore_dwh.customer_dim
[0m12:33:12.741041 [debug] [Thread-3 (]: Began running node model.superstore_dwh.geo_dim
[0m12:33:12.742471 [info ] [Thread-2 (]: 2 of 9 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.20s]
[0m12:33:12.747019 [debug] [Thread-2 (]: Finished running node model.superstore_dwh.my_first_dbt_model
[0m12:33:12.743833 [info ] [Thread-4 (]: 4 of 9 START sql table model dw_test.customer_dim .............................. [RUN]
[0m12:33:12.743153 [info ] [Thread-1 (]: 6 of 9 START sql table model dw_test.product_dim ............................... [RUN]
[0m12:33:12.749132 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.calendar_dim, now model.superstore_dwh.product_dim)
[0m12:33:12.747646 [debug] [Thread-2 (]: Began running node model.superstore_dwh.shipping_dim
[0m12:33:12.748574 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.superstore_dwh.customer_dim'
[0m12:33:12.751204 [debug] [Thread-4 (]: Began compiling node model.superstore_dwh.customer_dim
[0m12:33:12.749615 [debug] [Thread-1 (]: Began compiling node model.superstore_dwh.product_dim
[0m12:33:12.745022 [info ] [Thread-3 (]: 5 of 9 START sql table model dw_test.geo_dim ................................... [RUN]
[0m12:33:12.758162 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.stg_orders, now model.superstore_dwh.geo_dim)
[0m12:33:12.750593 [info ] [Thread-2 (]: 7 of 9 START sql table model dw_test.shipping_dim .............................. [RUN]
[0m12:33:12.759298 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.my_first_dbt_model, now model.superstore_dwh.shipping_dim)
[0m12:33:12.758753 [debug] [Thread-3 (]: Began compiling node model.superstore_dwh.geo_dim
[0m12:33:12.757540 [debug] [Thread-1 (]: Writing injected SQL for node "model.superstore_dwh.product_dim"
[0m12:33:12.754696 [debug] [Thread-4 (]: Writing injected SQL for node "model.superstore_dwh.customer_dim"
[0m12:33:12.763607 [debug] [Thread-1 (]: Began executing node model.superstore_dwh.product_dim
[0m12:33:12.762772 [debug] [Thread-3 (]: Writing injected SQL for node "model.superstore_dwh.geo_dim"
[0m12:33:12.759827 [debug] [Thread-2 (]: Began compiling node model.superstore_dwh.shipping_dim
[0m12:33:12.767509 [debug] [Thread-4 (]: Began executing node model.superstore_dwh.customer_dim
[0m12:33:12.766982 [debug] [Thread-1 (]: Writing runtime sql for node "model.superstore_dwh.product_dim"
[0m12:33:12.776401 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.product_dim"
[0m12:33:12.776904 [debug] [Thread-1 (]: On model.superstore_dwh.product_dim: BEGIN
[0m12:33:12.770377 [debug] [Thread-2 (]: Writing injected SQL for node "model.superstore_dwh.shipping_dim"
[0m12:33:12.777928 [debug] [Thread-2 (]: Began executing node model.superstore_dwh.shipping_dim
[0m12:33:12.775632 [debug] [Thread-4 (]: Writing runtime sql for node "model.superstore_dwh.customer_dim"
[0m12:33:12.770915 [debug] [Thread-3 (]: Began executing node model.superstore_dwh.geo_dim
[0m12:33:12.777322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:12.781113 [debug] [Thread-2 (]: Writing runtime sql for node "model.superstore_dwh.shipping_dim"
[0m12:33:12.786994 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.shipping_dim"
[0m12:33:12.785315 [debug] [Thread-3 (]: Writing runtime sql for node "model.superstore_dwh.geo_dim"
[0m12:33:12.787571 [debug] [Thread-2 (]: On model.superstore_dwh.shipping_dim: BEGIN
[0m12:33:12.792097 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:33:12.794341 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.customer_dim"
[0m12:33:12.794956 [debug] [Thread-4 (]: On model.superstore_dwh.customer_dim: BEGIN
[0m12:33:12.795395 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:33:12.803940 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.geo_dim"
[0m12:33:12.804459 [debug] [Thread-3 (]: On model.superstore_dwh.geo_dim: BEGIN
[0m12:33:12.806158 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:33:12.805713 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m12:33:12.806778 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.product_dim"
[0m12:33:12.809115 [debug] [Thread-1 (]: On model.superstore_dwh.product_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.product_dim"} */

  
    

  create  table "superstore"."dw_test"."product_dim__dbt_tmp"
  
  
    as
  
  (
    -- Создает справочник продуктов
SELECT
    100 + row_number() OVER (ORDER BY "product_id") as prod_id,
    "product_id",
    "product_name",
    "category",
    "sub_category",
    "segment"
FROM (
    SELECT DISTINCT "product_id", "product_name", "category", "sub_category", "segment" FROM "superstore"."stg"."stg_orders"
) as unique_products
  );
  
[0m12:33:12.819912 [debug] [Thread-2 (]: SQL status: BEGIN in 0.028 seconds
[0m12:33:12.824441 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.shipping_dim"
[0m12:33:12.825104 [debug] [Thread-2 (]: On model.superstore_dwh.shipping_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.shipping_dim"} */

  
    

  create  table "superstore"."dw_test"."shipping_dim__dbt_tmp"
  
  
    as
  
  (
    -- Создает справочник видов доставки
SELECT
    100 + row_number() OVER (ORDER BY "ship_mode") as ship_id,
    "ship_mode"
FROM (
    SELECT DISTINCT "ship_mode" FROM "superstore"."stg"."stg_orders"
) as unique_shipping_modes
  );
  
[0m12:33:12.837371 [debug] [Thread-4 (]: SQL status: BEGIN in 0.042 seconds
[0m12:33:12.839233 [debug] [Thread-1 (]: SQL status: SELECT 4544 in 0.030 seconds
[0m12:33:12.840894 [debug] [Thread-3 (]: SQL status: BEGIN in 0.035 seconds
[0m12:33:12.845518 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.geo_dim"
[0m12:33:12.841816 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.016 seconds
[0m12:33:12.844934 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.product_dim"
[0m12:33:12.852539 [debug] [Thread-1 (]: On model.superstore_dwh.product_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.product_dim"} */
alter table "superstore"."dw_test"."product_dim__dbt_tmp" rename to "product_dim"
[0m12:33:12.841357 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.customer_dim"
[0m12:33:12.845988 [debug] [Thread-3 (]: On model.superstore_dwh.geo_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.geo_dim"} */

  
    

  create  table "superstore"."dw_test"."geo_dim__dbt_tmp"
  
  
    as
  
  (
    -- Создает географический справочник
SELECT
    100 + row_number() OVER (ORDER BY "postal_code", "city", "state") as geo_id,
    "country",
    "city",
    "state",
    "postal_code"
FROM (
    SELECT DISTINCT "country", "city", "state", "postal_code" FROM "superstore"."stg"."stg_orders"
) as unique_geo
  );
  
[0m12:33:12.854065 [debug] [Thread-4 (]: On model.superstore_dwh.customer_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.customer_dim"} */

  
    

  create  table "superstore"."dw_test"."customer_dim__dbt_tmp"
  
  
    as
  
  (
    -- Создает справочник клиентов
SELECT
    100 + row_number() OVER (ORDER BY "customer_id") as cust_id,
    "customer_id",
    "customer_name"
FROM (
    SELECT DISTINCT "customer_id", "customer_name" FROM "superstore"."stg"."stg_orders"
) as unique_customers
  );
  
[0m12:33:12.854679 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.shipping_dim"
[0m12:33:12.858016 [debug] [Thread-2 (]: On model.superstore_dwh.shipping_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.shipping_dim"} */
alter table "superstore"."dw_test"."shipping_dim__dbt_tmp" rename to "shipping_dim"
[0m12:33:12.855248 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:33:12.866814 [debug] [Thread-1 (]: On model.superstore_dwh.product_dim: COMMIT
[0m12:33:12.873195 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.product_dim"
[0m12:33:12.873778 [debug] [Thread-1 (]: On model.superstore_dwh.product_dim: COMMIT
[0m12:33:12.874614 [debug] [Thread-4 (]: SQL status: SELECT 993 in 0.018 seconds
[0m12:33:12.881882 [debug] [Thread-3 (]: SQL status: SELECT 832 in 0.026 seconds
[0m12:33:12.895183 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.customer_dim"
[0m12:33:12.896172 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.038 seconds
[0m12:33:12.898302 [debug] [Thread-2 (]: On model.superstore_dwh.shipping_dim: COMMIT
[0m12:33:12.896913 [debug] [Thread-4 (]: On model.superstore_dwh.customer_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.customer_dim"} */
alter table "superstore"."dw_test"."customer_dim__dbt_tmp" rename to "customer_dim"
[0m12:33:12.895707 [debug] [Thread-1 (]: SQL status: COMMIT in 0.021 seconds
[0m12:33:12.887357 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.geo_dim"
[0m12:33:12.903881 [debug] [Thread-3 (]: On model.superstore_dwh.geo_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.geo_dim"} */
alter table "superstore"."dw_test"."geo_dim__dbt_tmp" rename to "geo_dim"
[0m12:33:12.904797 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:33:12.898908 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.shipping_dim"
[0m12:33:12.907056 [debug] [Thread-2 (]: On model.superstore_dwh.shipping_dim: COMMIT
[0m12:33:12.903239 [debug] [Thread-1 (]: Applying DROP to: "superstore"."dw_test"."product_dim__dbt_backup"
[0m12:33:12.906568 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m12:33:12.906134 [debug] [Thread-3 (]: On model.superstore_dwh.geo_dim: COMMIT
[0m12:33:12.907881 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.product_dim"
[0m12:33:12.909442 [debug] [Thread-4 (]: On model.superstore_dwh.customer_dim: COMMIT
[0m12:33:12.910768 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m12:33:12.911577 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.geo_dim"
[0m12:33:12.912077 [debug] [Thread-1 (]: On model.superstore_dwh.product_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.product_dim"} */
drop table if exists "superstore"."dw_test"."product_dim__dbt_backup" cascade
[0m12:33:12.914092 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.customer_dim"
[0m12:33:12.916779 [debug] [Thread-2 (]: Applying DROP to: "superstore"."dw_test"."shipping_dim__dbt_backup"
[0m12:33:12.917362 [debug] [Thread-3 (]: On model.superstore_dwh.geo_dim: COMMIT
[0m12:33:12.918092 [debug] [Thread-4 (]: On model.superstore_dwh.customer_dim: COMMIT
[0m12:33:12.919323 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m12:33:12.920913 [debug] [Thread-1 (]: On model.superstore_dwh.product_dim: Close
[0m12:33:12.918884 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.shipping_dim"
[0m12:33:12.923409 [debug] [Thread-2 (]: On model.superstore_dwh.shipping_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.shipping_dim"} */
drop table if exists "superstore"."dw_test"."shipping_dim__dbt_backup" cascade
[0m12:33:12.924259 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m12:33:12.925127 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69a6ba34-b5b0-44c5-a1a3-ce79d20a129c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35859b31c0>]}
[0m12:33:12.929105 [debug] [Thread-3 (]: Applying DROP to: "superstore"."dw_test"."geo_dim__dbt_backup"
[0m12:33:12.926358 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.001 seconds
[0m12:33:12.925869 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m12:33:12.930627 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.geo_dim"
[0m12:33:12.935719 [debug] [Thread-3 (]: On model.superstore_dwh.geo_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.geo_dim"} */
drop table if exists "superstore"."dw_test"."geo_dim__dbt_backup" cascade
[0m12:33:12.935013 [debug] [Thread-4 (]: Applying DROP to: "superstore"."dw_test"."customer_dim__dbt_backup"
[0m12:33:12.929916 [info ] [Thread-1 (]: 6 of 9 OK created sql table model dw_test.product_dim .......................... [[32mSELECT 4544[0m in 0.18s]
[0m12:33:12.932249 [debug] [Thread-2 (]: On model.superstore_dwh.shipping_dim: Close
[0m12:33:12.939954 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69a6ba34-b5b0-44c5-a1a3-ce79d20a129c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f358750b460>]}
[0m12:33:12.937118 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.customer_dim"
[0m12:33:12.939052 [debug] [Thread-1 (]: Finished running node model.superstore_dwh.product_dim
[0m12:33:12.941399 [debug] [Thread-4 (]: On model.superstore_dwh.customer_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.customer_dim"} */
drop table if exists "superstore"."dw_test"."customer_dim__dbt_backup" cascade
[0m12:33:12.945124 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.000 seconds
[0m12:33:12.937692 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m12:33:12.942458 [debug] [Thread-1 (]: Began running node model.superstore_dwh.my_second_dbt_model
[0m12:33:12.940749 [info ] [Thread-2 (]: 7 of 9 OK created sql table model dw_test.shipping_dim ......................... [[32mSELECT 4[0m in 0.18s]
[0m12:33:12.950898 [debug] [Thread-2 (]: Finished running node model.superstore_dwh.shipping_dim
[0m12:33:12.948980 [debug] [Thread-3 (]: On model.superstore_dwh.geo_dim: Close
[0m12:33:12.947490 [debug] [Thread-4 (]: On model.superstore_dwh.customer_dim: Close
[0m12:33:12.950202 [info ] [Thread-1 (]: 8 of 9 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m12:33:12.952411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.product_dim, now model.superstore_dwh.my_second_dbt_model)
[0m12:33:12.954820 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69a6ba34-b5b0-44c5-a1a3-ce79d20a129c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3588ddb130>]}
[0m12:33:12.956872 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69a6ba34-b5b0-44c5-a1a3-ce79d20a129c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3588dbe1a0>]}
[0m12:33:12.957596 [debug] [Thread-1 (]: Began compiling node model.superstore_dwh.my_second_dbt_model
[0m12:33:12.959514 [info ] [Thread-4 (]: 4 of 9 OK created sql table model dw_test.customer_dim ......................... [[32mSELECT 993[0m in 0.21s]
[0m12:33:12.967014 [debug] [Thread-4 (]: Finished running node model.superstore_dwh.customer_dim
[0m12:33:12.967402 [debug] [Thread-1 (]: Writing injected SQL for node "model.superstore_dwh.my_second_dbt_model"
[0m12:33:12.960187 [info ] [Thread-3 (]: 5 of 9 OK created sql table model dw_test.geo_dim .............................. [[32mSELECT 832[0m in 0.20s]
[0m12:33:12.971359 [debug] [Thread-1 (]: Began executing node model.superstore_dwh.my_second_dbt_model
[0m12:33:12.972899 [debug] [Thread-3 (]: Finished running node model.superstore_dwh.geo_dim
[0m12:33:12.980472 [debug] [Thread-1 (]: Writing runtime sql for node "model.superstore_dwh.my_second_dbt_model"
[0m12:33:12.981253 [debug] [Thread-2 (]: Began running node model.superstore_dwh.sales_fact
[0m12:33:12.983048 [info ] [Thread-2 (]: 9 of 9 START sql table model dw_test.sales_fact ................................ [RUN]
[0m12:33:12.983759 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.shipping_dim, now model.superstore_dwh.sales_fact)
[0m12:33:12.984242 [debug] [Thread-2 (]: Began compiling node model.superstore_dwh.sales_fact
[0m12:33:12.982340 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.my_second_dbt_model"
[0m12:33:12.993728 [debug] [Thread-1 (]: On model.superstore_dwh.my_second_dbt_model: BEGIN
[0m12:33:12.992994 [debug] [Thread-2 (]: Writing injected SQL for node "model.superstore_dwh.sales_fact"
[0m12:33:12.994180 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:12.997740 [debug] [Thread-2 (]: Began executing node model.superstore_dwh.sales_fact
[0m12:33:13.013527 [debug] [Thread-2 (]: Writing runtime sql for node "model.superstore_dwh.sales_fact"
[0m12:33:13.016272 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m12:33:13.018083 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.my_second_dbt_model"
[0m12:33:13.017452 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.sales_fact"
[0m12:33:13.019964 [debug] [Thread-2 (]: On model.superstore_dwh.sales_fact: BEGIN
[0m12:33:13.020366 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:33:13.019065 [debug] [Thread-1 (]: On model.superstore_dwh.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.my_second_dbt_model"} */

  create view "superstore"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "superstore"."public"."my_first_dbt_model"
where id = 1
  );
[0m12:33:13.023061 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m12:33:13.031383 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.my_second_dbt_model"
[0m12:33:13.033958 [debug] [Thread-1 (]: On model.superstore_dwh.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.my_second_dbt_model"} */
alter table "superstore"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m12:33:13.036900 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:33:13.038853 [debug] [Thread-2 (]: SQL status: BEGIN in 0.018 seconds
[0m12:33:13.042862 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.sales_fact"
[0m12:33:13.043449 [debug] [Thread-2 (]: On model.superstore_dwh.sales_fact: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.sales_fact"} */

  
    

  create  table "superstore"."dw_test"."sales_fact__dbt_tmp"
  
  
    as
  
  (
    -- Создает таблицу фактов, объединяя все измерения
SELECT
    -- Суррогатные ключи из измерений
    cd.cust_id,
    pd.prod_id,
    sd.ship_id,
    gd.geo_id,
    -- Ключи для календаря
    to_char(o.order_date, 'yyyymmdd')::int AS order_date_id,
    to_char(o.ship_date, 'yyyymmdd')::int AS ship_date_id,
    -- Бизнес-ключ и метрики
    o.order_id,
    o.sales,
    o.profit,
    o.quantity,
    o.discount
FROM "superstore"."stg"."stg_orders" AS o
LEFT JOIN "superstore"."dw_test"."customer_dim" AS cd ON o.customer_id = cd.customer_id
LEFT JOIN "superstore"."dw_test"."product_dim" AS pd ON o.product_id = pd.product_id
LEFT JOIN "superstore"."dw_test"."shipping_dim" AS sd ON o.ship_mode = sd.ship_mode
LEFT JOIN "superstore"."dw_test"."geo_dim" AS gd ON o.postal_code = gd.postal_code AND o.city = gd.city AND o.state = gd.state
  );
  
[0m12:33:13.040165 [debug] [Thread-1 (]: On model.superstore_dwh.my_second_dbt_model: COMMIT
[0m12:33:13.045847 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.my_second_dbt_model"
[0m12:33:13.050273 [debug] [Thread-1 (]: On model.superstore_dwh.my_second_dbt_model: COMMIT
[0m12:33:13.054751 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:33:13.067407 [debug] [Thread-1 (]: Applying DROP to: "superstore"."public"."my_second_dbt_model__dbt_backup"
[0m12:33:13.071657 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.my_second_dbt_model"
[0m12:33:13.072399 [debug] [Thread-1 (]: On model.superstore_dwh.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.my_second_dbt_model"} */
drop view if exists "superstore"."public"."my_second_dbt_model__dbt_backup" cascade
[0m12:33:13.075788 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m12:33:13.079458 [debug] [Thread-1 (]: On model.superstore_dwh.my_second_dbt_model: Close
[0m12:33:13.082719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69a6ba34-b5b0-44c5-a1a3-ce79d20a129c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f358c8c0b50>]}
[0m12:33:13.085753 [info ] [Thread-1 (]: 8 of 9 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.13s]
[0m12:33:13.086494 [debug] [Thread-1 (]: Finished running node model.superstore_dwh.my_second_dbt_model
[0m12:33:13.141500 [debug] [Thread-2 (]: SQL status: SELECT 25867 in 0.097 seconds
[0m12:33:13.149063 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.sales_fact"
[0m12:33:13.149637 [debug] [Thread-2 (]: On model.superstore_dwh.sales_fact: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.sales_fact"} */
alter table "superstore"."dw_test"."sales_fact__dbt_tmp" rename to "sales_fact"
[0m12:33:13.150406 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:33:13.152207 [debug] [Thread-2 (]: On model.superstore_dwh.sales_fact: COMMIT
[0m12:33:13.152756 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.sales_fact"
[0m12:33:13.153186 [debug] [Thread-2 (]: On model.superstore_dwh.sales_fact: COMMIT
[0m12:33:13.164816 [debug] [Thread-2 (]: SQL status: COMMIT in 0.011 seconds
[0m12:33:13.168330 [debug] [Thread-2 (]: Applying DROP to: "superstore"."dw_test"."sales_fact__dbt_backup"
[0m12:33:13.169387 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.sales_fact"
[0m12:33:13.169907 [debug] [Thread-2 (]: On model.superstore_dwh.sales_fact: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.sales_fact"} */
drop table if exists "superstore"."dw_test"."sales_fact__dbt_backup" cascade
[0m12:33:13.170733 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.000 seconds
[0m12:33:13.172322 [debug] [Thread-2 (]: On model.superstore_dwh.sales_fact: Close
[0m12:33:13.174596 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69a6ba34-b5b0-44c5-a1a3-ce79d20a129c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3567765c60>]}
[0m12:33:13.176678 [info ] [Thread-2 (]: 9 of 9 OK created sql table model dw_test.sales_fact ........................... [[32mSELECT 25867[0m in 0.19s]
[0m12:33:13.177437 [debug] [Thread-2 (]: Finished running node model.superstore_dwh.sales_fact
[0m12:33:13.179146 [debug] [MainThread]: Using postgres connection "master"
[0m12:33:13.179700 [debug] [MainThread]: On master: BEGIN
[0m12:33:13.180132 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:33:13.188382 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m12:33:13.188953 [debug] [MainThread]: On master: COMMIT
[0m12:33:13.189344 [debug] [MainThread]: Using postgres connection "master"
[0m12:33:13.189780 [debug] [MainThread]: On master: COMMIT
[0m12:33:13.190473 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:33:13.190905 [debug] [MainThread]: On master: Close
[0m12:33:13.192003 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:33:13.192401 [debug] [MainThread]: Connection 'model.superstore_dwh.my_second_dbt_model' was properly closed.
[0m12:33:13.195838 [debug] [MainThread]: Connection 'model.superstore_dwh.sales_fact' was properly closed.
[0m12:33:13.196310 [debug] [MainThread]: Connection 'model.superstore_dwh.geo_dim' was properly closed.
[0m12:33:13.199830 [debug] [MainThread]: Connection 'model.superstore_dwh.customer_dim' was properly closed.
[0m12:33:13.200327 [info ] [MainThread]: 
[0m12:33:13.202676 [info ] [MainThread]: Finished running 7 table models, 2 view models in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m12:33:13.206078 [debug] [MainThread]: Command end result
[0m12:33:13.247938 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/manifest.json
[0m12:33:13.249897 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/semantic_manifest.json
[0m12:33:13.262076 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dev/Downloads/pde_magistr/superstore_dwh/target/run_results.json
[0m12:33:13.262590 [info ] [MainThread]: 
[0m12:33:13.264522 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:33:13.265660 [info ] [MainThread]: 
[0m12:33:13.266714 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=9
[0m12:33:13.268541 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.8046427, "process_in_blocks": "0", "process_kernel_time": 0.225063, "process_mem_max_rss": "126932", "process_out_blocks": "3016", "process_user_time": 3.420155}
[0m12:33:13.269363 [debug] [MainThread]: Command `dbt run` succeeded at 12:33:13.269263 after 2.81 seconds
[0m12:33:13.271025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f358b0a57e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f358bc7b250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3588df7be0>]}
[0m12:33:13.271557 [debug] [MainThread]: Flushing usage events
[0m12:33:14.058248 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:35:49.224169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8c5b6ad7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8c5a668220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8c5a6681c0>]}


============================== 12:35:49.226882 | 5dfd62e3-c694-45bc-8b26-36169c93ddf9 ==============================
[0m12:35:49.226882 [info ] [MainThread]: Running with dbt=1.10.11
[0m12:35:49.227525 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'fail_fast': 'False', 'debug': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt test', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'version_check': 'True', 'printer_width': '80', 'target_path': 'None', 'profiles_dir': '/home/dev/.dbt', 'log_path': '/home/dev/Downloads/pde_magistr/superstore_dwh/logs', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'indirect_selection': 'eager'}
[0m12:35:49.391331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5dfd62e3-c694-45bc-8b26-36169c93ddf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8c5a60af80>]}
[0m12:35:49.453724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5dfd62e3-c694-45bc-8b26-36169c93ddf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8c5a66be80>]}
[0m12:35:49.454621 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m12:35:49.538299 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m12:35:49.678180 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:35:49.678669 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:35:49.732693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5dfd62e3-c694-45bc-8b26-36169c93ddf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8c58fb7e50>]}
[0m12:35:49.832629 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/manifest.json
[0m12:35:49.834488 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/semantic_manifest.json
[0m12:35:49.894926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5dfd62e3-c694-45bc-8b26-36169c93ddf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8c5a784460>]}
[0m12:35:49.895571 [info ] [MainThread]: Found 9 models, 4 data tests, 1 source, 435 macros
[0m12:35:49.896037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dfd62e3-c694-45bc-8b26-36169c93ddf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8c5d15c4c0>]}
[0m12:35:49.897888 [info ] [MainThread]: 
[0m12:35:49.898350 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:35:49.898821 [info ] [MainThread]: 
[0m12:35:49.899446 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:35:49.904348 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore_stg'
[0m12:35:49.912489 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore_public'
[0m12:35:49.922255 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore_dw_test'
[0m12:35:49.944894 [debug] [ThreadPool]: Using postgres connection "list_superstore_stg"
[0m12:35:49.945467 [debug] [ThreadPool]: On list_superstore_stg: BEGIN
[0m12:35:49.945922 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:35:49.947504 [debug] [ThreadPool]: Using postgres connection "list_superstore_public"
[0m12:35:49.948089 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_test"
[0m12:35:49.954413 [debug] [ThreadPool]: On list_superstore_dw_test: BEGIN
[0m12:35:49.954842 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:35:49.953199 [debug] [ThreadPool]: On list_superstore_public: BEGIN
[0m12:35:49.955884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:35:49.958351 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m12:35:49.958911 [debug] [ThreadPool]: Using postgres connection "list_superstore_stg"
[0m12:35:49.960441 [debug] [ThreadPool]: On list_superstore_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore_stg"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'stg'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'stg'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'stg'
  
[0m12:35:49.964958 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m12:35:49.968804 [debug] [ThreadPool]: On list_superstore_stg: ROLLBACK
[0m12:35:49.972252 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m12:35:49.972861 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_test"
[0m12:35:49.973270 [debug] [ThreadPool]: On list_superstore_dw_test: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore_dw_test"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_test'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_test'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_test'
  
[0m12:35:49.973793 [debug] [ThreadPool]: On list_superstore_stg: Close
[0m12:35:49.978687 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m12:35:49.980769 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.007 seconds
[0m12:35:49.981199 [debug] [ThreadPool]: Using postgres connection "list_superstore_public"
[0m12:35:49.982537 [debug] [ThreadPool]: On list_superstore_dw_test: ROLLBACK
[0m12:35:49.983862 [debug] [ThreadPool]: On list_superstore_dw_test: Close
[0m12:35:49.983242 [debug] [ThreadPool]: On list_superstore_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore_public"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:35:49.990515 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.006 seconds
[0m12:35:49.991877 [debug] [ThreadPool]: On list_superstore_public: ROLLBACK
[0m12:35:49.996766 [debug] [ThreadPool]: On list_superstore_public: Close
[0m12:35:50.004271 [debug] [MainThread]: Using postgres connection "master"
[0m12:35:50.004813 [debug] [MainThread]: On master: BEGIN
[0m12:35:50.005180 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:35:50.012887 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m12:35:50.013482 [debug] [MainThread]: Using postgres connection "master"
[0m12:35:50.014398 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m12:35:50.017823 [debug] [MainThread]: SQL status: SELECT 3 in 0.003 seconds
[0m12:35:50.019988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dfd62e3-c694-45bc-8b26-36169c93ddf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8c5d1614e0>]}
[0m12:35:50.020578 [debug] [MainThread]: On master: ROLLBACK
[0m12:35:50.021236 [debug] [MainThread]: Using postgres connection "master"
[0m12:35:50.021785 [debug] [MainThread]: On master: BEGIN
[0m12:35:50.022589 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:35:50.023066 [debug] [MainThread]: On master: COMMIT
[0m12:35:50.023516 [debug] [MainThread]: Using postgres connection "master"
[0m12:35:50.023961 [debug] [MainThread]: On master: COMMIT
[0m12:35:50.024607 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:35:50.025105 [debug] [MainThread]: On master: Close
[0m12:35:50.029038 [debug] [Thread-1 (]: Began running node test.superstore_dwh.not_null_my_first_dbt_model_id.5fb22c2710
[0m12:35:50.030653 [debug] [Thread-2 (]: Began running node test.superstore_dwh.not_null_my_second_dbt_model_id.151b76d778
[0m12:35:50.031501 [debug] [Thread-3 (]: Began running node test.superstore_dwh.unique_my_first_dbt_model_id.16e066b321
[0m12:35:50.032621 [debug] [Thread-4 (]: Began running node test.superstore_dwh.unique_my_second_dbt_model_id.57a0f8c493
[0m12:35:50.030219 [info ] [Thread-1 (]: 1 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m12:35:50.035257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_superstore_public, now test.superstore_dwh.not_null_my_first_dbt_model_id.5fb22c2710)
[0m12:35:50.035805 [debug] [Thread-1 (]: Began compiling node test.superstore_dwh.not_null_my_first_dbt_model_id.5fb22c2710
[0m12:35:50.032010 [info ] [Thread-2 (]: 2 of 4 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m12:35:50.042197 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_superstore_dw_test, now test.superstore_dwh.not_null_my_second_dbt_model_id.151b76d778)
[0m12:35:50.033676 [info ] [Thread-3 (]: 3 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m12:35:50.034645 [info ] [Thread-4 (]: 4 of 4 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m12:35:50.056093 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.superstore_dwh.unique_my_second_dbt_model_id.57a0f8c493'
[0m12:35:50.056627 [debug] [Thread-4 (]: Began compiling node test.superstore_dwh.unique_my_second_dbt_model_id.57a0f8c493
[0m12:35:50.050148 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_superstore_stg, now test.superstore_dwh.unique_my_first_dbt_model_id.16e066b321)
[0m12:35:50.067083 [debug] [Thread-3 (]: Began compiling node test.superstore_dwh.unique_my_first_dbt_model_id.16e066b321
[0m12:35:50.055321 [debug] [Thread-1 (]: Writing injected SQL for node "test.superstore_dwh.not_null_my_first_dbt_model_id.5fb22c2710"
[0m12:35:50.072928 [debug] [Thread-1 (]: Began executing node test.superstore_dwh.not_null_my_first_dbt_model_id.5fb22c2710
[0m12:35:50.042776 [debug] [Thread-2 (]: Began compiling node test.superstore_dwh.not_null_my_second_dbt_model_id.151b76d778
[0m12:35:50.072016 [debug] [Thread-3 (]: Writing injected SQL for node "test.superstore_dwh.unique_my_first_dbt_model_id.16e066b321"
[0m12:35:50.066478 [debug] [Thread-4 (]: Writing injected SQL for node "test.superstore_dwh.unique_my_second_dbt_model_id.57a0f8c493"
[0m12:35:50.094684 [debug] [Thread-4 (]: Began executing node test.superstore_dwh.unique_my_second_dbt_model_id.57a0f8c493
[0m12:35:50.089502 [debug] [Thread-1 (]: Writing runtime sql for node "test.superstore_dwh.not_null_my_first_dbt_model_id.5fb22c2710"
[0m12:35:50.093863 [debug] [Thread-2 (]: Writing injected SQL for node "test.superstore_dwh.not_null_my_second_dbt_model_id.151b76d778"
[0m12:35:50.098462 [debug] [Thread-3 (]: Began executing node test.superstore_dwh.unique_my_first_dbt_model_id.16e066b321
[0m12:35:50.100898 [debug] [Thread-3 (]: Writing runtime sql for node "test.superstore_dwh.unique_my_first_dbt_model_id.16e066b321"
[0m12:35:50.102163 [debug] [Thread-3 (]: Using postgres connection "test.superstore_dwh.unique_my_first_dbt_model_id.16e066b321"
[0m12:35:50.097813 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.not_null_my_first_dbt_model_id.5fb22c2710"
[0m12:35:50.103149 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m12:35:50.103600 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:35:50.101579 [debug] [Thread-2 (]: Began executing node test.superstore_dwh.not_null_my_second_dbt_model_id.151b76d778
[0m12:35:50.097088 [debug] [Thread-4 (]: Writing runtime sql for node "test.superstore_dwh.unique_my_second_dbt_model_id.57a0f8c493"
[0m12:35:50.110596 [debug] [Thread-4 (]: Using postgres connection "test.superstore_dwh.unique_my_second_dbt_model_id.57a0f8c493"
[0m12:35:50.111110 [debug] [Thread-4 (]: On test.superstore_dwh.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m12:35:50.102689 [debug] [Thread-3 (]: On test.superstore_dwh.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m12:35:50.112349 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:35:50.113313 [debug] [Thread-2 (]: Writing runtime sql for node "test.superstore_dwh.not_null_my_second_dbt_model_id.151b76d778"
[0m12:35:50.114539 [debug] [Thread-2 (]: Using postgres connection "test.superstore_dwh.not_null_my_second_dbt_model_id.151b76d778"
[0m12:35:50.111545 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:35:50.114995 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m12:35:50.117445 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:35:50.118805 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m12:35:50.121878 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.not_null_my_first_dbt_model_id.5fb22c2710"
[0m12:35:50.122386 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.not_null_my_first_dbt_model_id.5fb22c2710"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "superstore"."public"."my_first_dbt_model"
where id is null



  
  
      
    ) dbt_internal_test
[0m12:35:50.128012 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m12:35:50.136937 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m12:35:50.138016 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m12:35:50.141855 [debug] [Thread-3 (]: SQL status: BEGIN in 0.029 seconds
[0m12:35:50.143786 [debug] [Thread-4 (]: SQL status: BEGIN in 0.032 seconds
[0m12:35:50.148987 [debug] [Thread-2 (]: SQL status: BEGIN in 0.033 seconds
[0m12:35:50.140278 [error] [Thread-1 (]: 1 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.10s]
[0m12:35:50.149777 [debug] [Thread-3 (]: Using postgres connection "test.superstore_dwh.unique_my_first_dbt_model_id.16e066b321"
[0m12:35:50.150294 [debug] [Thread-4 (]: Using postgres connection "test.superstore_dwh.unique_my_second_dbt_model_id.57a0f8c493"
[0m12:35:50.151318 [debug] [Thread-2 (]: Using postgres connection "test.superstore_dwh.not_null_my_second_dbt_model_id.151b76d778"
[0m12:35:50.154703 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.not_null_my_second_dbt_model_id.151b76d778"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "superstore"."public"."my_second_dbt_model"
where id is null



  
  
      
    ) dbt_internal_test
[0m12:35:50.152280 [debug] [Thread-1 (]: Finished running node test.superstore_dwh.not_null_my_first_dbt_model_id.5fb22c2710
[0m12:35:50.153476 [debug] [Thread-3 (]: On test.superstore_dwh.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.unique_my_first_dbt_model_id.16e066b321"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "superstore"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:35:50.154097 [debug] [Thread-4 (]: On test.superstore_dwh.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.unique_my_second_dbt_model_id.57a0f8c493"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "superstore"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:35:50.157164 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m12:35:50.159878 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m12:35:50.163707 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.006 seconds
[0m12:35:50.164174 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.006 seconds
[0m12:35:50.171251 [debug] [Thread-3 (]: On test.superstore_dwh.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m12:35:50.171998 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_my_second_dbt_model_id.151b76d778: Close
[0m12:35:50.169624 [debug] [Thread-4 (]: On test.superstore_dwh.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m12:35:50.177792 [debug] [Thread-4 (]: On test.superstore_dwh.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m12:35:50.173964 [debug] [Thread-3 (]: On test.superstore_dwh.unique_my_first_dbt_model_id.16e066b321: Close
[0m12:35:50.176275 [info ] [Thread-2 (]: 2 of 4 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.13s]
[0m12:35:50.179737 [info ] [Thread-4 (]: 4 of 4 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.12s]
[0m12:35:50.184998 [debug] [Thread-4 (]: Finished running node test.superstore_dwh.unique_my_second_dbt_model_id.57a0f8c493
[0m12:35:50.183309 [debug] [Thread-2 (]: Finished running node test.superstore_dwh.not_null_my_second_dbt_model_id.151b76d778
[0m12:35:50.182294 [info ] [Thread-3 (]: 3 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.13s]
[0m12:35:50.186023 [debug] [Thread-3 (]: Finished running node test.superstore_dwh.unique_my_first_dbt_model_id.16e066b321
[0m12:35:50.188897 [debug] [MainThread]: Using postgres connection "master"
[0m12:35:50.189377 [debug] [MainThread]: On master: BEGIN
[0m12:35:50.191010 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:35:50.203215 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m12:35:50.203738 [debug] [MainThread]: On master: COMMIT
[0m12:35:50.204935 [debug] [MainThread]: Using postgres connection "master"
[0m12:35:50.205848 [debug] [MainThread]: On master: COMMIT
[0m12:35:50.207476 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:35:50.207927 [debug] [MainThread]: On master: Close
[0m12:35:50.209841 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:35:50.210485 [debug] [MainThread]: Connection 'test.superstore_dwh.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m12:35:50.212819 [debug] [MainThread]: Connection 'test.superstore_dwh.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m12:35:50.213238 [debug] [MainThread]: Connection 'test.superstore_dwh.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m12:35:50.213681 [debug] [MainThread]: Connection 'test.superstore_dwh.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m12:35:50.214201 [info ] [MainThread]: 
[0m12:35:50.214777 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m12:35:50.216078 [debug] [MainThread]: Command end result
[0m12:35:50.251015 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/manifest.json
[0m12:35:50.255059 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/semantic_manifest.json
[0m12:35:50.269716 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dev/Downloads/pde_magistr/superstore_dwh/target/run_results.json
[0m12:35:50.270186 [info ] [MainThread]: 
[0m12:35:50.271777 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:35:50.272982 [info ] [MainThread]: 
[0m12:35:50.274153 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m12:35:50.275194 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m12:35:50.275872 [info ] [MainThread]: 
[0m12:35:50.277378 [info ] [MainThread]:   compiled code at target/compiled/superstore_dwh/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m12:35:50.278431 [info ] [MainThread]: 
[0m12:35:50.279479 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m12:35:50.281036 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.113934, "process_in_blocks": "0", "process_kernel_time": 0.161223, "process_mem_max_rss": "118248", "process_out_blocks": "1960", "process_user_time": 1.999962}
[0m12:35:50.282767 [debug] [MainThread]: Command `dbt test` failed at 12:35:50.282609 after 1.12 seconds
[0m12:35:50.283387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8c5b6ad7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8c59b00370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8c59b015d0>]}
[0m12:35:50.283968 [debug] [MainThread]: Flushing usage events
[0m12:35:50.956917 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:39:06.169807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7403ad7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa73f368220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa73f3681c0>]}


============================== 12:39:06.172412 | 55ee2158-f503-4e12-92b6-b52f7799b778 ==============================
[0m12:39:06.172412 [info ] [MainThread]: Running with dbt=1.10.11
[0m12:39:06.173037 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'no_print': 'None', 'log_format': 'default', 'log_cache_events': 'False', 'printer_width': '80', 'invocation_command': 'dbt test', 'target_path': 'None', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'profiles_dir': '/home/dev/.dbt', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'debug': 'False', 'static_parser': 'True', 'quiet': 'False', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'log_path': '/home/dev/Downloads/pde_magistr/superstore_dwh/logs', 'fail_fast': 'False'}
[0m12:39:06.337044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55ee2158-f503-4e12-92b6-b52f7799b778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa73f30af50>]}
[0m12:39:06.403075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55ee2158-f503-4e12-92b6-b52f7799b778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa73fb882b0>]}
[0m12:39:06.403925 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m12:39:06.490884 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m12:39:06.629506 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 1 files added, 0 files changed.
[0m12:39:06.630230 [debug] [MainThread]: Partial parsing: added file: superstore_dwh://models/marts/schema.yml
[0m12:39:06.630735 [debug] [MainThread]: Partial parsing: deleted file: superstore_dwh://models/example/my_second_dbt_model.sql
[0m12:39:06.631095 [debug] [MainThread]: Partial parsing: deleted file: superstore_dwh://models/example/my_first_dbt_model.sql
[0m12:39:06.848451 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m12:39:06.849107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '55ee2158-f503-4e12-92b6-b52f7799b778', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa73f26a530>]}
[0m12:39:06.965705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55ee2158-f503-4e12-92b6-b52f7799b778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa73f57ef20>]}
[0m12:39:07.062086 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/manifest.json
[0m12:39:07.063852 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/semantic_manifest.json
[0m12:39:07.083466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55ee2158-f503-4e12-92b6-b52f7799b778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa73d795c30>]}
[0m12:39:07.084059 [info ] [MainThread]: Found 7 models, 9 data tests, 1 source, 435 macros
[0m12:39:07.084557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55ee2158-f503-4e12-92b6-b52f7799b778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa73d7962f0>]}
[0m12:39:07.086709 [info ] [MainThread]: 
[0m12:39:07.087362 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:39:07.087843 [info ] [MainThread]: 
[0m12:39:07.088590 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:39:07.093747 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore_dw_test'
[0m12:39:07.101228 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore_stg'
[0m12:39:07.134426 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_test"
[0m12:39:07.134895 [debug] [ThreadPool]: Using postgres connection "list_superstore_stg"
[0m12:39:07.135848 [debug] [ThreadPool]: On list_superstore_stg: BEGIN
[0m12:39:07.136246 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:07.135430 [debug] [ThreadPool]: On list_superstore_dw_test: BEGIN
[0m12:39:07.138116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:07.148422 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m12:39:07.149036 [debug] [ThreadPool]: Using postgres connection "list_superstore_stg"
[0m12:39:07.149531 [debug] [ThreadPool]: On list_superstore_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore_stg"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'stg'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'stg'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'stg'
  
[0m12:39:07.152492 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m12:39:07.154328 [debug] [ThreadPool]: On list_superstore_stg: ROLLBACK
[0m12:39:07.155129 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m12:39:07.157118 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_test"
[0m12:39:07.157630 [debug] [ThreadPool]: On list_superstore_dw_test: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore_dw_test"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_test'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_test'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_test'
  
[0m12:39:07.158086 [debug] [ThreadPool]: On list_superstore_stg: Close
[0m12:39:07.162096 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m12:39:07.163638 [debug] [ThreadPool]: On list_superstore_dw_test: ROLLBACK
[0m12:39:07.164763 [debug] [ThreadPool]: On list_superstore_dw_test: Close
[0m12:39:07.172528 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:07.173161 [debug] [MainThread]: On master: BEGIN
[0m12:39:07.173554 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:39:07.180233 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m12:39:07.180761 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:07.181194 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m12:39:07.184200 [debug] [MainThread]: SQL status: SELECT 3 in 0.003 seconds
[0m12:39:07.186105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55ee2158-f503-4e12-92b6-b52f7799b778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa73d7974c0>]}
[0m12:39:07.186638 [debug] [MainThread]: On master: ROLLBACK
[0m12:39:07.187569 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:07.188028 [debug] [MainThread]: On master: BEGIN
[0m12:39:07.188653 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:39:07.189118 [debug] [MainThread]: On master: COMMIT
[0m12:39:07.189506 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:07.189941 [debug] [MainThread]: On master: COMMIT
[0m12:39:07.190421 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:39:07.190850 [debug] [MainThread]: On master: Close
[0m12:39:07.194749 [debug] [Thread-1 (]: Began running node test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m12:39:07.195658 [debug] [Thread-2 (]: Began running node test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m12:39:07.196387 [debug] [Thread-3 (]: Began running node test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688
[0m12:39:07.197186 [debug] [Thread-4 (]: Began running node test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m12:39:07.195261 [info ] [Thread-1 (]: 1 of 9 START test not_null_customer_dim_cust_id ................................ [RUN]
[0m12:39:07.198879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_superstore_stg, now test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42)
[0m12:39:07.199325 [debug] [Thread-1 (]: Began compiling node test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m12:39:07.196080 [info ] [Thread-2 (]: 2 of 9 START test not_null_geo_dim_geo_id ...................................... [RUN]
[0m12:39:07.212304 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_superstore_dw_test, now test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d)
[0m12:39:07.196879 [info ] [Thread-3 (]: 3 of 9 START test not_null_product_dim_prod_id ................................. [RUN]
[0m12:39:07.215926 [debug] [Thread-1 (]: Writing injected SQL for node "test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42"
[0m12:39:07.218105 [debug] [Thread-1 (]: Began executing node test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m12:39:07.216738 [debug] [Thread-2 (]: Began compiling node test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m12:39:07.217417 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688'
[0m12:39:07.246681 [debug] [Thread-3 (]: Began compiling node test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688
[0m12:39:07.198218 [info ] [Thread-4 (]: 4 of 9 START test not_null_shipping_dim_ship_id ................................ [RUN]
[0m12:39:07.251224 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d'
[0m12:39:07.251697 [debug] [Thread-4 (]: Began compiling node test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m12:39:07.245986 [debug] [Thread-1 (]: Writing runtime sql for node "test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42"
[0m12:39:07.257569 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42"
[0m12:39:07.258059 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42: BEGIN
[0m12:39:07.258484 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:39:07.250523 [debug] [Thread-3 (]: Writing injected SQL for node "test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688"
[0m12:39:07.259199 [debug] [Thread-3 (]: Began executing node test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688
[0m12:39:07.256316 [debug] [Thread-2 (]: Writing injected SQL for node "test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d"
[0m12:39:07.263699 [debug] [Thread-2 (]: Began executing node test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m12:39:07.255724 [debug] [Thread-4 (]: Writing injected SQL for node "test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d"
[0m12:39:07.262958 [debug] [Thread-3 (]: Writing runtime sql for node "test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688"
[0m12:39:07.273548 [debug] [Thread-3 (]: Using postgres connection "test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688"
[0m12:39:07.274041 [debug] [Thread-3 (]: On test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688: BEGIN
[0m12:39:07.274447 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:39:07.272672 [debug] [Thread-4 (]: Began executing node test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m12:39:07.278333 [debug] [Thread-4 (]: Writing runtime sql for node "test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d"
[0m12:39:07.282187 [debug] [Thread-4 (]: Using postgres connection "test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d"
[0m12:39:07.278881 [debug] [Thread-2 (]: Writing runtime sql for node "test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d"
[0m12:39:07.284935 [debug] [Thread-2 (]: Using postgres connection "test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d"
[0m12:39:07.285430 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d: BEGIN
[0m12:39:07.285899 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:39:07.281459 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m12:39:07.287706 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42"
[0m12:39:07.288217 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select cust_id
from "superstore"."dw_test"."customer_dim"
where cust_id is null



  
  
      
    ) dbt_internal_test
[0m12:39:07.282724 [debug] [Thread-4 (]: On test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d: BEGIN
[0m12:39:07.289460 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:39:07.291014 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m12:39:07.300770 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42: ROLLBACK
[0m12:39:07.302031 [debug] [Thread-3 (]: SQL status: BEGIN in 0.028 seconds
[0m12:39:07.302574 [debug] [Thread-3 (]: Using postgres connection "test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688"
[0m12:39:07.303053 [debug] [Thread-3 (]: On test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select prod_id
from "superstore"."dw_test"."product_dim"
where prod_id is null



  
  
      
    ) dbt_internal_test
[0m12:39:07.303744 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42: Close
[0m12:39:07.308191 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m12:39:07.313052 [debug] [Thread-3 (]: On test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688: ROLLBACK
[0m12:39:07.310813 [info ] [Thread-1 (]: 1 of 9 PASS not_null_customer_dim_cust_id ...................................... [[32mPASS[0m in 0.11s]
[0m12:39:07.314208 [debug] [Thread-1 (]: Finished running node test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m12:39:07.314835 [debug] [Thread-1 (]: Began running node test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m12:39:07.316191 [info ] [Thread-1 (]: 5 of 9 START test relationships_sales_fact_cust_id__cust_id__ref_customer_dim_ . [RUN]
[0m12:39:07.316910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42, now test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279)
[0m12:39:07.315387 [debug] [Thread-2 (]: SQL status: BEGIN in 0.029 seconds
[0m12:39:07.317360 [debug] [Thread-1 (]: Began compiling node test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m12:39:07.320927 [debug] [Thread-4 (]: SQL status: BEGIN in 0.031 seconds
[0m12:39:07.326791 [debug] [Thread-4 (]: Using postgres connection "test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d"
[0m12:39:07.319787 [debug] [Thread-3 (]: On test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688: Close
[0m12:39:07.328068 [info ] [Thread-3 (]: 3 of 9 PASS not_null_product_dim_prod_id ....................................... [[32mPASS[0m in 0.11s]
[0m12:39:07.326181 [debug] [Thread-1 (]: Writing injected SQL for node "test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"
[0m12:39:07.320317 [debug] [Thread-2 (]: Using postgres connection "test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d"
[0m12:39:07.332302 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select geo_id
from "superstore"."dw_test"."geo_dim"
where geo_id is null



  
  
      
    ) dbt_internal_test
[0m12:39:07.327316 [debug] [Thread-4 (]: On test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ship_id
from "superstore"."dw_test"."shipping_dim"
where ship_id is null



  
  
      
    ) dbt_internal_test
[0m12:39:07.328913 [debug] [Thread-3 (]: Finished running node test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688
[0m12:39:07.329728 [debug] [Thread-1 (]: Began executing node test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m12:39:07.333953 [debug] [Thread-3 (]: Began running node test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721
[0m12:39:07.335264 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m12:39:07.339860 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.007 seconds
[0m12:39:07.340401 [info ] [Thread-3 (]: 6 of 9 START test unique_customer_dim_cust_id .................................. [RUN]
[0m12:39:07.345599 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d: ROLLBACK
[0m12:39:07.339052 [debug] [Thread-1 (]: Writing runtime sql for node "test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"
[0m12:39:07.353123 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"
[0m12:39:07.353687 [debug] [Thread-1 (]: On test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279: BEGIN
[0m12:39:07.354123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:39:07.349439 [debug] [Thread-4 (]: On test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d: ROLLBACK
[0m12:39:07.351255 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688, now test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721)
[0m12:39:07.357815 [debug] [Thread-3 (]: Began compiling node test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721
[0m12:39:07.354597 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d: Close
[0m12:39:07.366525 [debug] [Thread-4 (]: On test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d: Close
[0m12:39:07.367544 [info ] [Thread-2 (]: 2 of 9 PASS not_null_geo_dim_geo_id ............................................ [[32mPASS[0m in 0.16s]
[0m12:39:07.375861 [debug] [Thread-2 (]: Finished running node test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m12:39:07.376596 [info ] [Thread-4 (]: 4 of 9 PASS not_null_shipping_dim_ship_id ...................................... [[32mPASS[0m in 0.13s]
[0m12:39:07.381688 [debug] [Thread-4 (]: Finished running node test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m12:39:07.380879 [debug] [Thread-2 (]: Began running node test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m12:39:07.379044 [debug] [Thread-3 (]: Writing injected SQL for node "test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721"
[0m12:39:07.385240 [debug] [Thread-1 (]: SQL status: BEGIN in 0.031 seconds
[0m12:39:07.383451 [debug] [Thread-4 (]: Began running node test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m12:39:07.386352 [debug] [Thread-3 (]: Began executing node test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721
[0m12:39:07.386886 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"
[0m12:39:07.385821 [info ] [Thread-2 (]: 7 of 9 START test unique_geo_dim_geo_id ........................................ [RUN]
[0m12:39:07.395854 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d, now test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2)
[0m12:39:07.396382 [debug] [Thread-2 (]: Began compiling node test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m12:39:07.395037 [debug] [Thread-1 (]: On test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select cust_id as from_field
    from "superstore"."dw_test"."sales_fact"
    where cust_id is not null
),

parent as (
    select cust_id as to_field
    from "superstore"."dw_test"."customer_dim"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m12:39:07.388056 [info ] [Thread-4 (]: 8 of 9 START test unique_product_dim_prod_id ................................... [RUN]
[0m12:39:07.403684 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d, now test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c)
[0m12:39:07.401826 [debug] [Thread-2 (]: Writing injected SQL for node "test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2"
[0m12:39:07.404937 [debug] [Thread-2 (]: Began executing node test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m12:39:07.391280 [debug] [Thread-3 (]: Writing runtime sql for node "test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721"
[0m12:39:07.404309 [debug] [Thread-4 (]: Began compiling node test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m12:39:07.407676 [debug] [Thread-2 (]: Writing runtime sql for node "test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2"
[0m12:39:07.416984 [debug] [Thread-2 (]: Using postgres connection "test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2"
[0m12:39:07.417488 [debug] [Thread-2 (]: On test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2: BEGIN
[0m12:39:07.417917 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:39:07.409075 [debug] [Thread-3 (]: Using postgres connection "test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721"
[0m12:39:07.415738 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.013 seconds
[0m12:39:07.422366 [debug] [Thread-1 (]: On test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279: ROLLBACK
[0m12:39:07.414678 [debug] [Thread-4 (]: Writing injected SQL for node "test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c"
[0m12:39:07.420671 [debug] [Thread-3 (]: On test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721: BEGIN
[0m12:39:07.424169 [debug] [Thread-4 (]: Began executing node test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m12:39:07.427770 [debug] [Thread-1 (]: On test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279: Close
[0m12:39:07.436269 [info ] [Thread-1 (]: 5 of 9 PASS relationships_sales_fact_cust_id__cust_id__ref_customer_dim_ ....... [[32mPASS[0m in 0.12s]
[0m12:39:07.434037 [debug] [Thread-4 (]: Writing runtime sql for node "test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c"
[0m12:39:07.429331 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:39:07.437229 [debug] [Thread-1 (]: Finished running node test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m12:39:07.438749 [debug] [Thread-2 (]: SQL status: BEGIN in 0.021 seconds
[0m12:39:07.440409 [debug] [Thread-4 (]: Using postgres connection "test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c"
[0m12:39:07.444811 [debug] [Thread-4 (]: On test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c: BEGIN
[0m12:39:07.445259 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:39:07.441248 [debug] [Thread-1 (]: Began running node test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m12:39:07.444029 [debug] [Thread-2 (]: Using postgres connection "test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2"
[0m12:39:07.448732 [debug] [Thread-2 (]: On test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    geo_id as unique_field,
    count(*) as n_records

from "superstore"."dw_test"."geo_dim"
where geo_id is not null
group by geo_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:39:07.446339 [info ] [Thread-1 (]: 9 of 9 START test unique_shipping_dim_ship_id .................................. [RUN]
[0m12:39:07.450690 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279, now test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7)
[0m12:39:07.455768 [debug] [Thread-1 (]: Began compiling node test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m12:39:07.456756 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.007 seconds
[0m12:39:07.466737 [debug] [Thread-2 (]: On test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2: ROLLBACK
[0m12:39:07.470434 [debug] [Thread-2 (]: On test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2: Close
[0m12:39:07.468501 [debug] [Thread-3 (]: SQL status: BEGIN in 0.040 seconds
[0m12:39:07.476577 [debug] [Thread-3 (]: Using postgres connection "test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721"
[0m12:39:07.469073 [debug] [Thread-1 (]: Writing injected SQL for node "test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7"
[0m12:39:07.474277 [info ] [Thread-2 (]: 7 of 9 PASS unique_geo_dim_geo_id .............................................. [[32mPASS[0m in 0.08s]
[0m12:39:07.469559 [debug] [Thread-4 (]: SQL status: BEGIN in 0.024 seconds
[0m12:39:07.479943 [debug] [Thread-4 (]: Using postgres connection "test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c"
[0m12:39:07.480421 [debug] [Thread-4 (]: On test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    prod_id as unique_field,
    count(*) as n_records

from "superstore"."dw_test"."product_dim"
where prod_id is not null
group by prod_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:39:07.478925 [debug] [Thread-2 (]: Finished running node test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m12:39:07.481126 [debug] [Thread-1 (]: Began executing node test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m12:39:07.477710 [debug] [Thread-3 (]: On test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    cust_id as unique_field,
    count(*) as n_records

from "superstore"."dw_test"."customer_dim"
where cust_id is not null
group by cust_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:39:07.489640 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.008 seconds
[0m12:39:07.493029 [debug] [Thread-4 (]: On test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c: ROLLBACK
[0m12:39:07.494061 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.006 seconds
[0m12:39:07.486442 [debug] [Thread-1 (]: Writing runtime sql for node "test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7"
[0m12:39:07.498806 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7"
[0m12:39:07.499328 [debug] [Thread-1 (]: On test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7: BEGIN
[0m12:39:07.497567 [debug] [Thread-3 (]: On test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721: ROLLBACK
[0m12:39:07.502509 [debug] [Thread-3 (]: On test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721: Close
[0m12:39:07.500621 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:39:07.501589 [debug] [Thread-4 (]: On test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c: Close
[0m12:39:07.504306 [info ] [Thread-3 (]: 6 of 9 PASS unique_customer_dim_cust_id ........................................ [[32mPASS[0m in 0.15s]
[0m12:39:07.515098 [debug] [Thread-3 (]: Finished running node test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721
[0m12:39:07.513025 [info ] [Thread-4 (]: 8 of 9 PASS unique_product_dim_prod_id ......................................... [[32mPASS[0m in 0.11s]
[0m12:39:07.518254 [debug] [Thread-4 (]: Finished running node test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m12:39:07.528548 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m12:39:07.529120 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7"
[0m12:39:07.532122 [debug] [Thread-1 (]: On test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    ship_id as unique_field,
    count(*) as n_records

from "superstore"."dw_test"."shipping_dim"
where ship_id is not null
group by ship_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:39:07.534982 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m12:39:07.537011 [debug] [Thread-1 (]: On test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7: ROLLBACK
[0m12:39:07.541914 [debug] [Thread-1 (]: On test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7: Close
[0m12:39:07.544831 [info ] [Thread-1 (]: 9 of 9 PASS unique_shipping_dim_ship_id ........................................ [[32mPASS[0m in 0.09s]
[0m12:39:07.547727 [debug] [Thread-1 (]: Finished running node test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m12:39:07.550395 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:07.552077 [debug] [MainThread]: On master: BEGIN
[0m12:39:07.553037 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:39:07.566156 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m12:39:07.567351 [debug] [MainThread]: On master: COMMIT
[0m12:39:07.568243 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:07.569140 [debug] [MainThread]: On master: COMMIT
[0m12:39:07.570398 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:39:07.570900 [debug] [MainThread]: On master: Close
[0m12:39:07.572845 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:39:07.573307 [debug] [MainThread]: Connection 'test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2' was properly closed.
[0m12:39:07.578153 [debug] [MainThread]: Connection 'test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7' was properly closed.
[0m12:39:07.579098 [debug] [MainThread]: Connection 'test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721' was properly closed.
[0m12:39:07.579485 [debug] [MainThread]: Connection 'test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c' was properly closed.
[0m12:39:07.581797 [info ] [MainThread]: 
[0m12:39:07.583531 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m12:39:07.589161 [debug] [MainThread]: Command end result
[0m12:39:07.652828 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/manifest.json
[0m12:39:07.656747 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/semantic_manifest.json
[0m12:39:07.671775 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dev/Downloads/pde_magistr/superstore_dwh/target/run_results.json
[0m12:39:07.672293 [info ] [MainThread]: 
[0m12:39:07.673131 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:39:07.673931 [info ] [MainThread]: 
[0m12:39:07.674594 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=9
[0m12:39:07.675408 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:39:07.677766 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.5652375, "process_in_blocks": "0", "process_kernel_time": 0.168978, "process_mem_max_rss": "122340", "process_out_blocks": "3016", "process_user_time": 2.343696}
[0m12:39:07.678704 [debug] [MainThread]: Command `dbt test` succeeded at 12:39:07.678522 after 1.57 seconds
[0m12:39:07.679169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7403ad7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa73d796c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa73d795330>]}
[0m12:39:07.679907 [debug] [MainThread]: Flushing usage events
[0m12:39:08.284246 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:41:54.871902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6c937ad810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6c92768220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6c927681c0>]}


============================== 12:41:54.874603 | 3fb7da91-f06a-40b9-8621-5054df2e5a9b ==============================
[0m12:41:54.874603 [info ] [MainThread]: Running with dbt=1.10.11
[0m12:41:54.875219 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'printer_width': '80', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'partial_parse': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'no_print': 'None', 'debug': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'log_path': '/home/dev/Downloads/pde_magistr/superstore_dwh/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test', 'target_path': 'None', 'use_experimental_parser': 'False', 'warn_error': 'None', 'use_colors': 'True', 'empty': 'None', 'log_cache_events': 'False', 'write_json': 'True', 'profiles_dir': '/home/dev/.dbt'}
[0m12:41:55.037770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3fb7da91-f06a-40b9-8621-5054df2e5a9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6c9270a080>]}
[0m12:41:55.099017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3fb7da91-f06a-40b9-8621-5054df2e5a9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6c92fe6bc0>]}
[0m12:41:55.099865 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m12:41:55.199325 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m12:41:55.332181 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:41:55.333088 [debug] [MainThread]: Partial parsing: updated file: superstore_dwh://models/marts/schema.yml
[0m12:41:55.810915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3fb7da91-f06a-40b9-8621-5054df2e5a9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6c90374a00>]}
[0m12:41:55.902770 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/manifest.json
[0m12:41:55.904521 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/semantic_manifest.json
[0m12:41:55.925466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3fb7da91-f06a-40b9-8621-5054df2e5a9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6c90377220>]}
[0m12:41:55.926091 [info ] [MainThread]: Found 7 models, 9 data tests, 1 source, 435 macros
[0m12:41:55.926504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fb7da91-f06a-40b9-8621-5054df2e5a9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6c90377700>]}
[0m12:41:55.928464 [info ] [MainThread]: 
[0m12:41:55.928982 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:41:55.929348 [info ] [MainThread]: 
[0m12:41:55.929954 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:41:55.935500 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore_dw_test'
[0m12:41:55.941637 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore_stg'
[0m12:41:55.981337 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_test"
[0m12:41:55.983499 [debug] [ThreadPool]: On list_superstore_dw_test: BEGIN
[0m12:41:55.981963 [debug] [ThreadPool]: Using postgres connection "list_superstore_stg"
[0m12:41:55.984409 [debug] [ThreadPool]: On list_superstore_stg: BEGIN
[0m12:41:55.984734 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:41:55.984010 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:41:55.997267 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m12:41:55.998074 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_test"
[0m12:41:55.998618 [debug] [ThreadPool]: On list_superstore_dw_test: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore_dw_test"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_test'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_test'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_test'
  
[0m12:41:56.001734 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m12:41:56.003433 [debug] [ThreadPool]: On list_superstore_dw_test: ROLLBACK
[0m12:41:56.004782 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m12:41:56.006004 [debug] [ThreadPool]: Using postgres connection "list_superstore_stg"
[0m12:41:56.005541 [debug] [ThreadPool]: On list_superstore_dw_test: Close
[0m12:41:56.006383 [debug] [ThreadPool]: On list_superstore_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore_stg"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'stg'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'stg'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'stg'
  
[0m12:41:56.011662 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m12:41:56.012985 [debug] [ThreadPool]: On list_superstore_stg: ROLLBACK
[0m12:41:56.014863 [debug] [ThreadPool]: On list_superstore_stg: Close
[0m12:41:56.022716 [debug] [MainThread]: Using postgres connection "master"
[0m12:41:56.023426 [debug] [MainThread]: On master: BEGIN
[0m12:41:56.023892 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:41:56.031270 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m12:41:56.032142 [debug] [MainThread]: Using postgres connection "master"
[0m12:41:56.032626 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m12:41:56.036116 [debug] [MainThread]: SQL status: SELECT 3 in 0.003 seconds
[0m12:41:56.038355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fb7da91-f06a-40b9-8621-5054df2e5a9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6c903d8f10>]}
[0m12:41:56.038968 [debug] [MainThread]: On master: ROLLBACK
[0m12:41:56.039850 [debug] [MainThread]: Using postgres connection "master"
[0m12:41:56.040277 [debug] [MainThread]: On master: BEGIN
[0m12:41:56.040994 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:41:56.041422 [debug] [MainThread]: On master: COMMIT
[0m12:41:56.042061 [debug] [MainThread]: Using postgres connection "master"
[0m12:41:56.042454 [debug] [MainThread]: On master: COMMIT
[0m12:41:56.043034 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:41:56.043460 [debug] [MainThread]: On master: Close
[0m12:41:56.047717 [debug] [Thread-1 (]: Began running node test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m12:41:56.048596 [debug] [Thread-2 (]: Began running node test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m12:41:56.049696 [debug] [Thread-3 (]: Began running node test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688
[0m12:41:56.050420 [debug] [Thread-4 (]: Began running node test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m12:41:56.048240 [info ] [Thread-1 (]: 1 of 9 START test not_null_customer_dim_cust_id ................................ [RUN]
[0m12:41:56.049039 [info ] [Thread-2 (]: 2 of 9 START test not_null_geo_dim_geo_id ...................................... [RUN]
[0m12:41:56.050120 [info ] [Thread-3 (]: 3 of 9 START test not_null_product_dim_prod_id ................................. [RUN]
[0m12:41:56.052109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_superstore_stg, now test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42)
[0m12:41:56.053922 [debug] [Thread-1 (]: Began compiling node test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m12:41:56.051136 [info ] [Thread-4 (]: 4 of 9 START test not_null_shipping_dim_ship_id ................................ [RUN]
[0m12:41:56.060852 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d'
[0m12:41:56.061352 [debug] [Thread-4 (]: Began compiling node test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m12:41:56.052728 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_superstore_dw_test, now test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d)
[0m12:41:56.053412 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688'
[0m12:41:56.069425 [debug] [Thread-2 (]: Began compiling node test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m12:41:56.072541 [debug] [Thread-1 (]: Writing injected SQL for node "test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42"
[0m12:41:56.078315 [debug] [Thread-1 (]: Began executing node test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m12:41:56.073618 [debug] [Thread-3 (]: Began compiling node test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688
[0m12:41:56.073171 [debug] [Thread-4 (]: Writing injected SQL for node "test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d"
[0m12:41:56.104598 [debug] [Thread-4 (]: Began executing node test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m12:41:56.077537 [debug] [Thread-2 (]: Writing injected SQL for node "test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d"
[0m12:41:56.109487 [debug] [Thread-2 (]: Began executing node test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m12:41:56.103700 [debug] [Thread-3 (]: Writing injected SQL for node "test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688"
[0m12:41:56.108597 [debug] [Thread-4 (]: Writing runtime sql for node "test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d"
[0m12:41:56.113313 [debug] [Thread-4 (]: Using postgres connection "test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d"
[0m12:41:56.112275 [debug] [Thread-2 (]: Writing runtime sql for node "test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d"
[0m12:41:56.105392 [debug] [Thread-1 (]: Writing runtime sql for node "test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42"
[0m12:41:56.115942 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42"
[0m12:41:56.114924 [debug] [Thread-4 (]: On test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d: BEGIN
[0m12:41:56.116481 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42: BEGIN
[0m12:41:56.114017 [debug] [Thread-3 (]: Began executing node test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688
[0m12:41:56.119460 [debug] [Thread-2 (]: Using postgres connection "test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d"
[0m12:41:56.120140 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:41:56.120679 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:41:56.123694 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d: BEGIN
[0m12:41:56.125459 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:41:56.123190 [debug] [Thread-3 (]: Writing runtime sql for node "test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688"
[0m12:41:56.129778 [debug] [Thread-3 (]: Using postgres connection "test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688"
[0m12:41:56.130262 [debug] [Thread-3 (]: On test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688: BEGIN
[0m12:41:56.131436 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:41:56.133881 [debug] [Thread-4 (]: SQL status: BEGIN in 0.014 seconds
[0m12:41:56.134408 [debug] [Thread-4 (]: Using postgres connection "test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d"
[0m12:41:56.140337 [debug] [Thread-4 (]: On test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ship_id
from "superstore"."dw_test"."shipping_dim"
where ship_id is null



  
  
      
    ) dbt_internal_test
[0m12:41:56.142475 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m12:41:56.150896 [debug] [Thread-4 (]: On test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d: ROLLBACK
[0m12:41:56.152842 [debug] [Thread-1 (]: SQL status: BEGIN in 0.031 seconds
[0m12:41:56.154117 [debug] [Thread-4 (]: On test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d: Close
[0m12:41:56.153518 [debug] [Thread-2 (]: SQL status: BEGIN in 0.028 seconds
[0m12:41:56.154753 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42"
[0m12:41:56.155423 [debug] [Thread-3 (]: SQL status: BEGIN in 0.024 seconds
[0m12:41:56.156463 [info ] [Thread-4 (]: 4 of 9 PASS not_null_shipping_dim_ship_id ...................................... [[32mPASS[0m in 0.10s]
[0m12:41:56.159064 [debug] [Thread-2 (]: Using postgres connection "test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d"
[0m12:41:56.159562 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select cust_id
from "superstore"."dw_test"."customer_dim"
where cust_id is null



  
  
      
    ) dbt_internal_test
[0m12:41:56.160051 [debug] [Thread-3 (]: Using postgres connection "test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688"
[0m12:41:56.160675 [debug] [Thread-4 (]: Finished running node test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m12:41:56.161185 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select geo_id
from "superstore"."dw_test"."geo_dim"
where geo_id is null



  
  
      
    ) dbt_internal_test
[0m12:41:56.161779 [debug] [Thread-3 (]: On test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select prod_id
from "superstore"."dw_test"."product_dim"
where prod_id is null



  
  
      
    ) dbt_internal_test
[0m12:41:56.162661 [debug] [Thread-4 (]: Began running node test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m12:41:56.164962 [info ] [Thread-4 (]: 5 of 9 START test relationships_sales_fact_cust_id__cust_id__ref_customer_dim_ . [RUN]
[0m12:41:56.163292 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m12:41:56.167985 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d, now test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279)
[0m12:41:56.168745 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.005 seconds
[0m12:41:56.178293 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d: ROLLBACK
[0m12:41:56.170823 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42: ROLLBACK
[0m12:41:56.176839 [debug] [Thread-4 (]: Began compiling node test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m12:41:56.174048 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.010 seconds
[0m12:41:56.186167 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42: Close
[0m12:41:56.188262 [debug] [Thread-3 (]: On test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688: ROLLBACK
[0m12:41:56.186704 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d: Close
[0m12:41:56.184153 [debug] [Thread-4 (]: Writing injected SQL for node "test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"
[0m12:41:56.192185 [debug] [Thread-4 (]: Began executing node test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m12:41:56.190111 [info ] [Thread-1 (]: 1 of 9 PASS not_null_customer_dim_cust_id ...................................... [[32mPASS[0m in 0.14s]
[0m12:41:56.199406 [debug] [Thread-1 (]: Finished running node test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m12:41:56.199955 [debug] [Thread-1 (]: Began running node test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721
[0m12:41:56.200763 [debug] [Thread-3 (]: On test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688: Close
[0m12:41:56.191443 [info ] [Thread-2 (]: 2 of 9 PASS not_null_geo_dim_geo_id ............................................ [[32mPASS[0m in 0.14s]
[0m12:41:56.201931 [debug] [Thread-2 (]: Finished running node test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m12:41:56.198077 [debug] [Thread-4 (]: Writing runtime sql for node "test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"
[0m12:41:56.204345 [debug] [Thread-4 (]: Using postgres connection "test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"
[0m12:41:56.202396 [debug] [Thread-2 (]: Began running node test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m12:41:56.203480 [info ] [Thread-3 (]: 3 of 9 PASS not_null_product_dim_prod_id ....................................... [[32mPASS[0m in 0.15s]
[0m12:41:56.206234 [debug] [Thread-3 (]: Finished running node test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688
[0m12:41:56.204916 [debug] [Thread-4 (]: On test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279: BEGIN
[0m12:41:56.207687 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:41:56.200368 [info ] [Thread-1 (]: 6 of 9 START test unique_customer_dim_cust_id .................................. [RUN]
[0m12:41:56.209424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42, now test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721)
[0m12:41:56.210007 [debug] [Thread-1 (]: Began compiling node test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721
[0m12:41:56.206697 [debug] [Thread-3 (]: Began running node test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m12:41:56.205473 [info ] [Thread-2 (]: 7 of 9 START test unique_geo_dim_geo_id ........................................ [RUN]
[0m12:41:56.218274 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d, now test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2)
[0m12:41:56.218790 [debug] [Thread-2 (]: Began compiling node test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m12:41:56.229130 [debug] [Thread-1 (]: Writing injected SQL for node "test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721"
[0m12:41:56.217567 [info ] [Thread-3 (]: 8 of 9 START test unique_product_dim_prod_id ................................... [RUN]
[0m12:41:56.230993 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688, now test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c)
[0m12:41:56.231456 [debug] [Thread-3 (]: Began compiling node test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m12:41:56.225096 [debug] [Thread-2 (]: Writing injected SQL for node "test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2"
[0m12:41:56.230276 [debug] [Thread-4 (]: SQL status: BEGIN in 0.023 seconds
[0m12:41:56.238544 [debug] [Thread-4 (]: Using postgres connection "test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"
[0m12:41:56.239088 [debug] [Thread-4 (]: On test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select cust_id as from_field
    from "superstore"."dw_test"."sales_fact"
    where cust_id is not null
),

parent as (
    select cust_id as to_field
    from "superstore"."dw_test"."customer_dim"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m12:41:56.236933 [debug] [Thread-2 (]: Began executing node test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m12:41:56.237970 [debug] [Thread-1 (]: Began executing node test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721
[0m12:41:56.235885 [debug] [Thread-3 (]: Writing injected SQL for node "test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c"
[0m12:41:56.247926 [debug] [Thread-3 (]: Began executing node test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m12:41:56.247229 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.008 seconds
[0m12:41:56.257043 [debug] [Thread-4 (]: On test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279: ROLLBACK
[0m12:41:56.243696 [debug] [Thread-2 (]: Writing runtime sql for node "test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2"
[0m12:41:56.251323 [debug] [Thread-3 (]: Writing runtime sql for node "test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c"
[0m12:41:56.259205 [debug] [Thread-3 (]: Using postgres connection "test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c"
[0m12:41:56.260130 [debug] [Thread-3 (]: On test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c: BEGIN
[0m12:41:56.246386 [debug] [Thread-1 (]: Writing runtime sql for node "test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721"
[0m12:41:56.261364 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721"
[0m12:41:56.261827 [debug] [Thread-1 (]: On test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721: BEGIN
[0m12:41:56.262207 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:41:56.262823 [debug] [Thread-4 (]: On test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279: Close
[0m12:41:56.263627 [debug] [Thread-2 (]: Using postgres connection "test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2"
[0m12:41:56.264079 [debug] [Thread-2 (]: On test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2: BEGIN
[0m12:41:56.264488 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:41:56.260737 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:41:56.266554 [info ] [Thread-4 (]: 5 of 9 PASS relationships_sales_fact_cust_id__cust_id__ref_customer_dim_ ....... [[32mPASS[0m in 0.10s]
[0m12:41:56.270979 [debug] [Thread-4 (]: Finished running node test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m12:41:56.281918 [debug] [Thread-4 (]: Began running node test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m12:41:56.282454 [info ] [Thread-4 (]: 9 of 9 START test unique_shipping_dim_ship_id .................................. [RUN]
[0m12:41:56.287147 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279, now test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7)
[0m12:41:56.288482 [debug] [Thread-4 (]: Began compiling node test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m12:41:56.297267 [debug] [Thread-4 (]: Writing injected SQL for node "test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7"
[0m12:41:56.299719 [debug] [Thread-4 (]: Began executing node test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m12:41:56.298420 [debug] [Thread-2 (]: SQL status: BEGIN in 0.034 seconds
[0m12:41:56.303797 [debug] [Thread-2 (]: Using postgres connection "test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2"
[0m12:41:56.297771 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m12:41:56.304786 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721"
[0m12:41:56.305188 [debug] [Thread-1 (]: On test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    cust_id as unique_field,
    count(*) as n_records

from "superstore"."dw_test"."customer_dim"
where cust_id is not null
group by cust_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:41:56.304279 [debug] [Thread-2 (]: On test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    geo_id as unique_field,
    count(*) as n_records

from "superstore"."dw_test"."geo_dim"
where geo_id is not null
group by geo_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:41:56.303204 [debug] [Thread-4 (]: Writing runtime sql for node "test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7"
[0m12:41:56.306966 [debug] [Thread-4 (]: Using postgres connection "test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7"
[0m12:41:56.298950 [debug] [Thread-3 (]: SQL status: BEGIN in 0.038 seconds
[0m12:41:56.308941 [debug] [Thread-3 (]: Using postgres connection "test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c"
[0m12:41:56.310120 [debug] [Thread-3 (]: On test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    prod_id as unique_field,
    count(*) as n_records

from "superstore"."dw_test"."product_dim"
where prod_id is not null
group by prod_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:41:56.310789 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m12:41:56.309666 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m12:41:56.308296 [debug] [Thread-4 (]: On test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7: BEGIN
[0m12:41:56.314233 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:41:56.312232 [debug] [Thread-1 (]: On test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721: ROLLBACK
[0m12:41:56.313712 [debug] [Thread-2 (]: On test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2: ROLLBACK
[0m12:41:56.315042 [debug] [Thread-1 (]: On test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721: Close
[0m12:41:56.316417 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.006 seconds
[0m12:41:56.324367 [debug] [Thread-3 (]: On test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c: ROLLBACK
[0m12:41:56.320242 [debug] [Thread-2 (]: On test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2: Close
[0m12:41:56.318436 [info ] [Thread-1 (]: 6 of 9 PASS unique_customer_dim_cust_id ........................................ [[32mPASS[0m in 0.11s]
[0m12:41:56.327399 [debug] [Thread-1 (]: Finished running node test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721
[0m12:41:56.331441 [debug] [Thread-4 (]: SQL status: BEGIN in 0.017 seconds
[0m12:41:56.332213 [debug] [Thread-4 (]: Using postgres connection "test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7"
[0m12:41:56.326573 [info ] [Thread-2 (]: 7 of 9 PASS unique_geo_dim_geo_id .............................................. [[32mPASS[0m in 0.11s]
[0m12:41:56.328662 [debug] [Thread-3 (]: On test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c: Close
[0m12:41:56.332744 [debug] [Thread-4 (]: On test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    ship_id as unique_field,
    count(*) as n_records

from "superstore"."dw_test"."shipping_dim"
where ship_id is not null
group by ship_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:41:56.333419 [debug] [Thread-2 (]: Finished running node test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m12:41:56.334831 [info ] [Thread-3 (]: 8 of 9 PASS unique_product_dim_prod_id ......................................... [[32mPASS[0m in 0.10s]
[0m12:41:56.336185 [debug] [Thread-3 (]: Finished running node test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m12:41:56.339797 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m12:41:56.341814 [debug] [Thread-4 (]: On test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7: ROLLBACK
[0m12:41:56.342811 [debug] [Thread-4 (]: On test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7: Close
[0m12:41:56.350424 [info ] [Thread-4 (]: 9 of 9 PASS unique_shipping_dim_ship_id ........................................ [[32mPASS[0m in 0.06s]
[0m12:41:56.351840 [debug] [Thread-4 (]: Finished running node test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m12:41:56.355427 [debug] [MainThread]: Using postgres connection "master"
[0m12:41:56.355983 [debug] [MainThread]: On master: BEGIN
[0m12:41:56.357984 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:41:56.373317 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m12:41:56.373963 [debug] [MainThread]: On master: COMMIT
[0m12:41:56.374412 [debug] [MainThread]: Using postgres connection "master"
[0m12:41:56.374831 [debug] [MainThread]: On master: COMMIT
[0m12:41:56.375497 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:41:56.375980 [debug] [MainThread]: On master: Close
[0m12:41:56.376509 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:41:56.376985 [debug] [MainThread]: Connection 'test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2' was properly closed.
[0m12:41:56.377335 [debug] [MainThread]: Connection 'test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721' was properly closed.
[0m12:41:56.379222 [debug] [MainThread]: Connection 'test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c' was properly closed.
[0m12:41:56.379660 [debug] [MainThread]: Connection 'test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7' was properly closed.
[0m12:41:56.380080 [info ] [MainThread]: 
[0m12:41:56.380532 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m12:41:56.382800 [debug] [MainThread]: Command end result
[0m12:41:56.403832 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/manifest.json
[0m12:41:56.405540 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/semantic_manifest.json
[0m12:41:56.412831 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dev/Downloads/pde_magistr/superstore_dwh/target/run_results.json
[0m12:41:56.413302 [info ] [MainThread]: 
[0m12:41:56.414047 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:41:56.414643 [info ] [MainThread]: 
[0m12:41:56.415216 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=9
[0m12:41:56.416342 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.5995383, "process_in_blocks": "0", "process_kernel_time": 0.185924, "process_mem_max_rss": "125144", "process_out_blocks": "3008", "process_user_time": 2.419981}
[0m12:41:56.421849 [debug] [MainThread]: Command `dbt test` succeeded at 12:41:56.421660 after 1.61 seconds
[0m12:41:56.422377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6c937ad810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6c92fe6bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6c93691750>]}
[0m12:41:56.425026 [debug] [MainThread]: Flushing usage events
[0m12:41:57.056129 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:51:24.299458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75af999d57b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75af9898c1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75af9898c190>]}


============================== 12:51:24.302735 | 1ce91ec6-2066-4de6-bdab-9fff4580ff2f ==============================
[0m12:51:24.302735 [info ] [MainThread]: Running with dbt=1.10.11
[0m12:51:24.303671 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'partial_parse': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'log_format': 'default', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'target_path': 'None', 'debug': 'False', 'log_cache_events': 'False', 'printer_width': '80', 'profiles_dir': '/home/dev/.dbt', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_path': '/home/dev/Downloads/pde_magistr/superstore_dwh/logs', 'cache_selected_only': 'False', 'no_print': 'None', 'use_colors': 'True', 'write_json': 'True', 'fail_fast': 'False'}
[0m12:51:24.487125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ce91ec6-2066-4de6-bdab-9fff4580ff2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75af9b4c7580>]}
[0m12:51:24.547873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ce91ec6-2066-4de6-bdab-9fff4580ff2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75af9898fe80>]}
[0m12:51:24.548712 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m12:51:24.659959 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m12:51:24.790140 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:51:24.790585 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:51:24.842301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ce91ec6-2066-4de6-bdab-9fff4580ff2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75af96f48fa0>]}
[0m12:51:24.854241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ce91ec6-2066-4de6-bdab-9fff4580ff2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75af97bf6cb0>]}
[0m12:51:24.854855 [info ] [MainThread]: Found 7 models, 9 data tests, 1 source, 435 macros
[0m12:51:24.855260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ce91ec6-2066-4de6-bdab-9fff4580ff2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75af988e4a90>]}
[0m12:51:24.857226 [info ] [MainThread]: 
[0m12:51:24.857720 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:51:24.858090 [info ] [MainThread]: 
[0m12:51:24.858665 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:51:24.863211 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore_stg'
[0m12:51:24.881827 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore_dw_test'
[0m12:51:24.978344 [debug] [ThreadPool]: Using postgres connection "list_superstore_stg"
[0m12:51:24.978845 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_test"
[0m12:51:24.979771 [debug] [ThreadPool]: On list_superstore_dw_test: BEGIN
[0m12:51:24.979376 [debug] [ThreadPool]: On list_superstore_stg: BEGIN
[0m12:51:24.980643 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:51:24.980105 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:51:24.989069 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m12:51:24.989607 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_test"
[0m12:51:24.989995 [debug] [ThreadPool]: On list_superstore_dw_test: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore_dw_test"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_test'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_test'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_test'
  
[0m12:51:24.990523 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m12:51:24.990928 [debug] [ThreadPool]: Using postgres connection "list_superstore_stg"
[0m12:51:24.991757 [debug] [ThreadPool]: On list_superstore_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore_stg"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'stg'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'stg'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'stg'
  
[0m12:51:24.993787 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m12:51:24.995187 [debug] [ThreadPool]: On list_superstore_dw_test: ROLLBACK
[0m12:51:24.995837 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m12:51:24.996319 [debug] [ThreadPool]: On list_superstore_dw_test: Close
[0m12:51:24.997519 [debug] [ThreadPool]: On list_superstore_stg: ROLLBACK
[0m12:51:25.001052 [debug] [ThreadPool]: On list_superstore_stg: Close
[0m12:51:25.006794 [debug] [MainThread]: Using postgres connection "master"
[0m12:51:25.007763 [debug] [MainThread]: On master: BEGIN
[0m12:51:25.008158 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:51:25.016085 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m12:51:25.016570 [debug] [MainThread]: Using postgres connection "master"
[0m12:51:25.016990 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m12:51:25.020113 [debug] [MainThread]: SQL status: SELECT 3 in 0.003 seconds
[0m12:51:25.022053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ce91ec6-2066-4de6-bdab-9fff4580ff2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75af96fe1de0>]}
[0m12:51:25.022646 [debug] [MainThread]: On master: ROLLBACK
[0m12:51:25.023345 [debug] [MainThread]: On master: Close
[0m12:51:25.026822 [debug] [Thread-1 (]: Began running node model.superstore_dwh.calendar_dim
[0m12:51:25.027423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_superstore_dw_test, now model.superstore_dwh.calendar_dim)
[0m12:51:25.027898 [debug] [Thread-2 (]: Began running node model.superstore_dwh.stg_orders
[0m12:51:25.028393 [debug] [Thread-1 (]: Began compiling node model.superstore_dwh.calendar_dim
[0m12:51:25.028911 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_superstore_stg, now model.superstore_dwh.stg_orders)
[0m12:51:25.035822 [debug] [Thread-1 (]: Writing injected SQL for node "model.superstore_dwh.calendar_dim"
[0m12:51:25.036312 [debug] [Thread-2 (]: Began compiling node model.superstore_dwh.stg_orders
[0m12:51:25.044997 [debug] [Thread-1 (]: Began executing node model.superstore_dwh.calendar_dim
[0m12:51:25.046168 [debug] [Thread-1 (]: Finished running node model.superstore_dwh.calendar_dim
[0m12:51:25.048878 [debug] [Thread-2 (]: Writing injected SQL for node "model.superstore_dwh.stg_orders"
[0m12:51:25.051282 [debug] [Thread-2 (]: Began executing node model.superstore_dwh.stg_orders
[0m12:51:25.053234 [debug] [Thread-2 (]: Finished running node model.superstore_dwh.stg_orders
[0m12:51:25.055667 [debug] [Thread-4 (]: Began running node model.superstore_dwh.customer_dim
[0m12:51:25.056312 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.superstore_dwh.customer_dim'
[0m12:51:25.056788 [debug] [Thread-4 (]: Began compiling node model.superstore_dwh.customer_dim
[0m12:51:25.060890 [debug] [Thread-4 (]: Writing injected SQL for node "model.superstore_dwh.customer_dim"
[0m12:51:25.061455 [debug] [Thread-3 (]: Began running node model.superstore_dwh.geo_dim
[0m12:51:25.064489 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.superstore_dwh.geo_dim'
[0m12:51:25.065089 [debug] [Thread-3 (]: Began compiling node model.superstore_dwh.geo_dim
[0m12:51:25.063764 [debug] [Thread-1 (]: Began running node model.superstore_dwh.product_dim
[0m12:51:25.069768 [debug] [Thread-2 (]: Began running node model.superstore_dwh.shipping_dim
[0m12:51:25.070455 [debug] [Thread-4 (]: Began executing node model.superstore_dwh.customer_dim
[0m12:51:25.071608 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.stg_orders, now model.superstore_dwh.shipping_dim)
[0m12:51:25.072647 [debug] [Thread-4 (]: Finished running node model.superstore_dwh.customer_dim
[0m12:51:25.073180 [debug] [Thread-2 (]: Began compiling node model.superstore_dwh.shipping_dim
[0m12:51:25.070985 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.calendar_dim, now model.superstore_dwh.product_dim)
[0m12:51:25.069248 [debug] [Thread-3 (]: Writing injected SQL for node "model.superstore_dwh.geo_dim"
[0m12:51:25.076293 [debug] [Thread-2 (]: Writing injected SQL for node "model.superstore_dwh.shipping_dim"
[0m12:51:25.080841 [debug] [Thread-2 (]: Began executing node model.superstore_dwh.shipping_dim
[0m12:51:25.078002 [debug] [Thread-3 (]: Began executing node model.superstore_dwh.geo_dim
[0m12:51:25.082569 [debug] [Thread-3 (]: Finished running node model.superstore_dwh.geo_dim
[0m12:51:25.077033 [debug] [Thread-1 (]: Began compiling node model.superstore_dwh.product_dim
[0m12:51:25.081718 [debug] [Thread-2 (]: Finished running node model.superstore_dwh.shipping_dim
[0m12:51:25.080025 [debug] [Thread-4 (]: Began running node test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m12:51:25.090737 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.customer_dim, now test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42)
[0m12:51:25.091219 [debug] [Thread-4 (]: Began compiling node test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m12:51:25.083091 [debug] [Thread-3 (]: Began running node test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721
[0m12:51:25.098534 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.geo_dim, now test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721)
[0m12:51:25.089752 [debug] [Thread-1 (]: Writing injected SQL for node "model.superstore_dwh.product_dim"
[0m12:51:25.097830 [debug] [Thread-2 (]: Began running node test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m12:51:25.107917 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.shipping_dim, now test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d)
[0m12:51:25.108430 [debug] [Thread-2 (]: Began compiling node test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m12:51:25.099023 [debug] [Thread-3 (]: Began compiling node test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721
[0m12:51:25.107347 [debug] [Thread-1 (]: Began executing node model.superstore_dwh.product_dim
[0m12:51:25.120215 [debug] [Thread-1 (]: Finished running node model.superstore_dwh.product_dim
[0m12:51:25.120738 [debug] [Thread-1 (]: Began running node test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m12:51:25.121269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.product_dim, now test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2)
[0m12:51:25.106554 [debug] [Thread-4 (]: Writing injected SQL for node "test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42"
[0m12:51:25.112697 [debug] [Thread-2 (]: Writing injected SQL for node "test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d"
[0m12:51:25.119167 [debug] [Thread-3 (]: Writing injected SQL for node "test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721"
[0m12:51:25.124192 [debug] [Thread-3 (]: Began executing node test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721
[0m12:51:25.125036 [debug] [Thread-3 (]: Finished running node test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721
[0m12:51:25.122644 [debug] [Thread-4 (]: Began executing node test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m12:51:25.123414 [debug] [Thread-2 (]: Began executing node test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m12:51:25.127253 [debug] [Thread-2 (]: Finished running node test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m12:51:25.127746 [debug] [Thread-2 (]: Began running node test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m12:51:25.121722 [debug] [Thread-1 (]: Began compiling node test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m12:51:25.126479 [debug] [Thread-4 (]: Finished running node test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m12:51:25.133284 [debug] [Thread-4 (]: Began running node model.superstore_dwh.sales_fact
[0m12:51:25.133881 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42, now model.superstore_dwh.sales_fact)
[0m12:51:25.134308 [debug] [Thread-4 (]: Began compiling node model.superstore_dwh.sales_fact
[0m12:51:25.128507 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d, now test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7)
[0m12:51:25.139095 [debug] [Thread-2 (]: Began compiling node test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m12:51:25.125606 [debug] [Thread-3 (]: Began running node test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m12:51:25.143689 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721, now test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d)
[0m12:51:25.144164 [debug] [Thread-3 (]: Began compiling node test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m12:51:25.132480 [debug] [Thread-1 (]: Writing injected SQL for node "test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2"
[0m12:51:25.138457 [debug] [Thread-4 (]: Writing injected SQL for node "model.superstore_dwh.sales_fact"
[0m12:51:25.151246 [debug] [Thread-4 (]: Began executing node model.superstore_dwh.sales_fact
[0m12:51:25.152133 [debug] [Thread-4 (]: Finished running node model.superstore_dwh.sales_fact
[0m12:51:25.143027 [debug] [Thread-2 (]: Writing injected SQL for node "test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7"
[0m12:51:25.155725 [debug] [Thread-2 (]: Began executing node test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m12:51:25.150510 [debug] [Thread-1 (]: Began executing node test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m12:51:25.160345 [debug] [Thread-1 (]: Finished running node test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m12:51:25.160912 [debug] [Thread-1 (]: Began running node test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m12:51:25.161375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2, now test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c)
[0m12:51:25.149564 [debug] [Thread-3 (]: Writing injected SQL for node "test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d"
[0m12:51:25.156821 [debug] [Thread-2 (]: Finished running node test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m12:51:25.164275 [debug] [Thread-2 (]: Began running node test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m12:51:25.164823 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7, now test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279)
[0m12:51:25.165247 [debug] [Thread-2 (]: Began compiling node test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m12:51:25.154788 [debug] [Thread-4 (]: Began running node test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688
[0m12:51:25.171969 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.sales_fact, now test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688)
[0m12:51:25.172604 [debug] [Thread-4 (]: Began compiling node test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688
[0m12:51:25.163685 [debug] [Thread-3 (]: Began executing node test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m12:51:25.162925 [debug] [Thread-1 (]: Began compiling node test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m12:51:25.180129 [debug] [Thread-3 (]: Finished running node test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m12:51:25.194879 [debug] [Thread-4 (]: Writing injected SQL for node "test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688"
[0m12:51:25.184158 [debug] [Thread-1 (]: Writing injected SQL for node "test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c"
[0m12:51:25.195867 [debug] [Thread-1 (]: Began executing node test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m12:51:25.196846 [debug] [Thread-1 (]: Finished running node test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m12:51:25.198425 [debug] [Thread-2 (]: Writing injected SQL for node "test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"
[0m12:51:25.199951 [debug] [Thread-4 (]: Began executing node test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688
[0m12:51:25.200758 [debug] [Thread-2 (]: Began executing node test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m12:51:25.204434 [debug] [Thread-2 (]: Finished running node test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m12:51:25.203438 [debug] [Thread-4 (]: Finished running node test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688
[0m12:51:25.207904 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:51:25.208365 [debug] [MainThread]: Connection 'test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279' was properly closed.
[0m12:51:25.208763 [debug] [MainThread]: Connection 'test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c' was properly closed.
[0m12:51:25.209145 [debug] [MainThread]: Connection 'test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688' was properly closed.
[0m12:51:25.209483 [debug] [MainThread]: Connection 'test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d' was properly closed.
[0m12:51:25.225976 [debug] [MainThread]: Command end result
[0m12:51:25.362256 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/manifest.json
[0m12:51:25.364070 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/semantic_manifest.json
[0m12:51:25.371665 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dev/Downloads/pde_magistr/superstore_dwh/target/run_results.json
[0m12:51:25.373432 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m12:51:25.373898 [info ] [MainThread]: Building catalog
[0m12:51:25.388592 [debug] [ThreadPool]: Acquiring new postgres connection 'superstore.information_schema'
[0m12:51:25.409186 [debug] [ThreadPool]: Using postgres connection "superstore.information_schema"
[0m12:51:25.410375 [debug] [ThreadPool]: On superstore.information_schema: BEGIN
[0m12:51:25.411119 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:51:25.422153 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m12:51:25.422764 [debug] [ThreadPool]: Using postgres connection "superstore.information_schema"
[0m12:51:25.423236 [debug] [ThreadPool]: On superstore.information_schema: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "superstore.information_schema"} */

    
    

    select
        'superstore' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('stg') and
           upper(tbl.relname) = upper('orders')) or (upper(sch.nspname) = upper('dw_test') and
           upper(tbl.relname) = upper('geo_dim')) or (upper(sch.nspname) = upper('dw_test') and
           upper(tbl.relname) = upper('sales_fact')) or (upper(sch.nspname) = upper('dw_test') and
           upper(tbl.relname) = upper('calendar_dim')) or (upper(sch.nspname) = upper('dw_test') and
           upper(tbl.relname) = upper('product_dim')) or (upper(sch.nspname) = upper('dw_test') and
           upper(tbl.relname) = upper('shipping_dim')) or (upper(sch.nspname) = upper('stg') and
           upper(tbl.relname) = upper('stg_orders')) or (upper(sch.nspname) = upper('dw_test') and
           upper(tbl.relname) = upper('customer_dim')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m12:51:25.444967 [debug] [ThreadPool]: SQL status: SELECT 76 in 0.021 seconds
[0m12:51:25.451366 [debug] [ThreadPool]: On superstore.information_schema: ROLLBACK
[0m12:51:25.452313 [debug] [ThreadPool]: On superstore.information_schema: Close
[0m12:51:25.468418 [debug] [MainThread]: Wrote artifact CatalogArtifact to /home/dev/Downloads/pde_magistr/superstore_dwh/target/catalog.json
[0m12:51:25.489282 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/manifest.json
[0m12:51:25.491012 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/semantic_manifest.json
[0m12:51:25.491435 [info ] [MainThread]: Catalog written to /home/dev/Downloads/pde_magistr/superstore_dwh/target/catalog.json
[0m12:51:25.492851 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 1.2517753, "process_in_blocks": "0", "process_kernel_time": 0.166924, "process_mem_max_rss": "118036", "process_out_blocks": "5504", "process_user_time": 1.996182}
[0m12:51:25.493434 [debug] [MainThread]: Command `dbt docs generate` succeeded at 12:51:25.493332 after 1.25 seconds
[0m12:51:25.493875 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m12:51:25.494225 [debug] [MainThread]: Connection 'superstore.information_schema' was properly closed.
[0m12:51:25.494642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75af999d57b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75af9920d8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75af97bf6b30>]}
[0m12:51:25.495110 [debug] [MainThread]: Flushing usage events
[0m12:51:26.214104 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:51:53.287296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7116ee0b97e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7116ed070d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7116ed070d00>]}


============================== 12:51:53.289808 | 98cff362-6b89-4a48-a3b9-9f031270849c ==============================
[0m12:51:53.289808 [info ] [MainThread]: Running with dbt=1.10.11
[0m12:51:53.290428 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'printer_width': '80', 'invocation_command': 'dbt docs serve', 'introspect': 'True', 'use_colors': 'True', 'fail_fast': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'quiet': 'False', 'static_parser': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'version_check': 'True', 'warn_error': 'None', 'profiles_dir': '/home/dev/.dbt', 'no_print': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': '/home/dev/Downloads/pde_magistr/superstore_dwh/logs', 'empty': 'None'}
[0m12:51:53.451376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98cff362-6b89-4a48-a3b9-9f031270849c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7116ed01b1c0>]}
[0m12:51:53.515527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98cff362-6b89-4a48-a3b9-9f031270849c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7116ed073dc0>]}
[0m13:40:00.528492 [error] [MainThread]: Encountered an error:

[0m13:40:00.565890 [error] [MainThread]: Traceback (most recent call last):
  File "/home/dev/Downloads/pde_magistr/dbt-env/lib/python3.10/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/dev/Downloads/pde_magistr/dbt-env/lib/python3.10/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "/home/dev/Downloads/pde_magistr/dbt-env/lib/python3.10/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
  File "/home/dev/Downloads/pde_magistr/dbt-env/lib/python3.10/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
  File "/home/dev/Downloads/pde_magistr/dbt-env/lib/python3.10/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
  File "/home/dev/Downloads/pde_magistr/dbt-env/lib/python3.10/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
  File "/home/dev/Downloads/pde_magistr/dbt-env/lib/python3.10/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/lib/python3.10/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/usr/lib/python3.10/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m13:40:00.568691 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 2887.339, "process_in_blocks": "96", "process_kernel_time": 0.24042, "process_mem_max_rss": "102596", "process_out_blocks": "3368", "process_user_time": 1.830724}
[0m13:40:00.569336 [debug] [MainThread]: Command `dbt docs serve` failed at 13:40:00.569230 after 2887.34 seconds
[0m13:40:00.569852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7116ee0b97e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7116ec100640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7116ec1003a0>]}
[0m13:40:00.570290 [debug] [MainThread]: Flushing usage events
[0m13:40:01.279249 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:13:42.460764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7794b00b9900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7794af074220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7794af0741c0>]}


============================== 10:13:42.464893 | 34465739-b2ae-4e2f-921f-9a3534e41ddd ==============================
[0m10:13:42.464893 [info ] [MainThread]: Running with dbt=1.10.11
[0m10:13:42.465902 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'debug': 'False', 'log_path': '/home/dev/Downloads/pde_magistr/superstore_dwh/logs', 'cache_selected_only': 'False', 'no_print': 'None', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'invocation_command': 'dbt run', 'warn_error': 'None', 'target_path': 'None', 'printer_width': '80', 'use_colors': 'True', 'introspect': 'True', 'partial_parse': 'True', 'log_format': 'default', 'write_json': 'True', 'profiles_dir': '/home/dev/.dbt', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False'}
[0m10:13:42.703157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34465739-b2ae-4e2f-921f-9a3534e41ddd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7794af01d030>]}
[0m10:13:42.770551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34465739-b2ae-4e2f-921f-9a3534e41ddd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7794af077df0>]}
[0m10:13:42.771868 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m10:13:42.886476 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m10:13:43.068102 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m10:13:43.068784 [debug] [MainThread]: Partial parsing: added file: superstore_dwh://models/marts/mart_order_processing_time.sql
[0m10:13:43.069395 [debug] [MainThread]: Partial parsing: updated file: superstore_dwh://models/marts/schema.yml
[0m10:13:43.607021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34465739-b2ae-4e2f-921f-9a3534e41ddd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7794acd923e0>]}
[0m10:13:43.709360 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/manifest.json
[0m10:13:43.716568 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/semantic_manifest.json
[0m10:13:43.747295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34465739-b2ae-4e2f-921f-9a3534e41ddd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7794acd90d00>]}
[0m10:13:43.747928 [info ] [MainThread]: Found 8 models, 12 data tests, 1 source, 435 macros
[0m10:13:43.748664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34465739-b2ae-4e2f-921f-9a3534e41ddd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7794acd90700>]}
[0m10:13:43.750684 [info ] [MainThread]: 
[0m10:13:43.751358 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:13:43.751945 [info ] [MainThread]: 
[0m10:13:43.752948 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:13:43.758311 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore'
[0m10:13:43.762169 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore'
[0m10:13:43.828397 [debug] [ThreadPool]: Using postgres connection "list_superstore"
[0m10:13:43.828971 [debug] [ThreadPool]: On list_superstore: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore"} */

    select distinct nspname from pg_namespace
  
[0m10:13:43.829425 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:13:43.830100 [debug] [ThreadPool]: Using postgres connection "list_superstore"
[0m10:13:43.830818 [debug] [ThreadPool]: On list_superstore: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore"} */

    select distinct nspname from pg_namespace
  
[0m10:13:43.831430 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:13:43.849510 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.018 seconds
[0m10:13:43.850898 [debug] [ThreadPool]: On list_superstore: Close
[0m10:13:43.853223 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.024 seconds
[0m10:13:43.854499 [debug] [ThreadPool]: On list_superstore: Close
[0m10:13:43.856355 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_superstore, now list_superstore_dw_test)
[0m10:13:43.863192 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_superstore, now list_superstore_stg)
[0m10:13:43.863785 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_test"
[0m10:13:43.866330 [debug] [ThreadPool]: On list_superstore_dw_test: BEGIN
[0m10:13:43.867288 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:13:43.865873 [debug] [ThreadPool]: Using postgres connection "list_superstore_stg"
[0m10:13:43.868499 [debug] [ThreadPool]: On list_superstore_stg: BEGIN
[0m10:13:43.868874 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:13:43.879750 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m10:13:43.881213 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_test"
[0m10:13:43.880722 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m10:13:43.881706 [debug] [ThreadPool]: On list_superstore_dw_test: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore_dw_test"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_test'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_test'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_test'
  
[0m10:13:43.882220 [debug] [ThreadPool]: Using postgres connection "list_superstore_stg"
[0m10:13:43.883145 [debug] [ThreadPool]: On list_superstore_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore_stg"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'stg'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'stg'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'stg'
  
[0m10:13:43.885873 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m10:13:43.887200 [debug] [ThreadPool]: On list_superstore_stg: ROLLBACK
[0m10:13:43.887716 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.005 seconds
[0m10:13:43.889044 [debug] [ThreadPool]: On list_superstore_dw_test: ROLLBACK
[0m10:13:43.889667 [debug] [ThreadPool]: On list_superstore_dw_test: Close
[0m10:13:43.890134 [debug] [ThreadPool]: On list_superstore_stg: Close
[0m10:13:43.898539 [debug] [MainThread]: Using postgres connection "master"
[0m10:13:43.899205 [debug] [MainThread]: On master: BEGIN
[0m10:13:43.899584 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:13:43.907358 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m10:13:43.907872 [debug] [MainThread]: Using postgres connection "master"
[0m10:13:43.908395 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m10:13:43.912627 [debug] [MainThread]: SQL status: SELECT 3 in 0.004 seconds
[0m10:13:43.914574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34465739-b2ae-4e2f-921f-9a3534e41ddd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7794b1927490>]}
[0m10:13:43.915136 [debug] [MainThread]: On master: ROLLBACK
[0m10:13:43.915842 [debug] [MainThread]: Using postgres connection "master"
[0m10:13:43.916334 [debug] [MainThread]: On master: BEGIN
[0m10:13:43.917353 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:13:43.917755 [debug] [MainThread]: On master: COMMIT
[0m10:13:43.918189 [debug] [MainThread]: Using postgres connection "master"
[0m10:13:43.918610 [debug] [MainThread]: On master: COMMIT
[0m10:13:43.919513 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:13:43.920075 [debug] [MainThread]: On master: Close
[0m10:13:43.928741 [debug] [Thread-1 (]: Began running node model.superstore_dwh.calendar_dim
[0m10:13:43.929545 [info ] [Thread-1 (]: 1 of 8 START sql table model dw_test.calendar_dim .............................. [RUN]
[0m10:13:43.930268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_superstore_dw_test, now model.superstore_dwh.calendar_dim)
[0m10:13:43.930712 [debug] [Thread-2 (]: Began running node model.superstore_dwh.stg_orders
[0m10:13:43.931817 [info ] [Thread-2 (]: 2 of 8 START sql view model stg.stg_orders ..................................... [RUN]
[0m10:13:43.931274 [debug] [Thread-1 (]: Began compiling node model.superstore_dwh.calendar_dim
[0m10:13:43.932513 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_superstore_stg, now model.superstore_dwh.stg_orders)
[0m10:13:43.938805 [debug] [Thread-2 (]: Began compiling node model.superstore_dwh.stg_orders
[0m10:13:43.944797 [debug] [Thread-1 (]: Writing injected SQL for node "model.superstore_dwh.calendar_dim"
[0m10:13:43.946267 [debug] [Thread-1 (]: Began executing node model.superstore_dwh.calendar_dim
[0m10:13:43.958657 [debug] [Thread-2 (]: Writing injected SQL for node "model.superstore_dwh.stg_orders"
[0m10:13:43.974405 [debug] [Thread-2 (]: Began executing node model.superstore_dwh.stg_orders
[0m10:13:44.102036 [debug] [Thread-2 (]: Writing runtime sql for node "model.superstore_dwh.stg_orders"
[0m10:13:44.104668 [debug] [Thread-1 (]: Writing runtime sql for node "model.superstore_dwh.calendar_dim"
[0m10:13:44.105825 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.calendar_dim"
[0m10:13:44.107448 [debug] [Thread-1 (]: On model.superstore_dwh.calendar_dim: BEGIN
[0m10:13:44.108113 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:13:44.108795 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.stg_orders"
[0m10:13:44.109446 [debug] [Thread-2 (]: On model.superstore_dwh.stg_orders: BEGIN
[0m10:13:44.110136 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:13:44.116746 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m10:13:44.117358 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.calendar_dim"
[0m10:13:44.117884 [debug] [Thread-1 (]: On model.superstore_dwh.calendar_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.calendar_dim"} */

  
    

  create  table "superstore"."dw_test"."calendar_dim__dbt_tmp"
  
  
    as
  
  (
    -- Создает таблицу-календарь
SELECT
    to_char(date,'yyyymmdd')::int as dateid,
    extract('year' from date)::int as year,
    extract('quarter' from date)::int as quarter,
    extract('month' from date)::int as month,
    extract('week' from date)::int as week,
    date::date,
    to_char(date, 'dy') as week_day,
    -- Проверка на високосный год
    CASE
        WHEN extract('day' from (date + interval '2 month - 1 day')) = 29 THEN 'leap'
        ELSE 'not leap'
    END as leap
FROM generate_series(
    date '2010-01-01',
    date '2030-12-31',
    interval '1 day'
) AS t(date)
  );
  
[0m10:13:44.119202 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m10:13:44.119666 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.stg_orders"
[0m10:13:44.120209 [debug] [Thread-2 (]: On model.superstore_dwh.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.stg_orders"} */

  create view "superstore"."stg"."stg_orders__dbt_tmp"
    
    
  as (
    -- models/staging/stg_orders.sql
-- Эта модель читает данные из исходной таблицы stg.orders,
-- приводит их к нужным типам и исправляет ошибку с почтовым кодом.
-- Все последующие модели будут ссылаться на эту, а не на исходную таблицу.

SELECT
    -- Приводим все к нижнему регистру для консистентности в dbt
    "order_id",
    ("order_date")::date as order_date,
    ("ship_date")::date as ship_date,
    "ship_mode",
    "customer_id",
    "customer_name",
    "segment",
    "country",
    "city",
    "state",
    -- Исправляем проблему с Burlington прямо здесь, один раз и навсегда
    CASE
        WHEN "city" = 'Burlington' AND "postal_code" IS NULL THEN '05401'
        ELSE "postal_code"
    END as postal_code,
    "region",
    "product_id",
    "category",
    "subcategory" as sub_category, -- переименовываем для соответствия
    "product_name",
    "sales",
    "quantity",
    "discount",
    "profit"
FROM "superstore"."stg"."orders"
  );
[0m10:13:44.129112 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m10:13:44.135659 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.stg_orders"
[0m10:13:44.136216 [debug] [Thread-2 (]: On model.superstore_dwh.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.stg_orders"} */
alter table "superstore"."stg"."stg_orders" rename to "stg_orders__dbt_backup"
[0m10:13:44.137517 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:13:44.140457 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.stg_orders"
[0m10:13:44.141031 [debug] [Thread-2 (]: On model.superstore_dwh.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.stg_orders"} */
alter table "superstore"."stg"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m10:13:44.141905 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:13:44.155789 [debug] [Thread-1 (]: SQL status: SELECT 7670 in 0.037 seconds
[0m10:13:44.164948 [debug] [Thread-2 (]: On model.superstore_dwh.stg_orders: COMMIT
[0m10:13:44.166005 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.calendar_dim"
[0m10:13:44.166550 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.stg_orders"
[0m10:13:44.167177 [debug] [Thread-1 (]: On model.superstore_dwh.calendar_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.calendar_dim"} */
alter table "superstore"."dw_test"."calendar_dim" rename to "calendar_dim__dbt_backup"
[0m10:13:44.167774 [debug] [Thread-2 (]: On model.superstore_dwh.stg_orders: COMMIT
[0m10:13:44.168770 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:13:44.171892 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.calendar_dim"
[0m10:13:44.172483 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m10:13:44.172941 [debug] [Thread-1 (]: On model.superstore_dwh.calendar_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.calendar_dim"} */
alter table "superstore"."dw_test"."calendar_dim__dbt_tmp" rename to "calendar_dim"
[0m10:13:44.180571 [debug] [Thread-2 (]: Applying DROP to: "superstore"."stg"."stg_orders__dbt_backup"
[0m10:13:44.185838 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.stg_orders"
[0m10:13:44.186468 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m10:13:44.187159 [debug] [Thread-2 (]: On model.superstore_dwh.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.stg_orders"} */
drop view if exists "superstore"."stg"."stg_orders__dbt_backup" cascade
[0m10:13:44.188587 [debug] [Thread-1 (]: On model.superstore_dwh.calendar_dim: COMMIT
[0m10:13:44.189257 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.calendar_dim"
[0m10:13:44.189855 [debug] [Thread-1 (]: On model.superstore_dwh.calendar_dim: COMMIT
[0m10:13:44.192235 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:13:44.196779 [debug] [Thread-1 (]: Applying DROP to: "superstore"."dw_test"."calendar_dim__dbt_backup"
[0m10:13:44.197365 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.008 seconds
[0m10:13:44.199841 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.calendar_dim"
[0m10:13:44.202522 [debug] [Thread-2 (]: On model.superstore_dwh.stg_orders: Close
[0m10:13:44.203098 [debug] [Thread-1 (]: On model.superstore_dwh.calendar_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.calendar_dim"} */
drop table if exists "superstore"."dw_test"."calendar_dim__dbt_backup" cascade
[0m10:13:44.205438 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34465739-b2ae-4e2f-921f-9a3534e41ddd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7794b186cc70>]}
[0m10:13:44.206280 [info ] [Thread-2 (]: 2 of 8 OK created sql view model stg.stg_orders ................................ [[32mCREATE VIEW[0m in 0.27s]
[0m10:13:44.206948 [debug] [Thread-2 (]: Finished running node model.superstore_dwh.stg_orders
[0m10:13:44.208196 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m10:13:44.209755 [debug] [Thread-1 (]: On model.superstore_dwh.calendar_dim: Close
[0m10:13:44.211063 [debug] [Thread-3 (]: Began running node model.superstore_dwh.geo_dim
[0m10:13:44.210482 [debug] [Thread-4 (]: Began running node model.superstore_dwh.customer_dim
[0m10:13:44.211585 [debug] [Thread-2 (]: Began running node model.superstore_dwh.product_dim
[0m10:13:44.213518 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34465739-b2ae-4e2f-921f-9a3534e41ddd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7794a6ff7040>]}
[0m10:13:44.212314 [info ] [Thread-3 (]: 4 of 8 START sql table model dw_test.geo_dim ................................... [RUN]
[0m10:13:44.221247 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.superstore_dwh.geo_dim'
[0m10:13:44.221737 [debug] [Thread-3 (]: Began compiling node model.superstore_dwh.geo_dim
[0m10:13:44.214219 [info ] [Thread-4 (]: 3 of 8 START sql table model dw_test.customer_dim .............................. [RUN]
[0m10:13:44.228583 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.superstore_dwh.customer_dim'
[0m10:13:44.216621 [info ] [Thread-2 (]: 5 of 8 START sql table model dw_test.product_dim ............................... [RUN]
[0m10:13:44.230470 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.stg_orders, now model.superstore_dwh.product_dim)
[0m10:13:44.230968 [debug] [Thread-2 (]: Began compiling node model.superstore_dwh.product_dim
[0m10:13:44.229547 [debug] [Thread-4 (]: Began compiling node model.superstore_dwh.customer_dim
[0m10:13:44.227422 [debug] [Thread-3 (]: Writing injected SQL for node "model.superstore_dwh.geo_dim"
[0m10:13:44.238108 [debug] [Thread-3 (]: Began executing node model.superstore_dwh.geo_dim
[0m10:13:44.220512 [info ] [Thread-1 (]: 1 of 8 OK created sql table model dw_test.calendar_dim ......................... [[32mSELECT 7670[0m in 0.28s]
[0m10:13:44.237354 [debug] [Thread-4 (]: Writing injected SQL for node "model.superstore_dwh.customer_dim"
[0m10:13:44.234134 [debug] [Thread-2 (]: Writing injected SQL for node "model.superstore_dwh.product_dim"
[0m10:13:44.244082 [debug] [Thread-2 (]: Began executing node model.superstore_dwh.product_dim
[0m10:13:44.243054 [debug] [Thread-1 (]: Finished running node model.superstore_dwh.calendar_dim
[0m10:13:44.242282 [debug] [Thread-3 (]: Writing runtime sql for node "model.superstore_dwh.geo_dim"
[0m10:13:44.248191 [debug] [Thread-2 (]: Writing runtime sql for node "model.superstore_dwh.product_dim"
[0m10:13:44.248964 [debug] [Thread-1 (]: Began running node model.superstore_dwh.shipping_dim
[0m10:13:44.249755 [debug] [Thread-4 (]: Began executing node model.superstore_dwh.customer_dim
[0m10:13:44.251527 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.product_dim"
[0m10:13:44.257500 [debug] [Thread-2 (]: On model.superstore_dwh.product_dim: BEGIN
[0m10:13:44.257928 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:13:44.256086 [debug] [Thread-4 (]: Writing runtime sql for node "model.superstore_dwh.customer_dim"
[0m10:13:44.250732 [info ] [Thread-1 (]: 6 of 8 START sql table model dw_test.shipping_dim .............................. [RUN]
[0m10:13:44.256934 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.geo_dim"
[0m10:13:44.263574 [debug] [Thread-3 (]: On model.superstore_dwh.geo_dim: BEGIN
[0m10:13:44.264109 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:13:44.260714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.calendar_dim, now model.superstore_dwh.shipping_dim)
[0m10:13:44.259139 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.customer_dim"
[0m10:13:44.265610 [debug] [Thread-4 (]: On model.superstore_dwh.customer_dim: BEGIN
[0m10:13:44.266106 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:13:44.265116 [debug] [Thread-1 (]: Began compiling node model.superstore_dwh.shipping_dim
[0m10:13:44.282143 [debug] [Thread-1 (]: Writing injected SQL for node "model.superstore_dwh.shipping_dim"
[0m10:13:44.283172 [debug] [Thread-2 (]: SQL status: BEGIN in 0.025 seconds
[0m10:13:44.283719 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.product_dim"
[0m10:13:44.284201 [debug] [Thread-2 (]: On model.superstore_dwh.product_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.product_dim"} */

  
    

  create  table "superstore"."dw_test"."product_dim__dbt_tmp"
  
  
    as
  
  (
    -- Создает справочник продуктов
SELECT
    100 + row_number() OVER (ORDER BY "product_id") as prod_id,
    "product_id",
    "product_name",
    "category",
    "sub_category",
    "segment"
FROM (
    SELECT DISTINCT "product_id", "product_name", "category", "sub_category", "segment" FROM "superstore"."stg"."stg_orders"
) as unique_products
  );
  
[0m10:13:44.284768 [debug] [Thread-4 (]: SQL status: BEGIN in 0.019 seconds
[0m10:13:44.287777 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.customer_dim"
[0m10:13:44.288508 [debug] [Thread-4 (]: On model.superstore_dwh.customer_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.customer_dim"} */

  
    

  create  table "superstore"."dw_test"."customer_dim__dbt_tmp"
  
  
    as
  
  (
    -- Создает справочник клиентов
SELECT
    100 + row_number() OVER (ORDER BY "customer_id") as cust_id,
    "customer_id",
    "customer_name"
FROM (
    SELECT DISTINCT "customer_id", "customer_name" FROM "superstore"."stg"."stg_orders"
) as unique_customers
  );
  
[0m10:13:44.285938 [debug] [Thread-1 (]: Began executing node model.superstore_dwh.shipping_dim
[0m10:13:44.289817 [debug] [Thread-3 (]: SQL status: BEGIN in 0.026 seconds
[0m10:13:44.309651 [debug] [Thread-1 (]: Writing runtime sql for node "model.superstore_dwh.shipping_dim"
[0m10:13:44.314106 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.shipping_dim"
[0m10:13:44.314551 [debug] [Thread-1 (]: On model.superstore_dwh.shipping_dim: BEGIN
[0m10:13:44.312904 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.geo_dim"
[0m10:13:44.315126 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:13:44.318512 [debug] [Thread-3 (]: On model.superstore_dwh.geo_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.geo_dim"} */

  
    

  create  table "superstore"."dw_test"."geo_dim__dbt_tmp"
  
  
    as
  
  (
    -- Создает географический справочник
SELECT
    100 + row_number() OVER (ORDER BY "postal_code", "city", "state") as geo_id,
    "country",
    "city",
    "state",
    "postal_code"
FROM (
    SELECT DISTINCT "country", "city", "state", "postal_code" FROM "superstore"."stg"."stg_orders"
) as unique_geo
  );
  
[0m10:13:44.325864 [debug] [Thread-4 (]: SQL status: SELECT 1093 in 0.036 seconds
[0m10:13:44.337475 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.customer_dim"
[0m10:13:44.338134 [debug] [Thread-4 (]: On model.superstore_dwh.customer_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.customer_dim"} */
alter table "superstore"."dw_test"."customer_dim" rename to "customer_dim__dbt_backup"
[0m10:13:44.340052 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:13:44.355134 [debug] [Thread-2 (]: SQL status: SELECT 4644 in 0.070 seconds
[0m10:13:44.356027 [debug] [Thread-3 (]: SQL status: SELECT 932 in 0.036 seconds
[0m10:13:44.359348 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.customer_dim"
[0m10:13:44.371088 [debug] [Thread-4 (]: On model.superstore_dwh.customer_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.customer_dim"} */
alter table "superstore"."dw_test"."customer_dim__dbt_tmp" rename to "customer_dim"
[0m10:13:44.357075 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m10:13:44.371769 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.shipping_dim"
[0m10:13:44.363520 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.product_dim"
[0m10:13:44.375317 [debug] [Thread-1 (]: On model.superstore_dwh.shipping_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.shipping_dim"} */

  
    

  create  table "superstore"."dw_test"."shipping_dim__dbt_tmp"
  
  
    as
  
  (
    -- Создает справочник видов доставки
SELECT
    100 + row_number() OVER (ORDER BY "ship_mode") as ship_id,
    "ship_mode"
FROM (
    SELECT DISTINCT "ship_mode" FROM "superstore"."stg"."stg_orders"
) as unique_shipping_modes
  );
  
[0m10:13:44.370443 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.geo_dim"
[0m10:13:44.377167 [debug] [Thread-3 (]: On model.superstore_dwh.geo_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.geo_dim"} */
alter table "superstore"."dw_test"."geo_dim" rename to "geo_dim__dbt_backup"
[0m10:13:44.377956 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:13:44.376498 [debug] [Thread-2 (]: On model.superstore_dwh.product_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.product_dim"} */
alter table "superstore"."dw_test"."product_dim" rename to "product_dim__dbt_backup"
[0m10:13:44.375995 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:13:44.386708 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.010 seconds
[0m10:13:44.388949 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.geo_dim"
[0m10:13:44.407502 [debug] [Thread-3 (]: On model.superstore_dwh.geo_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.geo_dim"} */
alter table "superstore"."dw_test"."geo_dim__dbt_tmp" rename to "geo_dim"
[0m10:13:44.397391 [debug] [Thread-4 (]: On model.superstore_dwh.customer_dim: COMMIT
[0m10:13:44.409106 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.customer_dim"
[0m10:13:44.391831 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m10:13:44.406902 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.shipping_dim"
[0m10:13:44.409651 [debug] [Thread-4 (]: On model.superstore_dwh.customer_dim: COMMIT
[0m10:13:44.415837 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m10:13:44.416794 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.product_dim"
[0m10:13:44.417829 [debug] [Thread-1 (]: On model.superstore_dwh.shipping_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.shipping_dim"} */
alter table "superstore"."dw_test"."shipping_dim" rename to "shipping_dim__dbt_backup"
[0m10:13:44.426167 [debug] [Thread-4 (]: SQL status: COMMIT in 0.007 seconds
[0m10:13:44.422037 [debug] [Thread-3 (]: On model.superstore_dwh.geo_dim: COMMIT
[0m10:13:44.434137 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.geo_dim"
[0m10:13:44.432785 [debug] [Thread-4 (]: Applying DROP to: "superstore"."dw_test"."customer_dim__dbt_backup"
[0m10:13:44.435604 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.customer_dim"
[0m10:13:44.436117 [debug] [Thread-4 (]: On model.superstore_dwh.customer_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.customer_dim"} */
drop table if exists "superstore"."dw_test"."customer_dim__dbt_backup" cascade
[0m10:13:44.424606 [debug] [Thread-2 (]: On model.superstore_dwh.product_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.product_dim"} */
alter table "superstore"."dw_test"."product_dim__dbt_tmp" rename to "product_dim"
[0m10:13:44.433462 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m10:13:44.434583 [debug] [Thread-3 (]: On model.superstore_dwh.geo_dim: COMMIT
[0m10:13:44.442919 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.shipping_dim"
[0m10:13:44.443568 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m10:13:44.447495 [debug] [Thread-1 (]: On model.superstore_dwh.shipping_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.shipping_dim"} */
alter table "superstore"."dw_test"."shipping_dim__dbt_tmp" rename to "shipping_dim"
[0m10:13:44.444187 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.008 seconds
[0m10:13:44.449805 [debug] [Thread-2 (]: On model.superstore_dwh.product_dim: COMMIT
[0m10:13:44.456312 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.product_dim"
[0m10:13:44.451279 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m10:13:44.452290 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:13:44.463638 [debug] [Thread-1 (]: On model.superstore_dwh.shipping_dim: COMMIT
[0m10:13:44.464206 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.shipping_dim"
[0m10:13:44.464630 [debug] [Thread-1 (]: On model.superstore_dwh.shipping_dim: COMMIT
[0m10:13:44.456818 [debug] [Thread-2 (]: On model.superstore_dwh.product_dim: COMMIT
[0m10:13:44.454320 [debug] [Thread-4 (]: On model.superstore_dwh.customer_dim: Close
[0m10:13:44.465928 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34465739-b2ae-4e2f-921f-9a3534e41ddd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7794a4631240>]}
[0m10:13:44.461796 [debug] [Thread-3 (]: Applying DROP to: "superstore"."dw_test"."geo_dim__dbt_backup"
[0m10:13:44.467637 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.geo_dim"
[0m10:13:44.470156 [debug] [Thread-3 (]: On model.superstore_dwh.geo_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.geo_dim"} */
drop table if exists "superstore"."dw_test"."geo_dim__dbt_backup" cascade
[0m10:13:44.466727 [info ] [Thread-4 (]: 3 of 8 OK created sql table model dw_test.customer_dim ......................... [[32mSELECT 1093[0m in 0.24s]
[0m10:13:44.472121 [debug] [Thread-4 (]: Finished running node model.superstore_dwh.customer_dim
[0m10:13:44.469237 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m10:13:44.477099 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m10:13:44.478781 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.008 seconds
[0m10:13:44.484965 [debug] [Thread-2 (]: Applying DROP to: "superstore"."dw_test"."product_dim__dbt_backup"
[0m10:13:44.583454 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.product_dim"
[0m10:13:44.583983 [debug] [Thread-2 (]: On model.superstore_dwh.product_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.product_dim"} */
drop table if exists "superstore"."dw_test"."product_dim__dbt_backup" cascade
[0m10:13:44.581074 [debug] [Thread-1 (]: Applying DROP to: "superstore"."dw_test"."shipping_dim__dbt_backup"
[0m10:13:44.584838 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.shipping_dim"
[0m10:13:44.585395 [debug] [Thread-1 (]: On model.superstore_dwh.shipping_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.shipping_dim"} */
drop table if exists "superstore"."dw_test"."shipping_dim__dbt_backup" cascade
[0m10:13:44.582614 [debug] [Thread-3 (]: On model.superstore_dwh.geo_dim: Close
[0m10:13:44.586816 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34465739-b2ae-4e2f-921f-9a3534e41ddd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7794a46e8fd0>]}
[0m10:13:44.589176 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.005 seconds
[0m10:13:44.589582 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m10:13:44.591890 [debug] [Thread-2 (]: On model.superstore_dwh.product_dim: Close
[0m10:13:44.594105 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34465739-b2ae-4e2f-921f-9a3534e41ddd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7794a46eb4f0>]}
[0m10:13:44.590383 [info ] [Thread-3 (]: 4 of 8 OK created sql table model dw_test.geo_dim .............................. [[32mSELECT 932[0m in 0.37s]
[0m10:13:44.595171 [debug] [Thread-3 (]: Finished running node model.superstore_dwh.geo_dim
[0m10:13:44.593261 [debug] [Thread-1 (]: On model.superstore_dwh.shipping_dim: Close
[0m10:13:44.597591 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34465739-b2ae-4e2f-921f-9a3534e41ddd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7794a46eae60>]}
[0m10:13:44.598387 [info ] [Thread-1 (]: 6 of 8 OK created sql table model dw_test.shipping_dim ......................... [[32mSELECT 4[0m in 0.34s]
[0m10:13:44.599132 [info ] [Thread-2 (]: 5 of 8 OK created sql table model dw_test.product_dim .......................... [[32mSELECT 4644[0m in 0.36s]
[0m10:13:44.600649 [debug] [Thread-2 (]: Finished running node model.superstore_dwh.product_dim
[0m10:13:44.600020 [debug] [Thread-1 (]: Finished running node model.superstore_dwh.shipping_dim
[0m10:13:44.602701 [debug] [Thread-4 (]: Began running node model.superstore_dwh.sales_fact
[0m10:13:44.603343 [info ] [Thread-4 (]: 7 of 8 START sql table model dw_test.sales_fact ................................ [RUN]
[0m10:13:44.605932 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.customer_dim, now model.superstore_dwh.sales_fact)
[0m10:13:44.606514 [debug] [Thread-4 (]: Began compiling node model.superstore_dwh.sales_fact
[0m10:13:44.615676 [debug] [Thread-4 (]: Writing injected SQL for node "model.superstore_dwh.sales_fact"
[0m10:13:44.619423 [debug] [Thread-4 (]: Began executing node model.superstore_dwh.sales_fact
[0m10:13:44.623914 [debug] [Thread-4 (]: Writing runtime sql for node "model.superstore_dwh.sales_fact"
[0m10:13:44.625120 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.sales_fact"
[0m10:13:44.625674 [debug] [Thread-4 (]: On model.superstore_dwh.sales_fact: BEGIN
[0m10:13:44.626208 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:13:44.640709 [debug] [Thread-4 (]: SQL status: BEGIN in 0.014 seconds
[0m10:13:44.641369 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.sales_fact"
[0m10:13:44.641866 [debug] [Thread-4 (]: On model.superstore_dwh.sales_fact: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.sales_fact"} */

  
    

  create  table "superstore"."dw_test"."sales_fact__dbt_tmp"
  
  
    as
  
  (
    -- Создает таблицу фактов, объединяя все измерения
SELECT
    -- Суррогатные ключи из измерений
    cd.cust_id,
    pd.prod_id,
    sd.ship_id,
    gd.geo_id,
    -- Ключи для календаря
    to_char(o.order_date, 'yyyymmdd')::int AS order_date_id,
    to_char(o.ship_date, 'yyyymmdd')::int AS ship_date_id,
    -- Бизнес-ключ и метрики
    o.order_id,
    o.sales,
    o.profit,
    o.quantity,
    o.discount
FROM "superstore"."stg"."stg_orders" AS o
LEFT JOIN "superstore"."dw_test"."customer_dim" AS cd ON o.customer_id = cd.customer_id
LEFT JOIN "superstore"."dw_test"."product_dim" AS pd ON o.product_id = pd.product_id
LEFT JOIN "superstore"."dw_test"."shipping_dim" AS sd ON o.ship_mode = sd.ship_mode
LEFT JOIN "superstore"."dw_test"."geo_dim" AS gd ON o.postal_code = gd.postal_code AND o.city = gd.city AND o.state = gd.state
  );
  
[0m10:13:44.757901 [debug] [Thread-4 (]: SQL status: SELECT 25967 in 0.115 seconds
[0m10:13:44.761597 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.sales_fact"
[0m10:13:44.762307 [debug] [Thread-4 (]: On model.superstore_dwh.sales_fact: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.sales_fact"} */
alter table "superstore"."dw_test"."sales_fact" rename to "sales_fact__dbt_backup"
[0m10:13:44.764214 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:13:44.767939 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.sales_fact"
[0m10:13:44.768558 [debug] [Thread-4 (]: On model.superstore_dwh.sales_fact: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.sales_fact"} */
alter table "superstore"."dw_test"."sales_fact__dbt_tmp" rename to "sales_fact"
[0m10:13:44.769753 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:13:44.772229 [debug] [Thread-4 (]: On model.superstore_dwh.sales_fact: COMMIT
[0m10:13:44.773139 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.sales_fact"
[0m10:13:44.773651 [debug] [Thread-4 (]: On model.superstore_dwh.sales_fact: COMMIT
[0m10:13:44.782249 [debug] [Thread-4 (]: SQL status: COMMIT in 0.008 seconds
[0m10:13:44.785213 [debug] [Thread-4 (]: Applying DROP to: "superstore"."dw_test"."sales_fact__dbt_backup"
[0m10:13:44.786059 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.sales_fact"
[0m10:13:44.786596 [debug] [Thread-4 (]: On model.superstore_dwh.sales_fact: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.sales_fact"} */
drop table if exists "superstore"."dw_test"."sales_fact__dbt_backup" cascade
[0m10:13:44.790358 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m10:13:44.792110 [debug] [Thread-4 (]: On model.superstore_dwh.sales_fact: Close
[0m10:13:44.794811 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34465739-b2ae-4e2f-921f-9a3534e41ddd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7794a4632f50>]}
[0m10:13:44.796661 [info ] [Thread-4 (]: 7 of 8 OK created sql table model dw_test.sales_fact ........................... [[32mSELECT 25967[0m in 0.19s]
[0m10:13:44.797492 [debug] [Thread-4 (]: Finished running node model.superstore_dwh.sales_fact
[0m10:13:44.798378 [debug] [Thread-2 (]: Began running node model.superstore_dwh.mart_order_processing_time
[0m10:13:44.798969 [info ] [Thread-2 (]: 8 of 8 START sql table model dw_test.mart_order_processing_time ................ [RUN]
[0m10:13:44.800405 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.product_dim, now model.superstore_dwh.mart_order_processing_time)
[0m10:13:44.801539 [debug] [Thread-2 (]: Began compiling node model.superstore_dwh.mart_order_processing_time
[0m10:13:44.807969 [debug] [Thread-2 (]: Writing injected SQL for node "model.superstore_dwh.mart_order_processing_time"
[0m10:13:44.810875 [debug] [Thread-2 (]: Began executing node model.superstore_dwh.mart_order_processing_time
[0m10:13:44.818004 [debug] [Thread-2 (]: Writing runtime sql for node "model.superstore_dwh.mart_order_processing_time"
[0m10:13:44.818989 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.mart_order_processing_time"
[0m10:13:44.819602 [debug] [Thread-2 (]: On model.superstore_dwh.mart_order_processing_time: BEGIN
[0m10:13:44.820125 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:13:44.832355 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m10:13:44.833177 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.mart_order_processing_time"
[0m10:13:44.833761 [debug] [Thread-2 (]: On model.superstore_dwh.mart_order_processing_time: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.mart_order_processing_time"} */

  
    

  create  table "superstore"."dw_test"."mart_order_processing_time__dbt_tmp"
  
  
    as
  
  (
    SELECT
    p.sub_category,
    AVG(DATE_PART('day', s.ship_date - s.order_date)) AS avg_processing_days
FROM "superstore"."dw_test"."sales_fact" AS f
LEFT JOIN "superstore"."dw_test"."product_dim" AS p 
    ON f.prod_id = p.prod_id
LEFT JOIN "superstore"."stg"."stg_orders" AS s
    ON f.order_id = s.order_id
GROUP BY p.sub_category
ORDER BY avg_processing_days DESC
LIMIT 5
  );
  
[0m10:13:44.836789 [debug] [Thread-2 (]: Postgres adapter: Postgres error: function date_part(unknown, integer) does not exist
LINE 14:     AVG(DATE_PART('day', s.ship_date - s.order_date)) AS avg...
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m10:13:44.837505 [debug] [Thread-2 (]: On model.superstore_dwh.mart_order_processing_time: ROLLBACK
[0m10:13:44.838415 [debug] [Thread-2 (]: On model.superstore_dwh.mart_order_processing_time: Close
[0m10:13:44.852788 [debug] [Thread-2 (]: Database Error in model mart_order_processing_time (models/marts/mart_order_processing_time.sql)
  function date_part(unknown, integer) does not exist
  LINE 14:     AVG(DATE_PART('day', s.ship_date - s.order_date)) AS avg...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/superstore_dwh/models/marts/mart_order_processing_time.sql
[0m10:13:44.854849 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34465739-b2ae-4e2f-921f-9a3534e41ddd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7794af89b4f0>]}
[0m10:13:44.856373 [error] [Thread-2 (]: 8 of 8 ERROR creating sql table model dw_test.mart_order_processing_time ....... [[31mERROR[0m in 0.05s]
[0m10:13:44.858069 [debug] [Thread-2 (]: Finished running node model.superstore_dwh.mart_order_processing_time
[0m10:13:44.859579 [debug] [Thread-7 (]: Marking all children of 'model.superstore_dwh.mart_order_processing_time' to be skipped because of status 'error'.  Reason: Database Error in model mart_order_processing_time (models/marts/mart_order_processing_time.sql)
  function date_part(unknown, integer) does not exist
  LINE 14:     AVG(DATE_PART('day', s.ship_date - s.order_date)) AS avg...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/superstore_dwh/models/marts/mart_order_processing_time.sql.
[0m10:13:44.863495 [debug] [MainThread]: Using postgres connection "master"
[0m10:13:44.864763 [debug] [MainThread]: On master: BEGIN
[0m10:13:44.865730 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:13:44.877675 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m10:13:44.878305 [debug] [MainThread]: On master: COMMIT
[0m10:13:44.878725 [debug] [MainThread]: Using postgres connection "master"
[0m10:13:44.879209 [debug] [MainThread]: On master: COMMIT
[0m10:13:44.882394 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m10:13:44.883087 [debug] [MainThread]: On master: Close
[0m10:13:44.885500 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:13:44.887004 [debug] [MainThread]: Connection 'model.superstore_dwh.mart_order_processing_time' was properly closed.
[0m10:13:44.887599 [debug] [MainThread]: Connection 'model.superstore_dwh.shipping_dim' was properly closed.
[0m10:13:44.888027 [debug] [MainThread]: Connection 'model.superstore_dwh.geo_dim' was properly closed.
[0m10:13:44.888535 [debug] [MainThread]: Connection 'model.superstore_dwh.sales_fact' was properly closed.
[0m10:13:44.889154 [info ] [MainThread]: 
[0m10:13:44.889794 [info ] [MainThread]: Finished running 7 table models, 1 view model in 0 hours 0 minutes and 1.14 seconds (1.14s).
[0m10:13:44.891846 [debug] [MainThread]: Command end result
[0m10:13:44.939654 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/manifest.json
[0m10:13:44.942891 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/semantic_manifest.json
[0m10:13:44.960546 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dev/Downloads/pde_magistr/superstore_dwh/target/run_results.json
[0m10:13:44.961398 [info ] [MainThread]: 
[0m10:13:44.965647 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:13:44.966708 [info ] [MainThread]: 
[0m10:13:44.967744 [error] [MainThread]: [31mFailure in model mart_order_processing_time (models/marts/mart_order_processing_time.sql)[0m
[0m10:13:44.968663 [error] [MainThread]:   Database Error in model mart_order_processing_time (models/marts/mart_order_processing_time.sql)
  function date_part(unknown, integer) does not exist
  LINE 14:     AVG(DATE_PART('day', s.ship_date - s.order_date)) AS avg...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/superstore_dwh/models/marts/mart_order_processing_time.sql
[0m10:13:44.970189 [info ] [MainThread]: 
[0m10:13:44.971083 [info ] [MainThread]:   compiled code at target/compiled/superstore_dwh/models/marts/mart_order_processing_time.sql
[0m10:13:44.972031 [info ] [MainThread]: 
[0m10:13:44.972877 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=8
[0m10:13:44.974225 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.5786643, "process_in_blocks": "58424", "process_kernel_time": 0.305135, "process_mem_max_rss": "125328", "process_out_blocks": "3104", "process_user_time": 3.00199}
[0m10:13:44.977081 [debug] [MainThread]: Command `dbt run` failed at 10:13:44.974746 after 2.58 seconds
[0m10:13:44.977600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7794b00b9900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7794ac5d1660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7794ac5d17e0>]}
[0m10:13:44.978125 [debug] [MainThread]: Flushing usage events
[0m10:13:45.788147 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:19:00.786012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7487bdda9900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7487bcd60220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7487bcd601c0>]}


============================== 10:19:00.788849 | 902d3cf2-b8f1-4400-828b-c975afce5e0d ==============================
[0m10:19:00.788849 [info ] [MainThread]: Running with dbt=1.10.11
[0m10:19:00.789615 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'empty': 'False', 'log_format': 'default', 'printer_width': '80', 'target_path': 'None', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'write_json': 'True', 'static_parser': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'introspect': 'True', 'no_print': 'None', 'use_colors': 'True', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/home/dev/Downloads/pde_magistr/superstore_dwh/logs', 'indirect_selection': 'eager', 'quiet': 'False', 'profiles_dir': '/home/dev/.dbt', 'invocation_command': 'dbt run'}
[0m10:19:00.954255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '902d3cf2-b8f1-4400-828b-c975afce5e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7487bf824ee0>]}
[0m10:19:01.021814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '902d3cf2-b8f1-4400-828b-c975afce5e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7487bcd63e20>]}
[0m10:19:01.022826 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m10:19:01.108075 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m10:19:01.248206 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:19:01.248960 [debug] [MainThread]: Partial parsing: updated file: superstore_dwh://models/marts/mart_order_processing_time.sql
[0m10:19:01.745781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '902d3cf2-b8f1-4400-828b-c975afce5e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7487bad79510>]}
[0m10:19:01.846650 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/manifest.json
[0m10:19:01.848410 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/semantic_manifest.json
[0m10:19:01.860045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '902d3cf2-b8f1-4400-828b-c975afce5e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7487badc0340>]}
[0m10:19:01.860665 [info ] [MainThread]: Found 8 models, 12 data tests, 1 source, 435 macros
[0m10:19:01.861166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '902d3cf2-b8f1-4400-828b-c975afce5e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7487badc12d0>]}
[0m10:19:01.863071 [info ] [MainThread]: 
[0m10:19:01.863555 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:19:01.863969 [info ] [MainThread]: 
[0m10:19:01.864667 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:19:01.870834 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore'
[0m10:19:01.881582 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore'
[0m10:19:01.910341 [debug] [ThreadPool]: Using postgres connection "list_superstore"
[0m10:19:01.910914 [debug] [ThreadPool]: Using postgres connection "list_superstore"
[0m10:19:01.911539 [debug] [ThreadPool]: On list_superstore: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore"} */

    select distinct nspname from pg_namespace
  
[0m10:19:01.912871 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:19:01.912304 [debug] [ThreadPool]: On list_superstore: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore"} */

    select distinct nspname from pg_namespace
  
[0m10:19:01.914738 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:19:01.927115 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.012 seconds
[0m10:19:01.927866 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.015 seconds
[0m10:19:01.929321 [debug] [ThreadPool]: On list_superstore: Close
[0m10:19:01.930638 [debug] [ThreadPool]: On list_superstore: Close
[0m10:19:01.934383 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_superstore, now list_superstore_stg)
[0m10:19:01.941217 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_superstore, now list_superstore_dw_test)
[0m10:19:01.943307 [debug] [ThreadPool]: Using postgres connection "list_superstore_stg"
[0m10:19:01.945484 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_test"
[0m10:19:01.946039 [debug] [ThreadPool]: On list_superstore_stg: BEGIN
[0m10:19:01.946593 [debug] [ThreadPool]: On list_superstore_dw_test: BEGIN
[0m10:19:01.947139 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:19:01.947659 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:19:01.954944 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m10:19:01.955755 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_test"
[0m10:19:01.956900 [debug] [ThreadPool]: On list_superstore_dw_test: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore_dw_test"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_test'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_test'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_test'
  
[0m10:19:01.957418 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m10:19:01.957970 [debug] [ThreadPool]: Using postgres connection "list_superstore_stg"
[0m10:19:01.958444 [debug] [ThreadPool]: On list_superstore_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore_stg"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'stg'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'stg'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'stg'
  
[0m10:19:01.960207 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m10:19:01.961579 [debug] [ThreadPool]: On list_superstore_dw_test: ROLLBACK
[0m10:19:01.962226 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m10:19:01.963380 [debug] [ThreadPool]: On list_superstore_stg: ROLLBACK
[0m10:19:01.964034 [debug] [ThreadPool]: On list_superstore_dw_test: Close
[0m10:19:01.964801 [debug] [ThreadPool]: On list_superstore_stg: Close
[0m10:19:01.973061 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:01.973701 [debug] [MainThread]: On master: BEGIN
[0m10:19:01.974280 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:19:01.981458 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m10:19:01.981965 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:01.982523 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m10:19:01.985522 [debug] [MainThread]: SQL status: SELECT 3 in 0.003 seconds
[0m10:19:01.987438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '902d3cf2-b8f1-4400-828b-c975afce5e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7487b8f650f0>]}
[0m10:19:01.987990 [debug] [MainThread]: On master: ROLLBACK
[0m10:19:01.988568 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:01.988984 [debug] [MainThread]: On master: BEGIN
[0m10:19:01.989767 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:19:01.990243 [debug] [MainThread]: On master: COMMIT
[0m10:19:01.990645 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:01.991062 [debug] [MainThread]: On master: COMMIT
[0m10:19:01.991564 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:19:01.991967 [debug] [MainThread]: On master: Close
[0m10:19:01.996488 [debug] [Thread-1 (]: Began running node model.superstore_dwh.calendar_dim
[0m10:19:01.997561 [debug] [Thread-2 (]: Began running node model.superstore_dwh.stg_orders
[0m10:19:01.997139 [info ] [Thread-1 (]: 1 of 8 START sql table model dw_test.calendar_dim .............................. [RUN]
[0m10:19:01.999254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_superstore_stg, now model.superstore_dwh.calendar_dim)
[0m10:19:01.998166 [info ] [Thread-2 (]: 2 of 8 START sql view model stg.stg_orders ..................................... [RUN]
[0m10:19:02.000000 [debug] [Thread-1 (]: Began compiling node model.superstore_dwh.calendar_dim
[0m10:19:02.000558 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_superstore_dw_test, now model.superstore_dwh.stg_orders)
[0m10:19:02.007158 [debug] [Thread-2 (]: Began compiling node model.superstore_dwh.stg_orders
[0m10:19:02.010173 [debug] [Thread-1 (]: Writing injected SQL for node "model.superstore_dwh.calendar_dim"
[0m10:19:02.015883 [debug] [Thread-2 (]: Writing injected SQL for node "model.superstore_dwh.stg_orders"
[0m10:19:02.017068 [debug] [Thread-2 (]: Began executing node model.superstore_dwh.stg_orders
[0m10:19:02.023903 [debug] [Thread-1 (]: Began executing node model.superstore_dwh.calendar_dim
[0m10:19:02.120352 [debug] [Thread-2 (]: Writing runtime sql for node "model.superstore_dwh.stg_orders"
[0m10:19:02.126228 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.stg_orders"
[0m10:19:02.124430 [debug] [Thread-1 (]: Writing runtime sql for node "model.superstore_dwh.calendar_dim"
[0m10:19:02.127576 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.calendar_dim"
[0m10:19:02.128116 [debug] [Thread-1 (]: On model.superstore_dwh.calendar_dim: BEGIN
[0m10:19:02.128586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:19:02.126817 [debug] [Thread-2 (]: On model.superstore_dwh.stg_orders: BEGIN
[0m10:19:02.129243 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:19:02.142877 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m10:19:02.143884 [debug] [Thread-2 (]: SQL status: BEGIN in 0.015 seconds
[0m10:19:02.144523 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.calendar_dim"
[0m10:19:02.145101 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.stg_orders"
[0m10:19:02.145632 [debug] [Thread-1 (]: On model.superstore_dwh.calendar_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.calendar_dim"} */

  
    

  create  table "superstore"."dw_test"."calendar_dim__dbt_tmp"
  
  
    as
  
  (
    -- Создает таблицу-календарь
SELECT
    to_char(date,'yyyymmdd')::int as dateid,
    extract('year' from date)::int as year,
    extract('quarter' from date)::int as quarter,
    extract('month' from date)::int as month,
    extract('week' from date)::int as week,
    date::date,
    to_char(date, 'dy') as week_day,
    -- Проверка на високосный год
    CASE
        WHEN extract('day' from (date + interval '2 month - 1 day')) = 29 THEN 'leap'
        ELSE 'not leap'
    END as leap
FROM generate_series(
    date '2010-01-01',
    date '2030-12-31',
    interval '1 day'
) AS t(date)
  );
  
[0m10:19:02.146269 [debug] [Thread-2 (]: On model.superstore_dwh.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.stg_orders"} */

  create view "superstore"."stg"."stg_orders__dbt_tmp"
    
    
  as (
    -- models/staging/stg_orders.sql
-- Эта модель читает данные из исходной таблицы stg.orders,
-- приводит их к нужным типам и исправляет ошибку с почтовым кодом.
-- Все последующие модели будут ссылаться на эту, а не на исходную таблицу.

SELECT
    -- Приводим все к нижнему регистру для консистентности в dbt
    "order_id",
    ("order_date")::date as order_date,
    ("ship_date")::date as ship_date,
    "ship_mode",
    "customer_id",
    "customer_name",
    "segment",
    "country",
    "city",
    "state",
    -- Исправляем проблему с Burlington прямо здесь, один раз и навсегда
    CASE
        WHEN "city" = 'Burlington' AND "postal_code" IS NULL THEN '05401'
        ELSE "postal_code"
    END as postal_code,
    "region",
    "product_id",
    "category",
    "subcategory" as sub_category, -- переименовываем для соответствия
    "product_name",
    "sales",
    "quantity",
    "discount",
    "profit"
FROM "superstore"."stg"."orders"
  );
[0m10:19:02.149579 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:19:02.158433 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.stg_orders"
[0m10:19:02.159077 [debug] [Thread-2 (]: On model.superstore_dwh.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.stg_orders"} */
alter table "superstore"."stg"."stg_orders" rename to "stg_orders__dbt_backup"
[0m10:19:02.160056 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:19:02.163175 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.stg_orders"
[0m10:19:02.163721 [debug] [Thread-2 (]: On model.superstore_dwh.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.stg_orders"} */
alter table "superstore"."stg"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m10:19:02.164608 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:19:02.177453 [debug] [Thread-1 (]: SQL status: SELECT 7670 in 0.030 seconds
[0m10:19:02.188645 [debug] [Thread-2 (]: On model.superstore_dwh.stg_orders: COMMIT
[0m10:19:02.189254 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.calendar_dim"
[0m10:19:02.190407 [debug] [Thread-1 (]: On model.superstore_dwh.calendar_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.calendar_dim"} */
alter table "superstore"."dw_test"."calendar_dim" rename to "calendar_dim__dbt_backup"
[0m10:19:02.189883 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.stg_orders"
[0m10:19:02.191055 [debug] [Thread-2 (]: On model.superstore_dwh.stg_orders: COMMIT
[0m10:19:02.191623 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:19:02.196138 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.calendar_dim"
[0m10:19:02.196723 [debug] [Thread-1 (]: On model.superstore_dwh.calendar_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.calendar_dim"} */
alter table "superstore"."dw_test"."calendar_dim__dbt_tmp" rename to "calendar_dim"
[0m10:19:02.197366 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m10:19:02.203318 [debug] [Thread-2 (]: Applying DROP to: "superstore"."stg"."stg_orders__dbt_backup"
[0m10:19:02.203871 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m10:19:02.208441 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.stg_orders"
[0m10:19:02.209958 [debug] [Thread-1 (]: On model.superstore_dwh.calendar_dim: COMMIT
[0m10:19:02.210588 [debug] [Thread-2 (]: On model.superstore_dwh.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.stg_orders"} */
drop view if exists "superstore"."stg"."stg_orders__dbt_backup" cascade
[0m10:19:02.211184 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.calendar_dim"
[0m10:19:02.211896 [debug] [Thread-1 (]: On model.superstore_dwh.calendar_dim: COMMIT
[0m10:19:02.213921 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m10:19:02.214562 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:19:02.217077 [debug] [Thread-2 (]: On model.superstore_dwh.stg_orders: Close
[0m10:19:02.220904 [debug] [Thread-1 (]: Applying DROP to: "superstore"."dw_test"."calendar_dim__dbt_backup"
[0m10:19:02.224709 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '902d3cf2-b8f1-4400-828b-c975afce5e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7487bf5c8c70>]}
[0m10:19:02.227384 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.calendar_dim"
[0m10:19:02.228779 [debug] [Thread-1 (]: On model.superstore_dwh.calendar_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.calendar_dim"} */
drop table if exists "superstore"."dw_test"."calendar_dim__dbt_backup" cascade
[0m10:19:02.228290 [info ] [Thread-2 (]: 2 of 8 OK created sql view model stg.stg_orders ................................ [[32mCREATE VIEW[0m in 0.22s]
[0m10:19:02.229929 [debug] [Thread-2 (]: Finished running node model.superstore_dwh.stg_orders
[0m10:19:02.231488 [debug] [Thread-4 (]: Began running node model.superstore_dwh.customer_dim
[0m10:19:02.232067 [debug] [Thread-3 (]: Began running node model.superstore_dwh.geo_dim
[0m10:19:02.232582 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m10:19:02.233151 [debug] [Thread-2 (]: Began running node model.superstore_dwh.product_dim
[0m10:19:02.233788 [info ] [Thread-4 (]: 3 of 8 START sql table model dw_test.customer_dim .............................. [RUN]
[0m10:19:02.236814 [debug] [Thread-1 (]: On model.superstore_dwh.calendar_dim: Close
[0m10:19:02.242711 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '902d3cf2-b8f1-4400-828b-c975afce5e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7487b85b60e0>]}
[0m10:19:02.237781 [info ] [Thread-2 (]: 5 of 8 START sql table model dw_test.product_dim ............................... [RUN]
[0m10:19:02.246063 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.stg_orders, now model.superstore_dwh.product_dim)
[0m10:19:02.234990 [info ] [Thread-3 (]: 4 of 8 START sql table model dw_test.geo_dim ................................... [RUN]
[0m10:19:02.239692 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.superstore_dwh.customer_dim'
[0m10:19:02.248939 [debug] [Thread-4 (]: Began compiling node model.superstore_dwh.customer_dim
[0m10:19:02.245476 [info ] [Thread-1 (]: 1 of 8 OK created sql table model dw_test.calendar_dim ......................... [[32mSELECT 7670[0m in 0.24s]
[0m10:19:02.259800 [debug] [Thread-1 (]: Finished running node model.superstore_dwh.calendar_dim
[0m10:19:02.247324 [debug] [Thread-2 (]: Began compiling node model.superstore_dwh.product_dim
[0m10:19:02.256631 [debug] [Thread-4 (]: Writing injected SQL for node "model.superstore_dwh.customer_dim"
[0m10:19:02.248383 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.superstore_dwh.geo_dim'
[0m10:19:02.266064 [debug] [Thread-3 (]: Began compiling node model.superstore_dwh.geo_dim
[0m10:19:02.265138 [debug] [Thread-2 (]: Writing injected SQL for node "model.superstore_dwh.product_dim"
[0m10:19:02.260466 [debug] [Thread-1 (]: Began running node model.superstore_dwh.shipping_dim
[0m10:19:02.272240 [debug] [Thread-3 (]: Writing injected SQL for node "model.superstore_dwh.geo_dim"
[0m10:19:02.280785 [debug] [Thread-3 (]: Began executing node model.superstore_dwh.geo_dim
[0m10:19:02.274089 [info ] [Thread-1 (]: 6 of 8 START sql table model dw_test.shipping_dim .............................. [RUN]
[0m10:19:02.294191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.calendar_dim, now model.superstore_dwh.shipping_dim)
[0m10:19:02.273331 [debug] [Thread-2 (]: Began executing node model.superstore_dwh.product_dim
[0m10:19:02.291181 [debug] [Thread-3 (]: Writing runtime sql for node "model.superstore_dwh.geo_dim"
[0m10:19:02.278215 [debug] [Thread-4 (]: Began executing node model.superstore_dwh.customer_dim
[0m10:19:02.294715 [debug] [Thread-1 (]: Began compiling node model.superstore_dwh.shipping_dim
[0m10:19:02.303899 [debug] [Thread-2 (]: Writing runtime sql for node "model.superstore_dwh.product_dim"
[0m10:19:02.323756 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.product_dim"
[0m10:19:02.327683 [debug] [Thread-2 (]: On model.superstore_dwh.product_dim: BEGIN
[0m10:19:02.319362 [debug] [Thread-1 (]: Writing injected SQL for node "model.superstore_dwh.shipping_dim"
[0m10:19:02.313498 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.geo_dim"
[0m10:19:02.330738 [debug] [Thread-3 (]: On model.superstore_dwh.geo_dim: BEGIN
[0m10:19:02.331780 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:19:02.328225 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:19:02.320826 [debug] [Thread-4 (]: Writing runtime sql for node "model.superstore_dwh.customer_dim"
[0m10:19:02.336220 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.customer_dim"
[0m10:19:02.334908 [debug] [Thread-1 (]: Began executing node model.superstore_dwh.shipping_dim
[0m10:19:02.338226 [debug] [Thread-4 (]: On model.superstore_dwh.customer_dim: BEGIN
[0m10:19:02.345824 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:19:02.347324 [debug] [Thread-2 (]: SQL status: BEGIN in 0.019 seconds
[0m10:19:02.345227 [debug] [Thread-1 (]: Writing runtime sql for node "model.superstore_dwh.shipping_dim"
[0m10:19:02.347859 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.product_dim"
[0m10:19:02.350516 [debug] [Thread-2 (]: On model.superstore_dwh.product_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.product_dim"} */

  
    

  create  table "superstore"."dw_test"."product_dim__dbt_tmp"
  
  
    as
  
  (
    -- Создает справочник продуктов
SELECT
    100 + row_number() OVER (ORDER BY "product_id") as prod_id,
    "product_id",
    "product_name",
    "category",
    "sub_category",
    "segment"
FROM (
    SELECT DISTINCT "product_id", "product_name", "category", "sub_category", "segment" FROM "superstore"."stg"."stg_orders"
) as unique_products
  );
  
[0m10:19:02.351792 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.shipping_dim"
[0m10:19:02.352506 [debug] [Thread-1 (]: On model.superstore_dwh.shipping_dim: BEGIN
[0m10:19:02.352949 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:19:02.359791 [debug] [Thread-4 (]: SQL status: BEGIN in 0.014 seconds
[0m10:19:02.361688 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.customer_dim"
[0m10:19:02.365457 [debug] [Thread-4 (]: On model.superstore_dwh.customer_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.customer_dim"} */

  
    

  create  table "superstore"."dw_test"."customer_dim__dbt_tmp"
  
  
    as
  
  (
    -- Создает справочник клиентов
SELECT
    100 + row_number() OVER (ORDER BY "customer_id") as cust_id,
    "customer_id",
    "customer_name"
FROM (
    SELECT DISTINCT "customer_id", "customer_name" FROM "superstore"."stg"."stg_orders"
) as unique_customers
  );
  
[0m10:19:02.362310 [debug] [Thread-3 (]: SQL status: BEGIN in 0.030 seconds
[0m10:19:02.368414 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.geo_dim"
[0m10:19:02.371549 [debug] [Thread-3 (]: On model.superstore_dwh.geo_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.geo_dim"} */

  
    

  create  table "superstore"."dw_test"."geo_dim__dbt_tmp"
  
  
    as
  
  (
    -- Создает географический справочник
SELECT
    100 + row_number() OVER (ORDER BY "postal_code", "city", "state") as geo_id,
    "country",
    "city",
    "state",
    "postal_code"
FROM (
    SELECT DISTINCT "country", "city", "state", "postal_code" FROM "superstore"."stg"."stg_orders"
) as unique_geo
  );
  
[0m10:19:02.379045 [debug] [Thread-4 (]: SQL status: SELECT 1093 in 0.013 seconds
[0m10:19:02.379888 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m10:19:02.383958 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.shipping_dim"
[0m10:19:02.384496 [debug] [Thread-1 (]: On model.superstore_dwh.shipping_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.shipping_dim"} */

  
    

  create  table "superstore"."dw_test"."shipping_dim__dbt_tmp"
  
  
    as
  
  (
    -- Создает справочник видов доставки
SELECT
    100 + row_number() OVER (ORDER BY "ship_mode") as ship_id,
    "ship_mode"
FROM (
    SELECT DISTINCT "ship_mode" FROM "superstore"."stg"."stg_orders"
) as unique_shipping_modes
  );
  
[0m10:19:02.383403 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.customer_dim"
[0m10:19:02.390338 [debug] [Thread-4 (]: On model.superstore_dwh.customer_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.customer_dim"} */
alter table "superstore"."dw_test"."customer_dim" rename to "customer_dim__dbt_backup"
[0m10:19:02.394354 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:19:02.395139 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.010 seconds
[0m10:19:02.398259 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.customer_dim"
[0m10:19:02.403030 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.shipping_dim"
[0m10:19:02.403649 [debug] [Thread-2 (]: SQL status: SELECT 4644 in 0.052 seconds
[0m10:19:02.404279 [debug] [Thread-4 (]: On model.superstore_dwh.customer_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.customer_dim"} */
alter table "superstore"."dw_test"."customer_dim__dbt_tmp" rename to "customer_dim"
[0m10:19:02.404708 [debug] [Thread-3 (]: SQL status: SELECT 932 in 0.033 seconds
[0m10:19:02.405271 [debug] [Thread-1 (]: On model.superstore_dwh.shipping_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.shipping_dim"} */
alter table "superstore"."dw_test"."shipping_dim" rename to "shipping_dim__dbt_backup"
[0m10:19:02.410110 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.product_dim"
[0m10:19:02.414711 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:19:02.414237 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.geo_dim"
[0m10:19:02.415348 [debug] [Thread-2 (]: On model.superstore_dwh.product_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.product_dim"} */
alter table "superstore"."dw_test"."product_dim" rename to "product_dim__dbt_backup"
[0m10:19:02.415872 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:19:02.417210 [debug] [Thread-4 (]: On model.superstore_dwh.customer_dim: COMMIT
[0m10:19:02.417786 [debug] [Thread-3 (]: On model.superstore_dwh.geo_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.geo_dim"} */
alter table "superstore"."dw_test"."geo_dim" rename to "geo_dim__dbt_backup"
[0m10:19:02.420920 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.shipping_dim"
[0m10:19:02.421981 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:19:02.421471 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.customer_dim"
[0m10:19:02.422889 [debug] [Thread-1 (]: On model.superstore_dwh.shipping_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.shipping_dim"} */
alter table "superstore"."dw_test"."shipping_dim__dbt_tmp" rename to "shipping_dim"
[0m10:19:02.427062 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.product_dim"
[0m10:19:02.427552 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m10:19:02.428087 [debug] [Thread-4 (]: On model.superstore_dwh.customer_dim: COMMIT
[0m10:19:02.428805 [debug] [Thread-2 (]: On model.superstore_dwh.product_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.product_dim"} */
alter table "superstore"."dw_test"."product_dim__dbt_tmp" rename to "product_dim"
[0m10:19:02.432494 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.geo_dim"
[0m10:19:02.434320 [debug] [Thread-3 (]: On model.superstore_dwh.geo_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.geo_dim"} */
alter table "superstore"."dw_test"."geo_dim__dbt_tmp" rename to "geo_dim"
[0m10:19:02.433096 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:19:02.435051 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:19:02.437244 [debug] [Thread-1 (]: On model.superstore_dwh.shipping_dim: COMMIT
[0m10:19:02.437929 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m10:19:02.438436 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:19:02.440006 [debug] [Thread-2 (]: On model.superstore_dwh.product_dim: COMMIT
[0m10:19:02.440756 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.shipping_dim"
[0m10:19:02.443568 [debug] [Thread-4 (]: Applying DROP to: "superstore"."dw_test"."customer_dim__dbt_backup"
[0m10:19:02.444963 [debug] [Thread-3 (]: On model.superstore_dwh.geo_dim: COMMIT
[0m10:19:02.445572 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.product_dim"
[0m10:19:02.446138 [debug] [Thread-1 (]: On model.superstore_dwh.shipping_dim: COMMIT
[0m10:19:02.446877 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.customer_dim"
[0m10:19:02.447435 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.geo_dim"
[0m10:19:02.448081 [debug] [Thread-2 (]: On model.superstore_dwh.product_dim: COMMIT
[0m10:19:02.448690 [debug] [Thread-4 (]: On model.superstore_dwh.customer_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.customer_dim"} */
drop table if exists "superstore"."dw_test"."customer_dim__dbt_backup" cascade
[0m10:19:02.449374 [debug] [Thread-3 (]: On model.superstore_dwh.geo_dim: COMMIT
[0m10:19:02.450359 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:19:02.451657 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m10:19:02.452722 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m10:19:02.453204 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m10:19:02.456045 [debug] [Thread-1 (]: Applying DROP to: "superstore"."dw_test"."shipping_dim__dbt_backup"
[0m10:19:02.459049 [debug] [Thread-2 (]: Applying DROP to: "superstore"."dw_test"."product_dim__dbt_backup"
[0m10:19:02.462297 [debug] [Thread-3 (]: Applying DROP to: "superstore"."dw_test"."geo_dim__dbt_backup"
[0m10:19:02.463899 [debug] [Thread-4 (]: On model.superstore_dwh.customer_dim: Close
[0m10:19:02.464646 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.shipping_dim"
[0m10:19:02.465475 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.product_dim"
[0m10:19:02.468378 [debug] [Thread-2 (]: On model.superstore_dwh.product_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.product_dim"} */
drop table if exists "superstore"."dw_test"."product_dim__dbt_backup" cascade
[0m10:19:02.466250 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.geo_dim"
[0m10:19:02.467790 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '902d3cf2-b8f1-4400-828b-c975afce5e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7487b848de70>]}
[0m10:19:02.469225 [debug] [Thread-3 (]: On model.superstore_dwh.geo_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.geo_dim"} */
drop table if exists "superstore"."dw_test"."geo_dim__dbt_backup" cascade
[0m10:19:02.467079 [debug] [Thread-1 (]: On model.superstore_dwh.shipping_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.shipping_dim"} */
drop table if exists "superstore"."dw_test"."shipping_dim__dbt_backup" cascade
[0m10:19:02.470484 [info ] [Thread-4 (]: 3 of 8 OK created sql table model dw_test.customer_dim ......................... [[32mSELECT 1093[0m in 0.23s]
[0m10:19:02.472168 [debug] [Thread-4 (]: Finished running node model.superstore_dwh.customer_dim
[0m10:19:02.473839 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.004 seconds
[0m10:19:02.474909 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.004 seconds
[0m10:19:02.474474 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m10:19:02.476505 [debug] [Thread-2 (]: On model.superstore_dwh.product_dim: Close
[0m10:19:02.479934 [debug] [Thread-1 (]: On model.superstore_dwh.shipping_dim: Close
[0m10:19:02.480852 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '902d3cf2-b8f1-4400-828b-c975afce5e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7487b8ee9cc0>]}
[0m10:19:02.478475 [debug] [Thread-3 (]: On model.superstore_dwh.geo_dim: Close
[0m10:19:02.482944 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '902d3cf2-b8f1-4400-828b-c975afce5e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7487b8fa1e70>]}
[0m10:19:02.482364 [info ] [Thread-1 (]: 6 of 8 OK created sql table model dw_test.shipping_dim ......................... [[32mSELECT 4[0m in 0.19s]
[0m10:19:02.484596 [debug] [Thread-1 (]: Finished running node model.superstore_dwh.shipping_dim
[0m10:19:02.483685 [info ] [Thread-3 (]: 4 of 8 OK created sql table model dw_test.geo_dim .............................. [[32mSELECT 932[0m in 0.23s]
[0m10:19:02.485502 [debug] [Thread-3 (]: Finished running node model.superstore_dwh.geo_dim
[0m10:19:02.481578 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '902d3cf2-b8f1-4400-828b-c975afce5e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7487b85cca30>]}
[0m10:19:02.488760 [info ] [Thread-2 (]: 5 of 8 OK created sql table model dw_test.product_dim .......................... [[32mSELECT 4644[0m in 0.24s]
[0m10:19:02.490632 [debug] [Thread-2 (]: Finished running node model.superstore_dwh.product_dim
[0m10:19:02.492235 [debug] [Thread-4 (]: Began running node model.superstore_dwh.sales_fact
[0m10:19:02.492903 [info ] [Thread-4 (]: 7 of 8 START sql table model dw_test.sales_fact ................................ [RUN]
[0m10:19:02.493897 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.customer_dim, now model.superstore_dwh.sales_fact)
[0m10:19:02.494592 [debug] [Thread-4 (]: Began compiling node model.superstore_dwh.sales_fact
[0m10:19:02.590881 [debug] [Thread-4 (]: Writing injected SQL for node "model.superstore_dwh.sales_fact"
[0m10:19:02.592139 [debug] [Thread-4 (]: Began executing node model.superstore_dwh.sales_fact
[0m10:19:02.595748 [debug] [Thread-4 (]: Writing runtime sql for node "model.superstore_dwh.sales_fact"
[0m10:19:02.596748 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.sales_fact"
[0m10:19:02.597319 [debug] [Thread-4 (]: On model.superstore_dwh.sales_fact: BEGIN
[0m10:19:02.597832 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:19:02.604601 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m10:19:02.605179 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.sales_fact"
[0m10:19:02.605891 [debug] [Thread-4 (]: On model.superstore_dwh.sales_fact: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.sales_fact"} */

  
    

  create  table "superstore"."dw_test"."sales_fact__dbt_tmp"
  
  
    as
  
  (
    -- Создает таблицу фактов, объединяя все измерения
SELECT
    -- Суррогатные ключи из измерений
    cd.cust_id,
    pd.prod_id,
    sd.ship_id,
    gd.geo_id,
    -- Ключи для календаря
    to_char(o.order_date, 'yyyymmdd')::int AS order_date_id,
    to_char(o.ship_date, 'yyyymmdd')::int AS ship_date_id,
    -- Бизнес-ключ и метрики
    o.order_id,
    o.sales,
    o.profit,
    o.quantity,
    o.discount
FROM "superstore"."stg"."stg_orders" AS o
LEFT JOIN "superstore"."dw_test"."customer_dim" AS cd ON o.customer_id = cd.customer_id
LEFT JOIN "superstore"."dw_test"."product_dim" AS pd ON o.product_id = pd.product_id
LEFT JOIN "superstore"."dw_test"."shipping_dim" AS sd ON o.ship_mode = sd.ship_mode
LEFT JOIN "superstore"."dw_test"."geo_dim" AS gd ON o.postal_code = gd.postal_code AND o.city = gd.city AND o.state = gd.state
  );
  
[0m10:19:02.685457 [debug] [Thread-4 (]: SQL status: SELECT 25967 in 0.079 seconds
[0m10:19:02.689247 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.sales_fact"
[0m10:19:02.689850 [debug] [Thread-4 (]: On model.superstore_dwh.sales_fact: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.sales_fact"} */
alter table "superstore"."dw_test"."sales_fact" rename to "sales_fact__dbt_backup"
[0m10:19:02.691145 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:19:02.694619 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.sales_fact"
[0m10:19:02.695384 [debug] [Thread-4 (]: On model.superstore_dwh.sales_fact: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.sales_fact"} */
alter table "superstore"."dw_test"."sales_fact__dbt_tmp" rename to "sales_fact"
[0m10:19:02.696547 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:19:02.698258 [debug] [Thread-4 (]: On model.superstore_dwh.sales_fact: COMMIT
[0m10:19:02.698767 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.sales_fact"
[0m10:19:02.699263 [debug] [Thread-4 (]: On model.superstore_dwh.sales_fact: COMMIT
[0m10:19:02.710798 [debug] [Thread-4 (]: SQL status: COMMIT in 0.011 seconds
[0m10:19:02.713627 [debug] [Thread-4 (]: Applying DROP to: "superstore"."dw_test"."sales_fact__dbt_backup"
[0m10:19:02.714353 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.sales_fact"
[0m10:19:02.714856 [debug] [Thread-4 (]: On model.superstore_dwh.sales_fact: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.sales_fact"} */
drop table if exists "superstore"."dw_test"."sales_fact__dbt_backup" cascade
[0m10:19:02.717816 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m10:19:02.719294 [debug] [Thread-4 (]: On model.superstore_dwh.sales_fact: Close
[0m10:19:02.720126 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '902d3cf2-b8f1-4400-828b-c975afce5e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7487b859d2a0>]}
[0m10:19:02.720849 [info ] [Thread-4 (]: 7 of 8 OK created sql table model dw_test.sales_fact ........................... [[32mSELECT 25967[0m in 0.23s]
[0m10:19:02.721774 [debug] [Thread-4 (]: Finished running node model.superstore_dwh.sales_fact
[0m10:19:02.722952 [debug] [Thread-1 (]: Began running node model.superstore_dwh.mart_order_processing_time
[0m10:19:02.723637 [info ] [Thread-1 (]: 8 of 8 START sql table model dw_test.mart_order_processing_time ................ [RUN]
[0m10:19:02.724258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.shipping_dim, now model.superstore_dwh.mart_order_processing_time)
[0m10:19:02.724809 [debug] [Thread-1 (]: Began compiling node model.superstore_dwh.mart_order_processing_time
[0m10:19:02.728557 [debug] [Thread-1 (]: Writing injected SQL for node "model.superstore_dwh.mart_order_processing_time"
[0m10:19:02.729654 [debug] [Thread-1 (]: Began executing node model.superstore_dwh.mart_order_processing_time
[0m10:19:02.735803 [debug] [Thread-1 (]: Writing runtime sql for node "model.superstore_dwh.mart_order_processing_time"
[0m10:19:02.737025 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.mart_order_processing_time"
[0m10:19:02.737539 [debug] [Thread-1 (]: On model.superstore_dwh.mart_order_processing_time: BEGIN
[0m10:19:02.738069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:19:02.750455 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m10:19:02.751482 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.mart_order_processing_time"
[0m10:19:02.751988 [debug] [Thread-1 (]: On model.superstore_dwh.mart_order_processing_time: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.mart_order_processing_time"} */

  
    

  create  table "superstore"."dw_test"."mart_order_processing_time__dbt_tmp"
  
  
    as
  
  (
    SELECT
    p.sub_category,
    AVG(s.ship_date - s.order_date) AS avg_processing_days
FROM "superstore"."dw_test"."sales_fact" AS f
LEFT JOIN "superstore"."dw_test"."product_dim" AS p 
    ON f.prod_id = p.prod_id
LEFT JOIN "superstore"."stg"."stg_orders" AS s
    ON f.order_id = s.order_id
GROUP BY p.sub_category
ORDER BY avg_processing_days DESC
LIMIT 5
  );
  
[0m10:19:02.811773 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.059 seconds
[0m10:19:02.815276 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.mart_order_processing_time"
[0m10:19:02.815794 [debug] [Thread-1 (]: On model.superstore_dwh.mart_order_processing_time: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.mart_order_processing_time"} */
alter table "superstore"."dw_test"."mart_order_processing_time__dbt_tmp" rename to "mart_order_processing_time"
[0m10:19:02.816619 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:19:02.818055 [debug] [Thread-1 (]: On model.superstore_dwh.mart_order_processing_time: COMMIT
[0m10:19:02.818606 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.mart_order_processing_time"
[0m10:19:02.819217 [debug] [Thread-1 (]: On model.superstore_dwh.mart_order_processing_time: COMMIT
[0m10:19:02.820704 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:19:02.823817 [debug] [Thread-1 (]: Applying DROP to: "superstore"."dw_test"."mart_order_processing_time__dbt_backup"
[0m10:19:02.825012 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.mart_order_processing_time"
[0m10:19:02.825929 [debug] [Thread-1 (]: On model.superstore_dwh.mart_order_processing_time: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.mart_order_processing_time"} */
drop table if exists "superstore"."dw_test"."mart_order_processing_time__dbt_backup" cascade
[0m10:19:02.826929 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m10:19:02.828469 [debug] [Thread-1 (]: On model.superstore_dwh.mart_order_processing_time: Close
[0m10:19:02.831068 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '902d3cf2-b8f1-4400-828b-c975afce5e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7487b8f96620>]}
[0m10:19:02.831860 [info ] [Thread-1 (]: 8 of 8 OK created sql table model dw_test.mart_order_processing_time ........... [[32mSELECT 5[0m in 0.11s]
[0m10:19:02.832763 [debug] [Thread-1 (]: Finished running node model.superstore_dwh.mart_order_processing_time
[0m10:19:02.834322 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:02.834779 [debug] [MainThread]: On master: BEGIN
[0m10:19:02.835207 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:19:02.844908 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m10:19:02.845619 [debug] [MainThread]: On master: COMMIT
[0m10:19:02.846038 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:02.846516 [debug] [MainThread]: On master: COMMIT
[0m10:19:02.848570 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:19:02.849059 [debug] [MainThread]: On master: Close
[0m10:19:02.851199 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:19:02.851593 [debug] [MainThread]: Connection 'model.superstore_dwh.product_dim' was properly closed.
[0m10:19:02.851971 [debug] [MainThread]: Connection 'model.superstore_dwh.mart_order_processing_time' was properly closed.
[0m10:19:02.853630 [debug] [MainThread]: Connection 'model.superstore_dwh.sales_fact' was properly closed.
[0m10:19:02.854029 [debug] [MainThread]: Connection 'model.superstore_dwh.geo_dim' was properly closed.
[0m10:19:02.854574 [info ] [MainThread]: 
[0m10:19:02.856969 [info ] [MainThread]: Finished running 7 table models, 1 view model in 0 hours 0 minutes and 0.99 seconds (0.99s).
[0m10:19:02.861676 [debug] [MainThread]: Command end result
[0m10:19:02.886468 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/manifest.json
[0m10:19:02.888391 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/semantic_manifest.json
[0m10:19:02.901832 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dev/Downloads/pde_magistr/superstore_dwh/target/run_results.json
[0m10:19:02.902375 [info ] [MainThread]: 
[0m10:19:02.903236 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:19:02.903822 [info ] [MainThread]: 
[0m10:19:02.904809 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m10:19:02.907904 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.1823447, "process_in_blocks": "0", "process_kernel_time": 0.194458, "process_mem_max_rss": "125656", "process_out_blocks": "3104", "process_user_time": 2.933918}
[0m10:19:02.909182 [debug] [MainThread]: Command `dbt run` succeeded at 10:19:02.909049 after 2.18 seconds
[0m10:19:02.909676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7487bdda9900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7487bf824ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7487bdc90100>]}
[0m10:19:02.910216 [debug] [MainThread]: Flushing usage events
[0m10:19:03.785841 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:19:14.476811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b25d19ad990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b25d096c220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b25d096c1c0>]}


============================== 10:19:14.479428 | dfdc67af-adee-4010-86fb-d2f37c598363 ==============================
[0m10:19:14.479428 [info ] [MainThread]: Running with dbt=1.10.11
[0m10:19:14.480081 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/home/dev/.dbt', 'log_path': '/home/dev/Downloads/pde_magistr/superstore_dwh/logs', 'fail_fast': 'False', 'invocation_command': 'dbt test', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'partial_parse': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'log_format': 'default', 'quiet': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'version_check': 'True', 'static_parser': 'True', 'debug': 'False', 'no_print': 'None', 'warn_error': 'None', 'empty': 'None', 'printer_width': '80'}
[0m10:19:14.650528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dfdc67af-adee-4010-86fb-d2f37c598363', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b25d090ec20>]}
[0m10:19:14.717351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dfdc67af-adee-4010-86fb-d2f37c598363', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b25d0961930>]}
[0m10:19:14.718272 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m10:19:14.809804 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m10:19:14.949225 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:19:14.949745 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:19:15.006233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dfdc67af-adee-4010-86fb-d2f37c598363', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b25cf1260b0>]}
[0m10:19:15.107586 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/manifest.json
[0m10:19:15.110695 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/semantic_manifest.json
[0m10:19:15.179557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dfdc67af-adee-4010-86fb-d2f37c598363', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b25d090e7a0>]}
[0m10:19:15.180247 [info ] [MainThread]: Found 8 models, 12 data tests, 1 source, 435 macros
[0m10:19:15.180723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfdc67af-adee-4010-86fb-d2f37c598363', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b25d090fe50>]}
[0m10:19:15.182877 [info ] [MainThread]: 
[0m10:19:15.183380 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:19:15.183826 [info ] [MainThread]: 
[0m10:19:15.184452 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:19:15.189362 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore_dw_test'
[0m10:19:15.200790 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore_stg'
[0m10:19:15.239052 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_test"
[0m10:19:15.239596 [debug] [ThreadPool]: On list_superstore_dw_test: BEGIN
[0m10:19:15.240012 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:19:15.241259 [debug] [ThreadPool]: Using postgres connection "list_superstore_stg"
[0m10:19:15.241711 [debug] [ThreadPool]: On list_superstore_stg: BEGIN
[0m10:19:15.242716 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:19:15.252281 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m10:19:15.254577 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_test"
[0m10:19:15.255098 [debug] [ThreadPool]: On list_superstore_dw_test: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore_dw_test"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_test'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_test'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_test'
  
[0m10:19:15.256335 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m10:19:15.256870 [debug] [ThreadPool]: Using postgres connection "list_superstore_stg"
[0m10:19:15.257485 [debug] [ThreadPool]: On list_superstore_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore_stg"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'stg'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'stg'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'stg'
  
[0m10:19:15.259989 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m10:19:15.261503 [debug] [ThreadPool]: On list_superstore_dw_test: ROLLBACK
[0m10:19:15.262393 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m10:19:15.263311 [debug] [ThreadPool]: On list_superstore_dw_test: Close
[0m10:19:15.264642 [debug] [ThreadPool]: On list_superstore_stg: ROLLBACK
[0m10:19:15.267177 [debug] [ThreadPool]: On list_superstore_stg: Close
[0m10:19:15.272785 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:15.273384 [debug] [MainThread]: On master: BEGIN
[0m10:19:15.273798 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:19:15.282267 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m10:19:15.282877 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:15.283431 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m10:19:15.287474 [debug] [MainThread]: SQL status: SELECT 3 in 0.003 seconds
[0m10:19:15.289862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfdc67af-adee-4010-86fb-d2f37c598363', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b25d090ebf0>]}
[0m10:19:15.290543 [debug] [MainThread]: On master: ROLLBACK
[0m10:19:15.291337 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:15.291774 [debug] [MainThread]: On master: BEGIN
[0m10:19:15.292854 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:19:15.293466 [debug] [MainThread]: On master: COMMIT
[0m10:19:15.293991 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:15.294482 [debug] [MainThread]: On master: COMMIT
[0m10:19:15.295092 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:19:15.295578 [debug] [MainThread]: On master: Close
[0m10:19:15.298900 [debug] [Thread-1 (]: Began running node test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m10:19:15.299576 [debug] [Thread-2 (]: Began running node test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m10:19:15.300168 [info ] [Thread-1 (]: 1 of 12 START test not_null_customer_dim_cust_id ............................... [RUN]
[0m10:19:15.301737 [debug] [Thread-3 (]: Began running node test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029
[0m10:19:15.302365 [debug] [Thread-4 (]: Began running node test.superstore_dwh.not_null_mart_order_processing_time_number_of_orders.6990ee329d
[0m10:19:15.301150 [info ] [Thread-2 (]: 2 of 12 START test not_null_geo_dim_geo_id ..................................... [RUN]
[0m10:19:15.303225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_superstore_dw_test, now test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42)
[0m10:19:15.304888 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_superstore_stg, now test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d)
[0m10:19:15.303758 [info ] [Thread-3 (]: 3 of 12 START test not_null_mart_order_processing_time_avg_processing_days ..... [RUN]
[0m10:19:15.308746 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029'
[0m10:19:15.309297 [debug] [Thread-3 (]: Began compiling node test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029
[0m10:19:15.304324 [info ] [Thread-4 (]: 4 of 12 START test not_null_mart_order_processing_time_number_of_orders ........ [RUN]
[0m10:19:15.305746 [debug] [Thread-1 (]: Began compiling node test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m10:19:15.307968 [debug] [Thread-2 (]: Began compiling node test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m10:19:15.319167 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.superstore_dwh.not_null_mart_order_processing_time_number_of_orders.6990ee329d'
[0m10:19:15.341626 [debug] [Thread-1 (]: Writing injected SQL for node "test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42"
[0m10:19:15.342970 [debug] [Thread-3 (]: Writing injected SQL for node "test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029"
[0m10:19:15.349928 [debug] [Thread-3 (]: Began executing node test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029
[0m10:19:15.349015 [debug] [Thread-4 (]: Began compiling node test.superstore_dwh.not_null_mart_order_processing_time_number_of_orders.6990ee329d
[0m10:19:15.347522 [debug] [Thread-2 (]: Writing injected SQL for node "test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d"
[0m10:19:15.367245 [debug] [Thread-1 (]: Began executing node test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m10:19:15.370148 [debug] [Thread-3 (]: Writing runtime sql for node "test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029"
[0m10:19:15.374402 [debug] [Thread-4 (]: Writing injected SQL for node "test.superstore_dwh.not_null_mart_order_processing_time_number_of_orders.6990ee329d"
[0m10:19:15.379328 [debug] [Thread-4 (]: Began executing node test.superstore_dwh.not_null_mart_order_processing_time_number_of_orders.6990ee329d
[0m10:19:15.378636 [debug] [Thread-3 (]: Using postgres connection "test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029"
[0m10:19:15.383574 [debug] [Thread-3 (]: On test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029: BEGIN
[0m10:19:15.377107 [debug] [Thread-1 (]: Writing runtime sql for node "test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42"
[0m10:19:15.383013 [debug] [Thread-4 (]: Writing runtime sql for node "test.superstore_dwh.not_null_mart_order_processing_time_number_of_orders.6990ee329d"
[0m10:19:15.377946 [debug] [Thread-2 (]: Began executing node test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m10:19:15.384124 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:19:15.384937 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42"
[0m10:19:15.387814 [debug] [Thread-2 (]: Writing runtime sql for node "test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d"
[0m10:19:15.390364 [debug] [Thread-2 (]: Using postgres connection "test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d"
[0m10:19:15.389375 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42: BEGIN
[0m10:19:15.388634 [debug] [Thread-4 (]: Using postgres connection "test.superstore_dwh.not_null_mart_order_processing_time_number_of_orders.6990ee329d"
[0m10:19:15.390851 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d: BEGIN
[0m10:19:15.391589 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:19:15.394555 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:19:15.392346 [debug] [Thread-4 (]: On test.superstore_dwh.not_null_mart_order_processing_time_number_of_orders.6990ee329d: BEGIN
[0m10:19:15.396080 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:19:15.400170 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m10:19:15.400740 [debug] [Thread-3 (]: Using postgres connection "test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029"
[0m10:19:15.401229 [debug] [Thread-3 (]: On test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_processing_days
from "superstore"."dw_test"."mart_order_processing_time"
where avg_processing_days is null



  
  
      
    ) dbt_internal_test
[0m10:19:15.406195 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m10:19:15.415242 [debug] [Thread-3 (]: On test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029: ROLLBACK
[0m10:19:15.416734 [debug] [Thread-4 (]: SQL status: BEGIN in 0.021 seconds
[0m10:19:15.416097 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m10:19:15.417566 [debug] [Thread-2 (]: SQL status: BEGIN in 0.023 seconds
[0m10:19:15.418478 [debug] [Thread-3 (]: On test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029: Close
[0m10:19:15.419069 [debug] [Thread-4 (]: Using postgres connection "test.superstore_dwh.not_null_mart_order_processing_time_number_of_orders.6990ee329d"
[0m10:19:15.420930 [debug] [Thread-4 (]: On test.superstore_dwh.not_null_mart_order_processing_time_number_of_orders.6990ee329d: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.not_null_mart_order_processing_time_number_of_orders.6990ee329d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select number_of_orders
from "superstore"."dw_test"."mart_order_processing_time"
where number_of_orders is null



  
  
      
    ) dbt_internal_test
[0m10:19:15.420323 [debug] [Thread-2 (]: Using postgres connection "test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d"
[0m10:19:15.421599 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select geo_id
from "superstore"."dw_test"."geo_dim"
where geo_id is null



  
  
      
    ) dbt_internal_test
[0m10:19:15.419713 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42"
[0m10:19:15.422396 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select cust_id
from "superstore"."dw_test"."customer_dim"
where cust_id is null



  
  
      
    ) dbt_internal_test
[0m10:19:15.424771 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m10:19:15.426682 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d: ROLLBACK
[0m10:19:15.424296 [info ] [Thread-3 (]: 3 of 12 PASS not_null_mart_order_processing_time_avg_processing_days ........... [[32mPASS[0m in 0.12s]
[0m10:19:15.427375 [debug] [Thread-4 (]: Postgres adapter: Postgres error: column "number_of_orders" does not exist
LINE 16: select number_of_orders
                ^

[0m10:19:15.427957 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m10:19:15.428664 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d: Close
[0m10:19:15.429427 [debug] [Thread-3 (]: Finished running node test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029
[0m10:19:15.433279 [debug] [Thread-3 (]: Began running node test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209
[0m10:19:15.430130 [debug] [Thread-4 (]: On test.superstore_dwh.not_null_mart_order_processing_time_number_of_orders.6990ee329d: ROLLBACK
[0m10:19:15.432332 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42: ROLLBACK
[0m10:19:15.433815 [info ] [Thread-3 (]: 5 of 12 START test not_null_mart_order_processing_time_sub_category ............ [RUN]
[0m10:19:15.438135 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029, now test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209)
[0m10:19:15.438629 [debug] [Thread-3 (]: Began compiling node test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209
[0m10:19:15.436275 [info ] [Thread-2 (]: 2 of 12 PASS not_null_geo_dim_geo_id ........................................... [[32mPASS[0m in 0.13s]
[0m10:19:15.437356 [debug] [Thread-4 (]: On test.superstore_dwh.not_null_mart_order_processing_time_number_of_orders.6990ee329d: Close
[0m10:19:15.448084 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42: Close
[0m10:19:15.448821 [debug] [Thread-2 (]: Finished running node test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m10:19:15.455282 [debug] [Thread-2 (]: Began running node test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688
[0m10:19:15.454009 [info ] [Thread-1 (]: 1 of 12 PASS not_null_customer_dim_cust_id ..................................... [[32mPASS[0m in 0.15s]
[0m10:19:15.457983 [debug] [Thread-1 (]: Finished running node test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m10:19:15.450594 [debug] [Thread-3 (]: Writing injected SQL for node "test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209"
[0m10:19:15.461729 [debug] [Thread-3 (]: Began executing node test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209
[0m10:19:15.460871 [debug] [Thread-1 (]: Began running node test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m10:19:15.455800 [info ] [Thread-2 (]: 6 of 12 START test not_null_product_dim_prod_id ................................ [RUN]
[0m10:19:15.472268 [debug] [Thread-4 (]: Database Error in test not_null_mart_order_processing_time_number_of_orders (models/marts/schema.yml)
  column "number_of_orders" does not exist
  LINE 16: select number_of_orders
                  ^
  compiled code at target/run/superstore_dwh/models/marts/schema.yml/not_null_mart_order_processing_time_number_of_orders.sql
[0m10:19:15.474153 [debug] [Thread-3 (]: Writing runtime sql for node "test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209"
[0m10:19:15.474652 [info ] [Thread-1 (]: 7 of 12 START test not_null_shipping_dim_ship_id ............................... [RUN]
[0m10:19:15.475353 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d, now test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688)
[0m10:19:15.479510 [debug] [Thread-2 (]: Began compiling node test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688
[0m10:19:15.476487 [error] [Thread-4 (]: 4 of 12 ERROR not_null_mart_order_processing_time_number_of_orders ............. [[31mERROR[0m in 0.16s]
[0m10:19:15.477880 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42, now test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d)
[0m10:19:15.492677 [debug] [Thread-1 (]: Began compiling node test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m10:19:15.488457 [debug] [Thread-3 (]: Using postgres connection "test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209"
[0m10:19:15.508227 [debug] [Thread-3 (]: On test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209: BEGIN
[0m10:19:15.487779 [debug] [Thread-4 (]: Finished running node test.superstore_dwh.not_null_mart_order_processing_time_number_of_orders.6990ee329d
[0m10:19:15.510097 [debug] [Thread-4 (]: Began running node test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m10:19:15.490792 [debug] [Thread-2 (]: Writing injected SQL for node "test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688"
[0m10:19:15.508739 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:19:15.504820 [debug] [Thread-1 (]: Writing injected SQL for node "test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d"
[0m10:19:15.514202 [debug] [Thread-2 (]: Began executing node test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688
[0m10:19:15.510609 [info ] [Thread-4 (]: 8 of 12 START test relationships_sales_fact_cust_id__cust_id__ref_customer_dim_  [RUN]
[0m10:19:15.511555 [debug] [Thread-7 (]: Marking all children of 'test.superstore_dwh.not_null_mart_order_processing_time_number_of_orders.6990ee329d' to be skipped because of status 'error'.  Reason: Database Error in test not_null_mart_order_processing_time_number_of_orders (models/marts/schema.yml)
  column "number_of_orders" does not exist
  LINE 16: select number_of_orders
                  ^
  compiled code at target/run/superstore_dwh/models/marts/schema.yml/not_null_mart_order_processing_time_number_of_orders.sql.
[0m10:19:15.520476 [debug] [Thread-1 (]: Began executing node test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m10:19:15.525413 [debug] [Thread-2 (]: Writing runtime sql for node "test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688"
[0m10:19:15.526101 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_mart_order_processing_time_number_of_orders.6990ee329d, now test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279)
[0m10:19:15.533795 [debug] [Thread-4 (]: Began compiling node test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m10:19:15.532344 [debug] [Thread-1 (]: Writing runtime sql for node "test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d"
[0m10:19:15.557587 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d"
[0m10:19:15.555200 [debug] [Thread-4 (]: Writing injected SQL for node "test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"
[0m10:19:15.559131 [debug] [Thread-4 (]: Began executing node test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m10:19:15.555783 [debug] [Thread-2 (]: Using postgres connection "test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688"
[0m10:19:15.567669 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688: BEGIN
[0m10:19:15.568406 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:19:15.553600 [debug] [Thread-3 (]: SQL status: BEGIN in 0.045 seconds
[0m10:19:15.571908 [debug] [Thread-3 (]: Using postgres connection "test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209"
[0m10:19:15.572531 [debug] [Thread-3 (]: On test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sub_category
from "superstore"."dw_test"."mart_order_processing_time"
where sub_category is null



  
  
      
    ) dbt_internal_test
[0m10:19:15.558149 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d: BEGIN
[0m10:19:15.573207 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:19:15.565106 [debug] [Thread-4 (]: Writing runtime sql for node "test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"
[0m10:19:15.576243 [debug] [Thread-4 (]: Using postgres connection "test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"
[0m10:19:15.580704 [debug] [Thread-4 (]: On test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279: BEGIN
[0m10:19:15.579468 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.006 seconds
[0m10:19:15.581179 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:19:15.588978 [debug] [Thread-3 (]: On test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209: ROLLBACK
[0m10:19:15.593234 [debug] [Thread-3 (]: On test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209: Close
[0m10:19:15.595173 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m10:19:15.597642 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d"
[0m10:19:15.598924 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ship_id
from "superstore"."dw_test"."shipping_dim"
where ship_id is null



  
  
      
    ) dbt_internal_test
[0m10:19:15.603116 [info ] [Thread-3 (]: 5 of 12 PASS not_null_mart_order_processing_time_sub_category .................. [[32mPASS[0m in 0.17s]
[0m10:19:15.609868 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.008 seconds
[0m10:19:15.610567 [debug] [Thread-2 (]: SQL status: BEGIN in 0.042 seconds
[0m10:19:15.613097 [debug] [Thread-2 (]: Using postgres connection "test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688"
[0m10:19:15.613646 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select prod_id
from "superstore"."dw_test"."product_dim"
where prod_id is null



  
  
      
    ) dbt_internal_test
[0m10:19:15.604048 [debug] [Thread-3 (]: Finished running node test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209
[0m10:19:15.614585 [debug] [Thread-3 (]: Began running node test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721
[0m10:19:15.615940 [info ] [Thread-3 (]: 9 of 12 START test unique_customer_dim_cust_id ................................. [RUN]
[0m10:19:15.616606 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209, now test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721)
[0m10:19:15.619237 [debug] [Thread-3 (]: Began compiling node test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721
[0m10:19:15.612523 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d: ROLLBACK
[0m10:19:15.626533 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.012 seconds
[0m10:19:15.630080 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688: ROLLBACK
[0m10:19:15.628304 [debug] [Thread-3 (]: Writing injected SQL for node "test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721"
[0m10:19:15.633768 [debug] [Thread-4 (]: SQL status: BEGIN in 0.053 seconds
[0m10:19:15.637401 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688: Close
[0m10:19:15.638144 [debug] [Thread-4 (]: Using postgres connection "test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"
[0m10:19:15.641886 [debug] [Thread-4 (]: On test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select cust_id as from_field
    from "superstore"."dw_test"."sales_fact"
    where cust_id is not null
),

parent as (
    select cust_id as to_field
    from "superstore"."dw_test"."customer_dim"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m10:19:15.632739 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d: Close
[0m10:19:15.638772 [debug] [Thread-3 (]: Began executing node test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721
[0m10:19:15.655214 [debug] [Thread-3 (]: Writing runtime sql for node "test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721"
[0m10:19:15.644294 [info ] [Thread-1 (]: 7 of 12 PASS not_null_shipping_dim_ship_id ..................................... [[32mPASS[0m in 0.17s]
[0m10:19:15.641327 [info ] [Thread-2 (]: 6 of 12 PASS not_null_product_dim_prod_id ...................................... [[32mPASS[0m in 0.17s]
[0m10:19:15.664400 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.022 seconds
[0m10:19:15.666223 [debug] [Thread-1 (]: Finished running node test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m10:19:15.666911 [debug] [Thread-2 (]: Finished running node test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688
[0m10:19:15.678971 [debug] [Thread-2 (]: Began running node test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m10:19:15.673947 [debug] [Thread-4 (]: On test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279: ROLLBACK
[0m10:19:15.687143 [debug] [Thread-4 (]: On test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279: Close
[0m10:19:15.676779 [debug] [Thread-1 (]: Began running node test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m10:19:15.688509 [info ] [Thread-4 (]: 8 of 12 PASS relationships_sales_fact_cust_id__cust_id__ref_customer_dim_ ...... [[32mPASS[0m in 0.16s]
[0m10:19:15.671968 [debug] [Thread-3 (]: Using postgres connection "test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721"
[0m10:19:15.696871 [debug] [Thread-3 (]: On test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721: BEGIN
[0m10:19:15.697420 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:19:15.682248 [info ] [Thread-2 (]: 11 of 12 START test unique_product_dim_prod_id ................................. [RUN]
[0m10:19:15.698528 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688, now test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c)
[0m10:19:15.704182 [debug] [Thread-2 (]: Began compiling node test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m10:19:15.696267 [debug] [Thread-4 (]: Finished running node test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m10:19:15.713606 [debug] [Thread-4 (]: Began running node test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m10:19:15.695367 [info ] [Thread-1 (]: 10 of 12 START test unique_geo_dim_geo_id ...................................... [RUN]
[0m10:19:15.714262 [info ] [Thread-4 (]: 12 of 12 START test unique_shipping_dim_ship_id ................................ [RUN]
[0m10:19:15.717699 [debug] [Thread-2 (]: Writing injected SQL for node "test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c"
[0m10:19:15.723619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d, now test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2)
[0m10:19:15.727001 [debug] [Thread-3 (]: SQL status: BEGIN in 0.030 seconds
[0m10:19:15.730185 [debug] [Thread-3 (]: Using postgres connection "test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721"
[0m10:19:15.728900 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279, now test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7)
[0m10:19:15.733339 [debug] [Thread-4 (]: Began compiling node test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m10:19:15.732135 [debug] [Thread-3 (]: On test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    cust_id as unique_field,
    count(*) as n_records

from "superstore"."dw_test"."customer_dim"
where cust_id is not null
group by cust_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m10:19:15.729580 [debug] [Thread-1 (]: Began compiling node test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m10:19:15.740790 [debug] [Thread-2 (]: Began executing node test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m10:19:15.787810 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.046 seconds
[0m10:19:15.789037 [debug] [Thread-4 (]: Writing injected SQL for node "test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7"
[0m10:19:15.792413 [debug] [Thread-4 (]: Began executing node test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m10:19:15.789967 [debug] [Thread-2 (]: Writing runtime sql for node "test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c"
[0m10:19:15.798291 [debug] [Thread-2 (]: Using postgres connection "test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c"
[0m10:19:15.783805 [debug] [Thread-1 (]: Writing injected SQL for node "test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2"
[0m10:19:15.791577 [debug] [Thread-3 (]: On test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721: ROLLBACK
[0m10:19:15.799469 [debug] [Thread-2 (]: On test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c: BEGIN
[0m10:19:15.797053 [debug] [Thread-4 (]: Writing runtime sql for node "test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7"
[0m10:19:15.800318 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:19:15.801286 [debug] [Thread-3 (]: On test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721: Close
[0m10:19:15.803568 [debug] [Thread-4 (]: Using postgres connection "test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7"
[0m10:19:15.802289 [debug] [Thread-1 (]: Began executing node test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m10:19:15.813481 [debug] [Thread-4 (]: On test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7: BEGIN
[0m10:19:15.818730 [debug] [Thread-1 (]: Writing runtime sql for node "test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2"
[0m10:19:15.828060 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2"
[0m10:19:15.828601 [debug] [Thread-1 (]: On test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2: BEGIN
[0m10:19:15.807846 [info ] [Thread-3 (]: 9 of 12 PASS unique_customer_dim_cust_id ....................................... [[32mPASS[0m in 0.19s]
[0m10:19:15.833231 [debug] [Thread-3 (]: Finished running node test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721
[0m10:19:15.819701 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:19:15.832300 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:19:15.836796 [debug] [Thread-2 (]: SQL status: BEGIN in 0.036 seconds
[0m10:19:15.843142 [debug] [Thread-2 (]: Using postgres connection "test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c"
[0m10:19:15.843757 [debug] [Thread-2 (]: On test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    prod_id as unique_field,
    count(*) as n_records

from "superstore"."dw_test"."product_dim"
where prod_id is not null
group by prod_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m10:19:15.854419 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.010 seconds
[0m10:19:15.859289 [debug] [Thread-2 (]: On test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c: ROLLBACK
[0m10:19:15.861293 [debug] [Thread-2 (]: On test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c: Close
[0m10:19:15.863785 [debug] [Thread-4 (]: SQL status: BEGIN in 0.044 seconds
[0m10:19:15.862396 [debug] [Thread-1 (]: SQL status: BEGIN in 0.033 seconds
[0m10:19:15.869551 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2"
[0m10:19:15.865086 [info ] [Thread-2 (]: 11 of 12 PASS unique_product_dim_prod_id ....................................... [[32mPASS[0m in 0.17s]
[0m10:19:15.866845 [debug] [Thread-4 (]: Using postgres connection "test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7"
[0m10:19:15.877341 [debug] [Thread-4 (]: On test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    ship_id as unique_field,
    count(*) as n_records

from "superstore"."dw_test"."shipping_dim"
where ship_id is not null
group by ship_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m10:19:15.875806 [debug] [Thread-2 (]: Finished running node test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m10:19:15.871352 [debug] [Thread-1 (]: On test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    geo_id as unique_field,
    count(*) as n_records

from "superstore"."dw_test"."geo_dim"
where geo_id is not null
group by geo_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m10:19:15.879989 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m10:19:15.884309 [debug] [Thread-1 (]: On test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2: ROLLBACK
[0m10:19:15.885630 [debug] [Thread-1 (]: On test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2: Close
[0m10:19:15.886769 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.009 seconds
[0m10:19:15.893895 [debug] [Thread-4 (]: On test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7: ROLLBACK
[0m10:19:15.892210 [info ] [Thread-1 (]: 10 of 12 PASS unique_geo_dim_geo_id ............................................ [[32mPASS[0m in 0.17s]
[0m10:19:15.895191 [debug] [Thread-1 (]: Finished running node test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m10:19:15.895701 [debug] [Thread-4 (]: On test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7: Close
[0m10:19:15.900942 [info ] [Thread-4 (]: 12 of 12 PASS unique_shipping_dim_ship_id ...................................... [[32mPASS[0m in 0.17s]
[0m10:19:15.902501 [debug] [Thread-4 (]: Finished running node test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m10:19:15.904908 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:15.906412 [debug] [MainThread]: On master: BEGIN
[0m10:19:15.907828 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:19:15.924010 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m10:19:15.924652 [debug] [MainThread]: On master: COMMIT
[0m10:19:15.925174 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:15.925568 [debug] [MainThread]: On master: COMMIT
[0m10:19:15.928321 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m10:19:15.928928 [debug] [MainThread]: On master: Close
[0m10:19:15.929741 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:19:15.930186 [debug] [MainThread]: Connection 'test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2' was properly closed.
[0m10:19:15.930670 [debug] [MainThread]: Connection 'test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c' was properly closed.
[0m10:19:15.931162 [debug] [MainThread]: Connection 'test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721' was properly closed.
[0m10:19:15.931528 [debug] [MainThread]: Connection 'test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7' was properly closed.
[0m10:19:15.932945 [info ] [MainThread]: 
[0m10:19:15.933905 [info ] [MainThread]: Finished running 12 data tests in 0 hours 0 minutes and 0.75 seconds (0.75s).
[0m10:19:15.938730 [debug] [MainThread]: Command end result
[0m10:19:15.980248 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/manifest.json
[0m10:19:15.982131 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/semantic_manifest.json
[0m10:19:15.995027 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dev/Downloads/pde_magistr/superstore_dwh/target/run_results.json
[0m10:19:15.995847 [info ] [MainThread]: 
[0m10:19:15.996645 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:19:15.997331 [info ] [MainThread]: 
[0m10:19:15.998053 [error] [MainThread]: [31mFailure in test not_null_mart_order_processing_time_number_of_orders (models/marts/schema.yml)[0m
[0m10:19:15.998732 [error] [MainThread]:   Database Error in test not_null_mart_order_processing_time_number_of_orders (models/marts/schema.yml)
  column "number_of_orders" does not exist
  LINE 16: select number_of_orders
                  ^
  compiled code at target/run/superstore_dwh/models/marts/schema.yml/not_null_mart_order_processing_time_number_of_orders.sql
[0m10:19:15.999806 [info ] [MainThread]: 
[0m10:19:16.000558 [info ] [MainThread]:   compiled code at target/compiled/superstore_dwh/models/marts/schema.yml/not_null_mart_order_processing_time_number_of_orders.sql
[0m10:19:16.001218 [info ] [MainThread]: 
[0m10:19:16.003705 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=12
[0m10:19:16.005131 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.5871395, "process_in_blocks": "624", "process_kernel_time": 0.181158, "process_mem_max_rss": "120536", "process_out_blocks": "2224", "process_user_time": 2.292347}
[0m10:19:16.005703 [debug] [MainThread]: Command `dbt test` failed at 10:19:16.005590 after 1.59 seconds
[0m10:19:16.006257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b25d19ad990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b25d2591900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b25d1897370>]}
[0m10:19:16.006756 [debug] [MainThread]: Flushing usage events
[0m10:19:16.601691 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:22:12.394030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d93402b5930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d933f270220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d933f2701c0>]}


============================== 10:22:12.396542 | 0189deb3-e593-4d0b-9e9c-351147218eff ==============================
[0m10:22:12.396542 [info ] [MainThread]: Running with dbt=1.10.11
[0m10:22:12.397123 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'use_experimental_parser': 'False', 'profiles_dir': '/home/dev/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'write_json': 'True', 'empty': 'False', 'log_path': '/home/dev/Downloads/pde_magistr/superstore_dwh/logs', 'debug': 'False', 'invocation_command': 'dbt run', 'use_colors': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'fail_fast': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'quiet': 'False', 'static_parser': 'True', 'log_format': 'default', 'warn_error': 'None', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'partial_parse': 'True'}
[0m10:22:12.560702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0189deb3-e593-4d0b-9e9c-351147218eff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d933f21bf10>]}
[0m10:22:12.626246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0189deb3-e593-4d0b-9e9c-351147218eff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d933f273e20>]}
[0m10:22:12.627242 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m10:22:12.713215 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m10:22:12.851908 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:22:12.852781 [debug] [MainThread]: Partial parsing: updated file: superstore_dwh://models/marts/schema.yml
[0m10:22:13.330614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0189deb3-e593-4d0b-9e9c-351147218eff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d933cf6cf40>]}
[0m10:22:13.429292 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/manifest.json
[0m10:22:13.431076 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/semantic_manifest.json
[0m10:22:13.441968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0189deb3-e593-4d0b-9e9c-351147218eff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d933cf6d9c0>]}
[0m10:22:13.442554 [info ] [MainThread]: Found 8 models, 11 data tests, 1 source, 435 macros
[0m10:22:13.443048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0189deb3-e593-4d0b-9e9c-351147218eff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d933db69690>]}
[0m10:22:13.444899 [info ] [MainThread]: 
[0m10:22:13.445392 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:22:13.445830 [info ] [MainThread]: 
[0m10:22:13.446531 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:22:13.452232 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore'
[0m10:22:13.468326 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore'
[0m10:22:13.498090 [debug] [ThreadPool]: Using postgres connection "list_superstore"
[0m10:22:13.498694 [debug] [ThreadPool]: Using postgres connection "list_superstore"
[0m10:22:13.499905 [debug] [ThreadPool]: On list_superstore: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore"} */

    select distinct nspname from pg_namespace
  
[0m10:22:13.500872 [debug] [ThreadPool]: On list_superstore: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore"} */

    select distinct nspname from pg_namespace
  
[0m10:22:13.501514 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:22:13.502044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:22:13.511793 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.010 seconds
[0m10:22:13.514887 [debug] [ThreadPool]: On list_superstore: Close
[0m10:22:13.517647 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.016 seconds
[0m10:22:13.518933 [debug] [ThreadPool]: On list_superstore: Close
[0m10:22:13.522225 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_superstore, now list_superstore_stg)
[0m10:22:13.522948 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_superstore, now list_superstore_dw_test)
[0m10:22:13.532597 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_test"
[0m10:22:13.533154 [debug] [ThreadPool]: On list_superstore_dw_test: BEGIN
[0m10:22:13.533668 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:22:13.534430 [debug] [ThreadPool]: Using postgres connection "list_superstore_stg"
[0m10:22:13.535295 [debug] [ThreadPool]: On list_superstore_stg: BEGIN
[0m10:22:13.535716 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:22:13.540959 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m10:22:13.541560 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_test"
[0m10:22:13.541972 [debug] [ThreadPool]: On list_superstore_dw_test: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore_dw_test"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_test'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_test'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_test'
  
[0m10:22:13.543527 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m10:22:13.544105 [debug] [ThreadPool]: Using postgres connection "list_superstore_stg"
[0m10:22:13.544541 [debug] [ThreadPool]: On list_superstore_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore_stg"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'stg'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'stg'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'stg'
  
[0m10:22:13.545231 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m10:22:13.546592 [debug] [ThreadPool]: On list_superstore_dw_test: ROLLBACK
[0m10:22:13.547293 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m10:22:13.548470 [debug] [ThreadPool]: On list_superstore_stg: ROLLBACK
[0m10:22:13.548935 [debug] [ThreadPool]: On list_superstore_dw_test: Close
[0m10:22:13.549665 [debug] [ThreadPool]: On list_superstore_stg: Close
[0m10:22:13.557327 [debug] [MainThread]: Using postgres connection "master"
[0m10:22:13.557888 [debug] [MainThread]: On master: BEGIN
[0m10:22:13.558292 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:22:13.565930 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m10:22:13.566460 [debug] [MainThread]: Using postgres connection "master"
[0m10:22:13.567037 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m10:22:13.570152 [debug] [MainThread]: SQL status: SELECT 3 in 0.003 seconds
[0m10:22:13.571979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0189deb3-e593-4d0b-9e9c-351147218eff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d933cf50610>]}
[0m10:22:13.572570 [debug] [MainThread]: On master: ROLLBACK
[0m10:22:13.573165 [debug] [MainThread]: Using postgres connection "master"
[0m10:22:13.573588 [debug] [MainThread]: On master: BEGIN
[0m10:22:13.574465 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:22:13.574904 [debug] [MainThread]: On master: COMMIT
[0m10:22:13.575391 [debug] [MainThread]: Using postgres connection "master"
[0m10:22:13.575810 [debug] [MainThread]: On master: COMMIT
[0m10:22:13.576398 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:22:13.576827 [debug] [MainThread]: On master: Close
[0m10:22:13.582253 [debug] [Thread-1 (]: Began running node model.superstore_dwh.calendar_dim
[0m10:22:13.582724 [debug] [Thread-2 (]: Began running node model.superstore_dwh.stg_orders
[0m10:22:13.583366 [info ] [Thread-1 (]: 1 of 8 START sql table model dw_test.calendar_dim .............................. [RUN]
[0m10:22:13.584639 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_superstore_stg, now model.superstore_dwh.calendar_dim)
[0m10:22:13.585148 [debug] [Thread-1 (]: Began compiling node model.superstore_dwh.calendar_dim
[0m10:22:13.583943 [info ] [Thread-2 (]: 2 of 8 START sql view model stg.stg_orders ..................................... [RUN]
[0m10:22:13.591836 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_superstore_dw_test, now model.superstore_dwh.stg_orders)
[0m10:22:13.592363 [debug] [Thread-2 (]: Began compiling node model.superstore_dwh.stg_orders
[0m10:22:13.597905 [debug] [Thread-2 (]: Writing injected SQL for node "model.superstore_dwh.stg_orders"
[0m10:22:13.601450 [debug] [Thread-2 (]: Began executing node model.superstore_dwh.stg_orders
[0m10:22:13.599425 [debug] [Thread-1 (]: Writing injected SQL for node "model.superstore_dwh.calendar_dim"
[0m10:22:13.610344 [debug] [Thread-1 (]: Began executing node model.superstore_dwh.calendar_dim
[0m10:22:13.701400 [debug] [Thread-2 (]: Writing runtime sql for node "model.superstore_dwh.stg_orders"
[0m10:22:13.704973 [debug] [Thread-1 (]: Writing runtime sql for node "model.superstore_dwh.calendar_dim"
[0m10:22:13.706730 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.stg_orders"
[0m10:22:13.707547 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.calendar_dim"
[0m10:22:13.707987 [debug] [Thread-2 (]: On model.superstore_dwh.stg_orders: BEGIN
[0m10:22:13.709361 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:22:13.708556 [debug] [Thread-1 (]: On model.superstore_dwh.calendar_dim: BEGIN
[0m10:22:13.710157 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:22:13.721506 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m10:22:13.722458 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m10:22:13.724254 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.calendar_dim"
[0m10:22:13.724962 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.stg_orders"
[0m10:22:13.726241 [debug] [Thread-2 (]: On model.superstore_dwh.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.stg_orders"} */

  create view "superstore"."stg"."stg_orders__dbt_tmp"
    
    
  as (
    -- models/staging/stg_orders.sql
-- Эта модель читает данные из исходной таблицы stg.orders,
-- приводит их к нужным типам и исправляет ошибку с почтовым кодом.
-- Все последующие модели будут ссылаться на эту, а не на исходную таблицу.

SELECT
    -- Приводим все к нижнему регистру для консистентности в dbt
    "order_id",
    ("order_date")::date as order_date,
    ("ship_date")::date as ship_date,
    "ship_mode",
    "customer_id",
    "customer_name",
    "segment",
    "country",
    "city",
    "state",
    -- Исправляем проблему с Burlington прямо здесь, один раз и навсегда
    CASE
        WHEN "city" = 'Burlington' AND "postal_code" IS NULL THEN '05401'
        ELSE "postal_code"
    END as postal_code,
    "region",
    "product_id",
    "category",
    "subcategory" as sub_category, -- переименовываем для соответствия
    "product_name",
    "sales",
    "quantity",
    "discount",
    "profit"
FROM "superstore"."stg"."orders"
  );
[0m10:22:13.725518 [debug] [Thread-1 (]: On model.superstore_dwh.calendar_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.calendar_dim"} */

  
    

  create  table "superstore"."dw_test"."calendar_dim__dbt_tmp"
  
  
    as
  
  (
    -- Создает таблицу-календарь
SELECT
    to_char(date,'yyyymmdd')::int as dateid,
    extract('year' from date)::int as year,
    extract('quarter' from date)::int as quarter,
    extract('month' from date)::int as month,
    extract('week' from date)::int as week,
    date::date,
    to_char(date, 'dy') as week_day,
    -- Проверка на високосный год
    CASE
        WHEN extract('day' from (date + interval '2 month - 1 day')) = 29 THEN 'leap'
        ELSE 'not leap'
    END as leap
FROM generate_series(
    date '2010-01-01',
    date '2030-12-31',
    interval '1 day'
) AS t(date)
  );
  
[0m10:22:13.734676 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m10:22:13.750352 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.stg_orders"
[0m10:22:13.751103 [debug] [Thread-2 (]: On model.superstore_dwh.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.stg_orders"} */
alter table "superstore"."stg"."stg_orders" rename to "stg_orders__dbt_backup"
[0m10:22:13.753290 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:22:13.761681 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.stg_orders"
[0m10:22:13.762336 [debug] [Thread-2 (]: On model.superstore_dwh.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.stg_orders"} */
alter table "superstore"."stg"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m10:22:13.764645 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:22:13.765232 [debug] [Thread-1 (]: SQL status: SELECT 7670 in 0.037 seconds
[0m10:22:13.788509 [debug] [Thread-2 (]: On model.superstore_dwh.stg_orders: COMMIT
[0m10:22:13.789183 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.calendar_dim"
[0m10:22:13.789706 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.stg_orders"
[0m10:22:13.790227 [debug] [Thread-1 (]: On model.superstore_dwh.calendar_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.calendar_dim"} */
alter table "superstore"."dw_test"."calendar_dim" rename to "calendar_dim__dbt_backup"
[0m10:22:13.790704 [debug] [Thread-2 (]: On model.superstore_dwh.stg_orders: COMMIT
[0m10:22:13.791752 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:22:13.794914 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.calendar_dim"
[0m10:22:13.795437 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m10:22:13.796114 [debug] [Thread-1 (]: On model.superstore_dwh.calendar_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.calendar_dim"} */
alter table "superstore"."dw_test"."calendar_dim__dbt_tmp" rename to "calendar_dim"
[0m10:22:13.802341 [debug] [Thread-2 (]: Applying DROP to: "superstore"."stg"."stg_orders__dbt_backup"
[0m10:22:13.807050 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.stg_orders"
[0m10:22:13.807722 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m10:22:13.808273 [debug] [Thread-2 (]: On model.superstore_dwh.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.stg_orders"} */
drop view if exists "superstore"."stg"."stg_orders__dbt_backup" cascade
[0m10:22:13.809766 [debug] [Thread-1 (]: On model.superstore_dwh.calendar_dim: COMMIT
[0m10:22:13.810471 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.calendar_dim"
[0m10:22:13.810934 [debug] [Thread-1 (]: On model.superstore_dwh.calendar_dim: COMMIT
[0m10:22:13.812383 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m10:22:13.815008 [debug] [Thread-2 (]: On model.superstore_dwh.stg_orders: Close
[0m10:22:13.815535 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m10:22:13.817442 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0189deb3-e593-4d0b-9e9c-351147218eff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9341b28ca0>]}
[0m10:22:13.820313 [debug] [Thread-1 (]: Applying DROP to: "superstore"."dw_test"."calendar_dim__dbt_backup"
[0m10:22:13.823508 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.calendar_dim"
[0m10:22:13.821096 [info ] [Thread-2 (]: 2 of 8 OK created sql view model stg.stg_orders ................................ [[32mCREATE VIEW[0m in 0.22s]
[0m10:22:13.824359 [debug] [Thread-1 (]: On model.superstore_dwh.calendar_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.calendar_dim"} */
drop table if exists "superstore"."dw_test"."calendar_dim__dbt_backup" cascade
[0m10:22:13.825101 [debug] [Thread-2 (]: Finished running node model.superstore_dwh.stg_orders
[0m10:22:13.826564 [debug] [Thread-4 (]: Began running node model.superstore_dwh.customer_dim
[0m10:22:13.827796 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m10:22:13.828418 [debug] [Thread-3 (]: Began running node model.superstore_dwh.geo_dim
[0m10:22:13.830842 [debug] [Thread-2 (]: Began running node model.superstore_dwh.product_dim
[0m10:22:13.834335 [info ] [Thread-2 (]: 5 of 8 START sql table model dw_test.product_dim ............................... [RUN]
[0m10:22:13.830313 [info ] [Thread-4 (]: 3 of 8 START sql table model dw_test.customer_dim .............................. [RUN]
[0m10:22:13.833358 [info ] [Thread-3 (]: 4 of 8 START sql table model dw_test.geo_dim ................................... [RUN]
[0m10:22:13.835175 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.stg_orders, now model.superstore_dwh.product_dim)
[0m10:22:13.839114 [debug] [Thread-2 (]: Began compiling node model.superstore_dwh.product_dim
[0m10:22:13.832486 [debug] [Thread-1 (]: On model.superstore_dwh.calendar_dim: Close
[0m10:22:13.846547 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0189deb3-e593-4d0b-9e9c-351147218eff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d933c213fa0>]}
[0m10:22:13.836834 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.superstore_dwh.geo_dim'
[0m10:22:13.847860 [debug] [Thread-3 (]: Began compiling node model.superstore_dwh.geo_dim
[0m10:22:13.835910 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.superstore_dwh.customer_dim'
[0m10:22:13.851719 [debug] [Thread-3 (]: Writing injected SQL for node "model.superstore_dwh.geo_dim"
[0m10:22:13.856913 [debug] [Thread-2 (]: Writing injected SQL for node "model.superstore_dwh.product_dim"
[0m10:22:13.859207 [info ] [Thread-1 (]: 1 of 8 OK created sql table model dw_test.calendar_dim ......................... [[32mSELECT 7670[0m in 0.26s]
[0m10:22:13.861519 [debug] [Thread-3 (]: Began executing node model.superstore_dwh.geo_dim
[0m10:22:13.860425 [debug] [Thread-4 (]: Began compiling node model.superstore_dwh.customer_dim
[0m10:22:13.862949 [debug] [Thread-2 (]: Began executing node model.superstore_dwh.product_dim
[0m10:22:13.873478 [debug] [Thread-4 (]: Writing injected SQL for node "model.superstore_dwh.customer_dim"
[0m10:22:13.867074 [debug] [Thread-3 (]: Writing runtime sql for node "model.superstore_dwh.geo_dim"
[0m10:22:13.862252 [debug] [Thread-1 (]: Finished running node model.superstore_dwh.calendar_dim
[0m10:22:13.879664 [debug] [Thread-1 (]: Began running node model.superstore_dwh.shipping_dim
[0m10:22:13.877676 [debug] [Thread-2 (]: Writing runtime sql for node "model.superstore_dwh.product_dim"
[0m10:22:13.882619 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.product_dim"
[0m10:22:13.878822 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.geo_dim"
[0m10:22:13.885809 [debug] [Thread-3 (]: On model.superstore_dwh.geo_dim: BEGIN
[0m10:22:13.880543 [debug] [Thread-4 (]: Began executing node model.superstore_dwh.customer_dim
[0m10:22:13.883730 [debug] [Thread-2 (]: On model.superstore_dwh.product_dim: BEGIN
[0m10:22:13.881568 [info ] [Thread-1 (]: 6 of 8 START sql table model dw_test.shipping_dim .............................. [RUN]
[0m10:22:13.895955 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.calendar_dim, now model.superstore_dwh.shipping_dim)
[0m10:22:13.896547 [debug] [Thread-1 (]: Began compiling node model.superstore_dwh.shipping_dim
[0m10:22:13.895043 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:22:13.886457 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:22:13.903872 [debug] [Thread-4 (]: Writing runtime sql for node "model.superstore_dwh.customer_dim"
[0m10:22:13.906295 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.customer_dim"
[0m10:22:13.911289 [debug] [Thread-4 (]: On model.superstore_dwh.customer_dim: BEGIN
[0m10:22:13.911779 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:22:13.910612 [debug] [Thread-1 (]: Writing injected SQL for node "model.superstore_dwh.shipping_dim"
[0m10:22:13.913562 [debug] [Thread-1 (]: Began executing node model.superstore_dwh.shipping_dim
[0m10:22:13.923398 [debug] [Thread-1 (]: Writing runtime sql for node "model.superstore_dwh.shipping_dim"
[0m10:22:13.924652 [debug] [Thread-2 (]: SQL status: BEGIN in 0.030 seconds
[0m10:22:13.925577 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.product_dim"
[0m10:22:13.926763 [debug] [Thread-3 (]: SQL status: BEGIN in 0.040 seconds
[0m10:22:13.926343 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.shipping_dim"
[0m10:22:13.928459 [debug] [Thread-1 (]: On model.superstore_dwh.shipping_dim: BEGIN
[0m10:22:13.927942 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.geo_dim"
[0m10:22:13.927361 [debug] [Thread-2 (]: On model.superstore_dwh.product_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.product_dim"} */

  
    

  create  table "superstore"."dw_test"."product_dim__dbt_tmp"
  
  
    as
  
  (
    -- Создает справочник продуктов
SELECT
    100 + row_number() OVER (ORDER BY "product_id") as prod_id,
    "product_id",
    "product_name",
    "category",
    "sub_category",
    "segment"
FROM (
    SELECT DISTINCT "product_id", "product_name", "category", "sub_category", "segment" FROM "superstore"."stg"."stg_orders"
) as unique_products
  );
  
[0m10:22:13.928872 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:22:13.929423 [debug] [Thread-3 (]: On model.superstore_dwh.geo_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.geo_dim"} */

  
    

  create  table "superstore"."dw_test"."geo_dim__dbt_tmp"
  
  
    as
  
  (
    -- Создает географический справочник
SELECT
    100 + row_number() OVER (ORDER BY "postal_code", "city", "state") as geo_id,
    "country",
    "city",
    "state",
    "postal_code"
FROM (
    SELECT DISTINCT "country", "city", "state", "postal_code" FROM "superstore"."stg"."stg_orders"
) as unique_geo
  );
  
[0m10:22:13.942385 [debug] [Thread-4 (]: SQL status: BEGIN in 0.031 seconds
[0m10:22:13.943866 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.customer_dim"
[0m10:22:13.944390 [debug] [Thread-4 (]: On model.superstore_dwh.customer_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.customer_dim"} */

  
    

  create  table "superstore"."dw_test"."customer_dim__dbt_tmp"
  
  
    as
  
  (
    -- Создает справочник клиентов
SELECT
    100 + row_number() OVER (ORDER BY "customer_id") as cust_id,
    "customer_id",
    "customer_name"
FROM (
    SELECT DISTINCT "customer_id", "customer_name" FROM "superstore"."stg"."stg_orders"
) as unique_customers
  );
  
[0m10:22:13.966220 [debug] [Thread-4 (]: SQL status: SELECT 1093 in 0.021 seconds
[0m10:22:13.972354 [debug] [Thread-3 (]: SQL status: SELECT 932 in 0.034 seconds
[0m10:22:13.978486 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.geo_dim"
[0m10:22:13.979418 [debug] [Thread-1 (]: SQL status: BEGIN in 0.051 seconds
[0m10:22:13.979925 [debug] [Thread-3 (]: On model.superstore_dwh.geo_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.geo_dim"} */
alter table "superstore"."dw_test"."geo_dim" rename to "geo_dim__dbt_backup"
[0m10:22:13.980449 [debug] [Thread-2 (]: SQL status: SELECT 4644 in 0.048 seconds
[0m10:22:13.981654 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.customer_dim"
[0m10:22:13.987988 [debug] [Thread-4 (]: On model.superstore_dwh.customer_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.customer_dim"} */
alter table "superstore"."dw_test"."customer_dim" rename to "customer_dim__dbt_backup"
[0m10:22:13.982204 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.shipping_dim"
[0m10:22:13.989001 [debug] [Thread-1 (]: On model.superstore_dwh.shipping_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.shipping_dim"} */

  
    

  create  table "superstore"."dw_test"."shipping_dim__dbt_tmp"
  
  
    as
  
  (
    -- Создает справочник видов доставки
SELECT
    100 + row_number() OVER (ORDER BY "ship_mode") as ship_id,
    "ship_mode"
FROM (
    SELECT DISTINCT "ship_mode" FROM "superstore"."stg"."stg_orders"
) as unique_shipping_modes
  );
  
[0m10:22:13.986103 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.product_dim"
[0m10:22:13.986611 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:22:13.991809 [debug] [Thread-2 (]: On model.superstore_dwh.product_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.product_dim"} */
alter table "superstore"."dw_test"."product_dim" rename to "product_dim__dbt_backup"
[0m10:22:13.998102 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.geo_dim"
[0m10:22:13.998860 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:22:13.999806 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.010 seconds
[0m10:22:14.000424 [debug] [Thread-3 (]: On model.superstore_dwh.geo_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.geo_dim"} */
alter table "superstore"."dw_test"."geo_dim__dbt_tmp" rename to "geo_dim"
[0m10:22:14.003669 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.customer_dim"
[0m10:22:14.008402 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m10:22:14.007753 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.shipping_dim"
[0m10:22:14.009368 [debug] [Thread-4 (]: On model.superstore_dwh.customer_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.customer_dim"} */
alter table "superstore"."dw_test"."customer_dim__dbt_tmp" rename to "customer_dim"
[0m10:22:14.009965 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:22:14.013716 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.product_dim"
[0m10:22:14.014453 [debug] [Thread-1 (]: On model.superstore_dwh.shipping_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.shipping_dim"} */
alter table "superstore"."dw_test"."shipping_dim" rename to "shipping_dim__dbt_backup"
[0m10:22:14.017290 [debug] [Thread-3 (]: On model.superstore_dwh.geo_dim: COMMIT
[0m10:22:14.018556 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:22:14.021870 [debug] [Thread-4 (]: On model.superstore_dwh.customer_dim: COMMIT
[0m10:22:14.018028 [debug] [Thread-2 (]: On model.superstore_dwh.product_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.product_dim"} */
alter table "superstore"."dw_test"."product_dim__dbt_tmp" rename to "product_dim"
[0m10:22:14.020415 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:22:14.019879 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.geo_dim"
[0m10:22:14.028183 [debug] [Thread-3 (]: On model.superstore_dwh.geo_dim: COMMIT
[0m10:22:14.022829 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.customer_dim"
[0m10:22:14.027516 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:22:14.026980 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.shipping_dim"
[0m10:22:14.032181 [debug] [Thread-1 (]: On model.superstore_dwh.shipping_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.shipping_dim"} */
alter table "superstore"."dw_test"."shipping_dim__dbt_tmp" rename to "shipping_dim"
[0m10:22:14.031513 [debug] [Thread-2 (]: On model.superstore_dwh.product_dim: COMMIT
[0m10:22:14.028779 [debug] [Thread-4 (]: On model.superstore_dwh.customer_dim: COMMIT
[0m10:22:14.036234 [debug] [Thread-3 (]: SQL status: COMMIT in 0.008 seconds
[0m10:22:14.035566 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.product_dim"
[0m10:22:14.043071 [debug] [Thread-2 (]: On model.superstore_dwh.product_dim: COMMIT
[0m10:22:14.041562 [debug] [Thread-3 (]: Applying DROP to: "superstore"."dw_test"."geo_dim__dbt_backup"
[0m10:22:14.042477 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m10:22:14.036944 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:22:14.050527 [debug] [Thread-1 (]: On model.superstore_dwh.shipping_dim: COMMIT
[0m10:22:14.048948 [debug] [Thread-4 (]: Applying DROP to: "superstore"."dw_test"."customer_dim__dbt_backup"
[0m10:22:14.044165 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.geo_dim"
[0m10:22:14.052950 [debug] [Thread-3 (]: On model.superstore_dwh.geo_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.geo_dim"} */
drop table if exists "superstore"."dw_test"."geo_dim__dbt_backup" cascade
[0m10:22:14.051635 [debug] [Thread-2 (]: SQL status: COMMIT in 0.008 seconds
[0m10:22:14.052433 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.customer_dim"
[0m10:22:14.050978 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.shipping_dim"
[0m10:22:14.057229 [debug] [Thread-2 (]: Applying DROP to: "superstore"."dw_test"."product_dim__dbt_backup"
[0m10:22:14.058235 [debug] [Thread-4 (]: On model.superstore_dwh.customer_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.customer_dim"} */
drop table if exists "superstore"."dw_test"."customer_dim__dbt_backup" cascade
[0m10:22:14.058796 [debug] [Thread-1 (]: On model.superstore_dwh.shipping_dim: COMMIT
[0m10:22:14.059336 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.006 seconds
[0m10:22:14.060167 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.product_dim"
[0m10:22:14.062092 [debug] [Thread-3 (]: On model.superstore_dwh.geo_dim: Close
[0m10:22:14.065137 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0189deb3-e593-4d0b-9e9c-351147218eff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d933c27f7c0>]}
[0m10:22:14.063774 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m10:22:14.064337 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m10:22:14.063278 [debug] [Thread-2 (]: On model.superstore_dwh.product_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.product_dim"} */
drop table if exists "superstore"."dw_test"."product_dim__dbt_backup" cascade
[0m10:22:14.067917 [debug] [Thread-4 (]: On model.superstore_dwh.customer_dim: Close
[0m10:22:14.071018 [debug] [Thread-1 (]: Applying DROP to: "superstore"."dw_test"."shipping_dim__dbt_backup"
[0m10:22:14.072851 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.shipping_dim"
[0m10:22:14.065925 [info ] [Thread-3 (]: 4 of 8 OK created sql table model dw_test.geo_dim .............................. [[32mSELECT 932[0m in 0.23s]
[0m10:22:14.074845 [debug] [Thread-1 (]: On model.superstore_dwh.shipping_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.shipping_dim"} */
drop table if exists "superstore"."dw_test"."shipping_dim__dbt_backup" cascade
[0m10:22:14.076706 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.005 seconds
[0m10:22:14.077517 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0189deb3-e593-4d0b-9e9c-351147218eff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d933c2e7b20>]}
[0m10:22:14.078348 [debug] [Thread-3 (]: Finished running node model.superstore_dwh.geo_dim
[0m10:22:14.080212 [debug] [Thread-2 (]: On model.superstore_dwh.product_dim: Close
[0m10:22:14.080828 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m10:22:14.081497 [info ] [Thread-4 (]: 3 of 8 OK created sql table model dw_test.customer_dim ......................... [[32mSELECT 1093[0m in 0.24s]
[0m10:22:14.085803 [debug] [Thread-4 (]: Finished running node model.superstore_dwh.customer_dim
[0m10:22:14.085000 [debug] [Thread-1 (]: On model.superstore_dwh.shipping_dim: Close
[0m10:22:14.082620 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0189deb3-e593-4d0b-9e9c-351147218eff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d933c2a4370>]}
[0m10:22:14.086762 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0189deb3-e593-4d0b-9e9c-351147218eff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d933c213fa0>]}
[0m10:22:14.087626 [info ] [Thread-2 (]: 5 of 8 OK created sql table model dw_test.product_dim .......................... [[32mSELECT 4644[0m in 0.25s]
[0m10:22:14.090322 [debug] [Thread-2 (]: Finished running node model.superstore_dwh.product_dim
[0m10:22:14.089524 [info ] [Thread-1 (]: 6 of 8 OK created sql table model dw_test.shipping_dim ......................... [[32mSELECT 4[0m in 0.19s]
[0m10:22:14.091422 [debug] [Thread-1 (]: Finished running node model.superstore_dwh.shipping_dim
[0m10:22:14.092529 [debug] [Thread-3 (]: Began running node model.superstore_dwh.sales_fact
[0m10:22:14.093244 [info ] [Thread-3 (]: 7 of 8 START sql table model dw_test.sales_fact ................................ [RUN]
[0m10:22:14.094094 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.geo_dim, now model.superstore_dwh.sales_fact)
[0m10:22:14.094626 [debug] [Thread-3 (]: Began compiling node model.superstore_dwh.sales_fact
[0m10:22:14.103640 [debug] [Thread-3 (]: Writing injected SQL for node "model.superstore_dwh.sales_fact"
[0m10:22:14.106715 [debug] [Thread-3 (]: Began executing node model.superstore_dwh.sales_fact
[0m10:22:14.185884 [debug] [Thread-3 (]: Writing runtime sql for node "model.superstore_dwh.sales_fact"
[0m10:22:14.187359 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.sales_fact"
[0m10:22:14.188050 [debug] [Thread-3 (]: On model.superstore_dwh.sales_fact: BEGIN
[0m10:22:14.188611 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:22:14.195804 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m10:22:14.196560 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.sales_fact"
[0m10:22:14.197141 [debug] [Thread-3 (]: On model.superstore_dwh.sales_fact: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.sales_fact"} */

  
    

  create  table "superstore"."dw_test"."sales_fact__dbt_tmp"
  
  
    as
  
  (
    -- Создает таблицу фактов, объединяя все измерения
SELECT
    -- Суррогатные ключи из измерений
    cd.cust_id,
    pd.prod_id,
    sd.ship_id,
    gd.geo_id,
    -- Ключи для календаря
    to_char(o.order_date, 'yyyymmdd')::int AS order_date_id,
    to_char(o.ship_date, 'yyyymmdd')::int AS ship_date_id,
    -- Бизнес-ключ и метрики
    o.order_id,
    o.sales,
    o.profit,
    o.quantity,
    o.discount
FROM "superstore"."stg"."stg_orders" AS o
LEFT JOIN "superstore"."dw_test"."customer_dim" AS cd ON o.customer_id = cd.customer_id
LEFT JOIN "superstore"."dw_test"."product_dim" AS pd ON o.product_id = pd.product_id
LEFT JOIN "superstore"."dw_test"."shipping_dim" AS sd ON o.ship_mode = sd.ship_mode
LEFT JOIN "superstore"."dw_test"."geo_dim" AS gd ON o.postal_code = gd.postal_code AND o.city = gd.city AND o.state = gd.state
  );
  
[0m10:22:14.283965 [debug] [Thread-3 (]: SQL status: SELECT 25967 in 0.086 seconds
[0m10:22:14.287562 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.sales_fact"
[0m10:22:14.288136 [debug] [Thread-3 (]: On model.superstore_dwh.sales_fact: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.sales_fact"} */
alter table "superstore"."dw_test"."sales_fact" rename to "sales_fact__dbt_backup"
[0m10:22:14.289142 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:22:14.292188 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.sales_fact"
[0m10:22:14.292720 [debug] [Thread-3 (]: On model.superstore_dwh.sales_fact: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.sales_fact"} */
alter table "superstore"."dw_test"."sales_fact__dbt_tmp" rename to "sales_fact"
[0m10:22:14.293639 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:22:14.295097 [debug] [Thread-3 (]: On model.superstore_dwh.sales_fact: COMMIT
[0m10:22:14.295693 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.sales_fact"
[0m10:22:14.296296 [debug] [Thread-3 (]: On model.superstore_dwh.sales_fact: COMMIT
[0m10:22:14.302038 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m10:22:14.304891 [debug] [Thread-3 (]: Applying DROP to: "superstore"."dw_test"."sales_fact__dbt_backup"
[0m10:22:14.305683 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.sales_fact"
[0m10:22:14.306257 [debug] [Thread-3 (]: On model.superstore_dwh.sales_fact: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.sales_fact"} */
drop table if exists "superstore"."dw_test"."sales_fact__dbt_backup" cascade
[0m10:22:14.309305 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m10:22:14.310803 [debug] [Thread-3 (]: On model.superstore_dwh.sales_fact: Close
[0m10:22:14.313756 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0189deb3-e593-4d0b-9e9c-351147218eff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d933cffdfc0>]}
[0m10:22:14.314680 [info ] [Thread-3 (]: 7 of 8 OK created sql table model dw_test.sales_fact ........................... [[32mSELECT 25967[0m in 0.22s]
[0m10:22:14.315512 [debug] [Thread-3 (]: Finished running node model.superstore_dwh.sales_fact
[0m10:22:14.316369 [debug] [Thread-2 (]: Began running node model.superstore_dwh.mart_order_processing_time
[0m10:22:14.317112 [info ] [Thread-2 (]: 8 of 8 START sql table model dw_test.mart_order_processing_time ................ [RUN]
[0m10:22:14.317814 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.product_dim, now model.superstore_dwh.mart_order_processing_time)
[0m10:22:14.318355 [debug] [Thread-2 (]: Began compiling node model.superstore_dwh.mart_order_processing_time
[0m10:22:14.322528 [debug] [Thread-2 (]: Writing injected SQL for node "model.superstore_dwh.mart_order_processing_time"
[0m10:22:14.324141 [debug] [Thread-2 (]: Began executing node model.superstore_dwh.mart_order_processing_time
[0m10:22:14.328093 [debug] [Thread-2 (]: Writing runtime sql for node "model.superstore_dwh.mart_order_processing_time"
[0m10:22:14.329346 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.mart_order_processing_time"
[0m10:22:14.329858 [debug] [Thread-2 (]: On model.superstore_dwh.mart_order_processing_time: BEGIN
[0m10:22:14.330356 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:22:14.344320 [debug] [Thread-2 (]: SQL status: BEGIN in 0.014 seconds
[0m10:22:14.345234 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.mart_order_processing_time"
[0m10:22:14.346394 [debug] [Thread-2 (]: On model.superstore_dwh.mart_order_processing_time: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.mart_order_processing_time"} */

  
    

  create  table "superstore"."dw_test"."mart_order_processing_time__dbt_tmp"
  
  
    as
  
  (
    SELECT
    p.sub_category,
    AVG(s.ship_date - s.order_date) AS avg_processing_days
FROM "superstore"."dw_test"."sales_fact" AS f
LEFT JOIN "superstore"."dw_test"."product_dim" AS p 
    ON f.prod_id = p.prod_id
LEFT JOIN "superstore"."stg"."stg_orders" AS s
    ON f.order_id = s.order_id
GROUP BY p.sub_category
ORDER BY avg_processing_days DESC
LIMIT 5
  );
  
[0m10:22:14.402532 [debug] [Thread-2 (]: SQL status: SELECT 5 in 0.055 seconds
[0m10:22:14.408019 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.mart_order_processing_time"
[0m10:22:14.408877 [debug] [Thread-2 (]: On model.superstore_dwh.mart_order_processing_time: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.mart_order_processing_time"} */
alter table "superstore"."dw_test"."mart_order_processing_time" rename to "mart_order_processing_time__dbt_backup"
[0m10:22:14.410000 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:22:14.413253 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.mart_order_processing_time"
[0m10:22:14.413808 [debug] [Thread-2 (]: On model.superstore_dwh.mart_order_processing_time: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.mart_order_processing_time"} */
alter table "superstore"."dw_test"."mart_order_processing_time__dbt_tmp" rename to "mart_order_processing_time"
[0m10:22:14.414820 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:22:14.416637 [debug] [Thread-2 (]: On model.superstore_dwh.mart_order_processing_time: COMMIT
[0m10:22:14.417278 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.mart_order_processing_time"
[0m10:22:14.417759 [debug] [Thread-2 (]: On model.superstore_dwh.mart_order_processing_time: COMMIT
[0m10:22:14.419260 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m10:22:14.421812 [debug] [Thread-2 (]: Applying DROP to: "superstore"."dw_test"."mart_order_processing_time__dbt_backup"
[0m10:22:14.422632 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.mart_order_processing_time"
[0m10:22:14.423209 [debug] [Thread-2 (]: On model.superstore_dwh.mart_order_processing_time: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.mart_order_processing_time"} */
drop table if exists "superstore"."dw_test"."mart_order_processing_time__dbt_backup" cascade
[0m10:22:14.425340 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m10:22:14.426845 [debug] [Thread-2 (]: On model.superstore_dwh.mart_order_processing_time: Close
[0m10:22:14.427637 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0189deb3-e593-4d0b-9e9c-351147218eff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d933cf654e0>]}
[0m10:22:14.428438 [info ] [Thread-2 (]: 8 of 8 OK created sql table model dw_test.mart_order_processing_time ........... [[32mSELECT 5[0m in 0.11s]
[0m10:22:14.429373 [debug] [Thread-2 (]: Finished running node model.superstore_dwh.mart_order_processing_time
[0m10:22:14.430945 [debug] [MainThread]: Using postgres connection "master"
[0m10:22:14.431436 [debug] [MainThread]: On master: BEGIN
[0m10:22:14.431881 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:22:14.439880 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m10:22:14.440532 [debug] [MainThread]: On master: COMMIT
[0m10:22:14.441320 [debug] [MainThread]: Using postgres connection "master"
[0m10:22:14.441778 [debug] [MainThread]: On master: COMMIT
[0m10:22:14.442552 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:22:14.443034 [debug] [MainThread]: On master: Close
[0m10:22:14.445962 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:22:14.446513 [debug] [MainThread]: Connection 'model.superstore_dwh.shipping_dim' was properly closed.
[0m10:22:14.446935 [debug] [MainThread]: Connection 'model.superstore_dwh.mart_order_processing_time' was properly closed.
[0m10:22:14.447450 [debug] [MainThread]: Connection 'model.superstore_dwh.customer_dim' was properly closed.
[0m10:22:14.447895 [debug] [MainThread]: Connection 'model.superstore_dwh.sales_fact' was properly closed.
[0m10:22:14.448489 [info ] [MainThread]: 
[0m10:22:14.449810 [info ] [MainThread]: Finished running 7 table models, 1 view model in 0 hours 0 minutes and 1.00 seconds (1.00s).
[0m10:22:14.451768 [debug] [MainThread]: Command end result
[0m10:22:14.480462 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/manifest.json
[0m10:22:14.482942 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/semantic_manifest.json
[0m10:22:14.494847 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dev/Downloads/pde_magistr/superstore_dwh/target/run_results.json
[0m10:22:14.495466 [info ] [MainThread]: 
[0m10:22:14.497869 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:22:14.499712 [info ] [MainThread]: 
[0m10:22:14.501272 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m10:22:14.504287 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.1723819, "process_in_blocks": "0", "process_kernel_time": 0.204102, "process_mem_max_rss": "125436", "process_out_blocks": "3088", "process_user_time": 2.763386}
[0m10:22:14.504878 [debug] [MainThread]: Command `dbt run` succeeded at 10:22:14.504726 after 2.17 seconds
[0m10:22:14.507154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d93402b5930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d933fa942e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d933fa94400>]}
[0m10:22:14.507670 [debug] [MainThread]: Flushing usage events
[0m10:22:15.394506 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:22:20.030288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5a6aeb9960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5a69e741f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5a69e74190>]}


============================== 10:22:20.033159 | b331abba-533a-44c2-86ac-cd8f0b5a9db7 ==============================
[0m10:22:20.033159 [info ] [MainThread]: Running with dbt=1.10.11
[0m10:22:20.033847 [debug] [MainThread]: running dbt with arguments {'log_path': '/home/dev/Downloads/pde_magistr/superstore_dwh/logs', 'profiles_dir': '/home/dev/.dbt', 'invocation_command': 'dbt test', 'introspect': 'True', 'version_check': 'True', 'quiet': 'False', 'no_print': 'None', 'static_parser': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'printer_width': '80', 'empty': 'None', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'log_format': 'default', 'partial_parse': 'True', 'target_path': 'None', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'warn_error': 'None'}
[0m10:22:20.198051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b331abba-533a-44c2-86ac-cd8f0b5a9db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5a69e45ab0>]}
[0m10:22:20.261208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b331abba-533a-44c2-86ac-cd8f0b5a9db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5a6ad7b970>]}
[0m10:22:20.262063 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m10:22:20.349824 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m10:22:20.486909 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:22:20.487428 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:22:20.545262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b331abba-533a-44c2-86ac-cd8f0b5a9db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5a68331d50>]}
[0m10:22:20.642927 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/manifest.json
[0m10:22:20.644649 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/semantic_manifest.json
[0m10:22:20.703543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b331abba-533a-44c2-86ac-cd8f0b5a9db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5a68767730>]}
[0m10:22:20.704179 [info ] [MainThread]: Found 8 models, 11 data tests, 1 source, 435 macros
[0m10:22:20.704646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b331abba-533a-44c2-86ac-cd8f0b5a9db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5a683308e0>]}
[0m10:22:20.706672 [info ] [MainThread]: 
[0m10:22:20.707170 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:22:20.707598 [info ] [MainThread]: 
[0m10:22:20.708200 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:22:20.712873 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore_dw_test'
[0m10:22:20.723196 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore_stg'
[0m10:22:20.761760 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_test"
[0m10:22:20.762455 [debug] [ThreadPool]: Using postgres connection "list_superstore_stg"
[0m10:22:20.762988 [debug] [ThreadPool]: On list_superstore_dw_test: BEGIN
[0m10:22:20.763475 [debug] [ThreadPool]: On list_superstore_stg: BEGIN
[0m10:22:20.764022 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:22:20.764494 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:22:20.776306 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m10:22:20.777791 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_test"
[0m10:22:20.778952 [debug] [ThreadPool]: On list_superstore_dw_test: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore_dw_test"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_test'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_test'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_test'
  
[0m10:22:20.779909 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m10:22:20.780642 [debug] [ThreadPool]: Using postgres connection "list_superstore_stg"
[0m10:22:20.781137 [debug] [ThreadPool]: On list_superstore_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore_stg"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'stg'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'stg'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'stg'
  
[0m10:22:20.783124 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m10:22:20.784692 [debug] [ThreadPool]: On list_superstore_dw_test: ROLLBACK
[0m10:22:20.785488 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m10:22:20.786931 [debug] [ThreadPool]: On list_superstore_stg: ROLLBACK
[0m10:22:20.787614 [debug] [ThreadPool]: On list_superstore_dw_test: Close
[0m10:22:20.788703 [debug] [ThreadPool]: On list_superstore_stg: Close
[0m10:22:20.798635 [debug] [MainThread]: Using postgres connection "master"
[0m10:22:20.799320 [debug] [MainThread]: On master: BEGIN
[0m10:22:20.799768 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:22:20.807752 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m10:22:20.808354 [debug] [MainThread]: Using postgres connection "master"
[0m10:22:20.808824 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m10:22:20.818091 [debug] [MainThread]: SQL status: SELECT 3 in 0.009 seconds
[0m10:22:20.822401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b331abba-533a-44c2-86ac-cd8f0b5a9db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5a6bbe1f60>]}
[0m10:22:20.823551 [debug] [MainThread]: On master: ROLLBACK
[0m10:22:20.824706 [debug] [MainThread]: Using postgres connection "master"
[0m10:22:20.825540 [debug] [MainThread]: On master: BEGIN
[0m10:22:20.826829 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:22:20.827651 [debug] [MainThread]: On master: COMMIT
[0m10:22:20.828424 [debug] [MainThread]: Using postgres connection "master"
[0m10:22:20.829151 [debug] [MainThread]: On master: COMMIT
[0m10:22:20.830095 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:22:20.830832 [debug] [MainThread]: On master: Close
[0m10:22:20.837137 [debug] [Thread-1 (]: Began running node test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m10:22:20.837762 [info ] [Thread-1 (]: 1 of 11 START test not_null_customer_dim_cust_id ............................... [RUN]
[0m10:22:20.838512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_superstore_stg, now test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42)
[0m10:22:20.839218 [debug] [Thread-2 (]: Began running node test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m10:22:20.840059 [debug] [Thread-3 (]: Began running node test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029
[0m10:22:20.842725 [info ] [Thread-3 (]: 3 of 11 START test not_null_mart_order_processing_time_avg_processing_days ..... [RUN]
[0m10:22:20.843423 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029'
[0m10:22:20.841816 [info ] [Thread-2 (]: 2 of 11 START test not_null_geo_dim_geo_id ..................................... [RUN]
[0m10:22:20.841219 [debug] [Thread-4 (]: Began running node test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209
[0m10:22:20.840654 [debug] [Thread-1 (]: Began compiling node test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m10:22:20.843995 [debug] [Thread-3 (]: Began compiling node test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029
[0m10:22:20.845873 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_superstore_dw_test, now test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d)
[0m10:22:20.846491 [info ] [Thread-4 (]: 4 of 11 START test not_null_mart_order_processing_time_sub_category ............ [RUN]
[0m10:22:20.883315 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209'
[0m10:22:20.882628 [debug] [Thread-3 (]: Writing injected SQL for node "test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029"
[0m10:22:20.881091 [debug] [Thread-1 (]: Writing injected SQL for node "test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42"
[0m10:22:20.884972 [debug] [Thread-3 (]: Began executing node test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029
[0m10:22:20.883859 [debug] [Thread-4 (]: Began compiling node test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209
[0m10:22:20.885749 [debug] [Thread-1 (]: Began executing node test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m10:22:20.876285 [debug] [Thread-2 (]: Began compiling node test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m10:22:20.908210 [debug] [Thread-4 (]: Writing injected SQL for node "test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209"
[0m10:22:20.940884 [debug] [Thread-2 (]: Writing injected SQL for node "test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d"
[0m10:22:20.961861 [debug] [Thread-3 (]: Writing runtime sql for node "test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029"
[0m10:22:20.958380 [debug] [Thread-1 (]: Writing runtime sql for node "test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42"
[0m10:22:20.966722 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42"
[0m10:22:20.965233 [debug] [Thread-4 (]: Began executing node test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209
[0m10:22:20.965952 [debug] [Thread-3 (]: Using postgres connection "test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029"
[0m10:22:20.967231 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42: BEGIN
[0m10:22:20.963679 [debug] [Thread-2 (]: Began executing node test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m10:22:20.970811 [debug] [Thread-4 (]: Writing runtime sql for node "test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209"
[0m10:22:20.971342 [debug] [Thread-3 (]: On test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029: BEGIN
[0m10:22:20.971963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:22:20.974148 [debug] [Thread-2 (]: Writing runtime sql for node "test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d"
[0m10:22:20.975670 [debug] [Thread-4 (]: Using postgres connection "test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209"
[0m10:22:20.974912 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:22:20.977137 [debug] [Thread-4 (]: On test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209: BEGIN
[0m10:22:20.979252 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:22:20.978424 [debug] [Thread-2 (]: Using postgres connection "test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d"
[0m10:22:20.980750 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d: BEGIN
[0m10:22:20.981573 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:22:20.988120 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m10:22:20.989113 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42"
[0m10:22:20.991311 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select cust_id
from "superstore"."dw_test"."customer_dim"
where cust_id is null



  
  
      
    ) dbt_internal_test
[0m10:22:20.993037 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m10:22:20.994097 [debug] [Thread-4 (]: SQL status: BEGIN in 0.014 seconds
[0m10:22:20.999712 [debug] [Thread-4 (]: Using postgres connection "test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209"
[0m10:22:21.000242 [debug] [Thread-4 (]: On test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sub_category
from "superstore"."dw_test"."mart_order_processing_time"
where sub_category is null



  
  
      
    ) dbt_internal_test
[0m10:22:20.999168 [debug] [Thread-3 (]: SQL status: BEGIN in 0.024 seconds
[0m10:22:20.998477 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42: ROLLBACK
[0m10:22:21.001078 [debug] [Thread-2 (]: SQL status: BEGIN in 0.019 seconds
[0m10:22:21.001635 [debug] [Thread-3 (]: Using postgres connection "test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029"
[0m10:22:21.002346 [debug] [Thread-2 (]: Using postgres connection "test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d"
[0m10:22:21.003438 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m10:22:21.003845 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42: Close
[0m10:22:21.006649 [info ] [Thread-1 (]: 1 of 11 PASS not_null_customer_dim_cust_id ..................................... [[32mPASS[0m in 0.17s]
[0m10:22:21.004450 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select geo_id
from "superstore"."dw_test"."geo_dim"
where geo_id is null



  
  
      
    ) dbt_internal_test
[0m10:22:21.008664 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m10:22:21.005897 [debug] [Thread-4 (]: On test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209: ROLLBACK
[0m10:22:21.002867 [debug] [Thread-3 (]: On test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_processing_days
from "superstore"."dw_test"."mart_order_processing_time"
where avg_processing_days is null



  
  
      
    ) dbt_internal_test
[0m10:22:21.007371 [debug] [Thread-1 (]: Finished running node test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m10:22:21.010168 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d: ROLLBACK
[0m10:22:21.011545 [debug] [Thread-1 (]: Began running node test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688
[0m10:22:21.012170 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m10:22:21.012970 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d: Close
[0m10:22:21.013450 [debug] [Thread-4 (]: On test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209: Close
[0m10:22:21.017777 [debug] [Thread-3 (]: On test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029: ROLLBACK
[0m10:22:21.013967 [info ] [Thread-1 (]: 5 of 11 START test not_null_product_dim_prod_id ................................ [RUN]
[0m10:22:21.021638 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42, now test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688)
[0m10:22:21.022396 [debug] [Thread-1 (]: Began compiling node test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688
[0m10:22:21.023515 [debug] [Thread-3 (]: On test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029: Close
[0m10:22:21.020211 [info ] [Thread-2 (]: 2 of 11 PASS not_null_geo_dim_geo_id ........................................... [[32mPASS[0m in 0.17s]
[0m10:22:21.031646 [debug] [Thread-2 (]: Finished running node test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m10:22:21.032240 [debug] [Thread-2 (]: Began running node test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m10:22:21.020985 [info ] [Thread-4 (]: 4 of 11 PASS not_null_mart_order_processing_time_sub_category .................. [[32mPASS[0m in 0.14s]
[0m10:22:21.037828 [debug] [Thread-4 (]: Finished running node test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209
[0m10:22:21.039528 [debug] [Thread-4 (]: Began running node test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m10:22:21.030052 [debug] [Thread-1 (]: Writing injected SQL for node "test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688"
[0m10:22:21.032711 [info ] [Thread-2 (]: 6 of 11 START test not_null_shipping_dim_ship_id ............................... [RUN]
[0m10:22:21.036036 [info ] [Thread-3 (]: 3 of 11 PASS not_null_mart_order_processing_time_avg_processing_days ........... [[32mPASS[0m in 0.19s]
[0m10:22:21.047413 [debug] [Thread-3 (]: Finished running node test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029
[0m10:22:21.047965 [debug] [Thread-3 (]: Began running node test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721
[0m10:22:21.046497 [debug] [Thread-1 (]: Began executing node test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688
[0m10:22:21.042898 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d, now test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d)
[0m10:22:21.041328 [info ] [Thread-4 (]: 7 of 11 START test relationships_sales_fact_cust_id__cust_id__ref_customer_dim_  [RUN]
[0m10:22:21.057275 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209, now test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279)
[0m10:22:21.057768 [debug] [Thread-4 (]: Began compiling node test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m10:22:21.048586 [info ] [Thread-3 (]: 8 of 11 START test unique_customer_dim_cust_id ................................. [RUN]
[0m10:22:21.056538 [debug] [Thread-2 (]: Began compiling node test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m10:22:21.055658 [debug] [Thread-1 (]: Writing runtime sql for node "test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688"
[0m10:22:21.064775 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029, now test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721)
[0m10:22:21.073934 [debug] [Thread-2 (]: Writing injected SQL for node "test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d"
[0m10:22:21.076081 [debug] [Thread-3 (]: Began compiling node test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721
[0m10:22:21.084114 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688"
[0m10:22:21.095033 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688: BEGIN
[0m10:22:21.086960 [debug] [Thread-2 (]: Began executing node test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m10:22:21.085799 [debug] [Thread-4 (]: Writing injected SQL for node "test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"
[0m10:22:21.104561 [debug] [Thread-4 (]: Began executing node test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m10:22:21.094496 [debug] [Thread-3 (]: Writing injected SQL for node "test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721"
[0m10:22:21.110394 [debug] [Thread-3 (]: Began executing node test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721
[0m10:22:21.108378 [debug] [Thread-4 (]: Writing runtime sql for node "test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"
[0m10:22:21.095581 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:22:21.103695 [debug] [Thread-2 (]: Writing runtime sql for node "test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d"
[0m10:22:21.118525 [debug] [Thread-2 (]: Using postgres connection "test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d"
[0m10:22:21.120547 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d: BEGIN
[0m10:22:21.115397 [debug] [Thread-3 (]: Writing runtime sql for node "test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721"
[0m10:22:21.121483 [debug] [Thread-4 (]: Using postgres connection "test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"
[0m10:22:21.122173 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:22:21.123150 [debug] [Thread-4 (]: On test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279: BEGIN
[0m10:22:21.124132 [debug] [Thread-3 (]: Using postgres connection "test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721"
[0m10:22:21.127604 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:22:21.128783 [debug] [Thread-3 (]: On test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721: BEGIN
[0m10:22:21.131407 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:22:21.129662 [debug] [Thread-1 (]: SQL status: BEGIN in 0.034 seconds
[0m10:22:21.133163 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688"
[0m10:22:21.133650 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select prod_id
from "superstore"."dw_test"."product_dim"
where prod_id is null



  
  
      
    ) dbt_internal_test
[0m10:22:21.136175 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m10:22:21.140188 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688: ROLLBACK
[0m10:22:21.143793 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688: Close
[0m10:22:21.150201 [debug] [Thread-2 (]: SQL status: BEGIN in 0.028 seconds
[0m10:22:21.147298 [info ] [Thread-1 (]: 5 of 11 PASS not_null_product_dim_prod_id ...................................... [[32mPASS[0m in 0.13s]
[0m10:22:21.151161 [debug] [Thread-4 (]: SQL status: BEGIN in 0.024 seconds
[0m10:22:21.151994 [debug] [Thread-2 (]: Using postgres connection "test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d"
[0m10:22:21.153273 [debug] [Thread-3 (]: SQL status: BEGIN in 0.022 seconds
[0m10:22:21.153956 [debug] [Thread-1 (]: Finished running node test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688
[0m10:22:21.154621 [debug] [Thread-4 (]: Using postgres connection "test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"
[0m10:22:21.155183 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ship_id
from "superstore"."dw_test"."shipping_dim"
where ship_id is null



  
  
      
    ) dbt_internal_test
[0m10:22:21.157946 [debug] [Thread-3 (]: Using postgres connection "test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721"
[0m10:22:21.160236 [debug] [Thread-1 (]: Began running node test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m10:22:21.160881 [debug] [Thread-4 (]: On test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select cust_id as from_field
    from "superstore"."dw_test"."sales_fact"
    where cust_id is not null
),

parent as (
    select cust_id as to_field
    from "superstore"."dw_test"."customer_dim"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m10:22:21.162289 [debug] [Thread-3 (]: On test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    cust_id as unique_field,
    count(*) as n_records

from "superstore"."dw_test"."customer_dim"
where cust_id is not null
group by cust_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m10:22:21.167385 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m10:22:21.164765 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m10:22:21.162928 [info ] [Thread-1 (]: 9 of 11 START test unique_geo_dim_geo_id ....................................... [RUN]
[0m10:22:21.168908 [debug] [Thread-3 (]: On test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721: ROLLBACK
[0m10:22:21.171833 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.007 seconds
[0m10:22:21.173884 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d: ROLLBACK
[0m10:22:21.184310 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d: Close
[0m10:22:21.177963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688, now test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2)
[0m10:22:21.185969 [debug] [Thread-1 (]: Began compiling node test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m10:22:21.182022 [debug] [Thread-4 (]: On test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279: ROLLBACK
[0m10:22:21.183440 [debug] [Thread-3 (]: On test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721: Close
[0m10:22:21.193338 [info ] [Thread-2 (]: 6 of 11 PASS not_null_shipping_dim_ship_id ..................................... [[32mPASS[0m in 0.15s]
[0m10:22:21.194949 [debug] [Thread-1 (]: Writing injected SQL for node "test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2"
[0m10:22:21.200233 [debug] [Thread-2 (]: Finished running node test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m10:22:21.206141 [debug] [Thread-2 (]: Began running node test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m10:22:21.199243 [info ] [Thread-3 (]: 8 of 11 PASS unique_customer_dim_cust_id ....................................... [[32mPASS[0m in 0.13s]
[0m10:22:21.207378 [debug] [Thread-3 (]: Finished running node test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721
[0m10:22:21.203931 [debug] [Thread-1 (]: Began executing node test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m10:22:21.200778 [debug] [Thread-4 (]: On test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279: Close
[0m10:22:21.208952 [debug] [Thread-3 (]: Began running node test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m10:22:21.206731 [info ] [Thread-2 (]: 10 of 11 START test unique_product_dim_prod_id ................................. [RUN]
[0m10:22:21.218543 [debug] [Thread-1 (]: Writing runtime sql for node "test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2"
[0m10:22:21.221148 [info ] [Thread-4 (]: 7 of 11 PASS relationships_sales_fact_cust_id__cust_id__ref_customer_dim_ ...... [[32mPASS[0m in 0.16s]
[0m10:22:21.217357 [info ] [Thread-3 (]: 11 of 11 START test unique_shipping_dim_ship_id ................................ [RUN]
[0m10:22:21.221869 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d, now test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c)
[0m10:22:21.227673 [debug] [Thread-2 (]: Began compiling node test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m10:22:21.226015 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2"
[0m10:22:21.241269 [debug] [Thread-1 (]: On test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2: BEGIN
[0m10:22:21.223875 [debug] [Thread-4 (]: Finished running node test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m10:22:21.240559 [debug] [Thread-2 (]: Writing injected SQL for node "test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c"
[0m10:22:21.241733 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:22:21.226944 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721, now test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7)
[0m10:22:21.245057 [debug] [Thread-3 (]: Began compiling node test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m10:22:21.255509 [debug] [Thread-2 (]: Began executing node test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m10:22:21.261318 [debug] [Thread-3 (]: Writing injected SQL for node "test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7"
[0m10:22:21.264295 [debug] [Thread-2 (]: Writing runtime sql for node "test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c"
[0m10:22:21.265637 [debug] [Thread-3 (]: Began executing node test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m10:22:21.266252 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m10:22:21.268544 [debug] [Thread-2 (]: Using postgres connection "test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c"
[0m10:22:21.281667 [debug] [Thread-2 (]: On test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c: BEGIN
[0m10:22:21.282606 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:22:21.278443 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2"
[0m10:22:21.285413 [debug] [Thread-1 (]: On test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    geo_id as unique_field,
    count(*) as n_records

from "superstore"."dw_test"."geo_dim"
where geo_id is not null
group by geo_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m10:22:21.275390 [debug] [Thread-3 (]: Writing runtime sql for node "test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7"
[0m10:22:21.286797 [debug] [Thread-3 (]: Using postgres connection "test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7"
[0m10:22:21.287636 [debug] [Thread-3 (]: On test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7: BEGIN
[0m10:22:21.289639 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:22:21.292164 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m10:22:21.299375 [debug] [Thread-1 (]: On test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2: ROLLBACK
[0m10:22:21.302459 [debug] [Thread-1 (]: On test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2: Close
[0m10:22:21.306577 [info ] [Thread-1 (]: 9 of 11 PASS unique_geo_dim_geo_id ............................................. [[32mPASS[0m in 0.13s]
[0m10:22:21.308232 [debug] [Thread-2 (]: SQL status: BEGIN in 0.026 seconds
[0m10:22:21.312210 [debug] [Thread-1 (]: Finished running node test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m10:22:21.314688 [debug] [Thread-3 (]: SQL status: BEGIN in 0.025 seconds
[0m10:22:21.315611 [debug] [Thread-3 (]: Using postgres connection "test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7"
[0m10:22:21.314141 [debug] [Thread-2 (]: Using postgres connection "test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c"
[0m10:22:21.318855 [debug] [Thread-2 (]: On test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    prod_id as unique_field,
    count(*) as n_records

from "superstore"."dw_test"."product_dim"
where prod_id is not null
group by prod_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m10:22:21.316767 [debug] [Thread-3 (]: On test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    ship_id as unique_field,
    count(*) as n_records

from "superstore"."dw_test"."shipping_dim"
where ship_id is not null
group by ship_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m10:22:21.321162 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m10:22:21.323234 [debug] [Thread-3 (]: On test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7: ROLLBACK
[0m10:22:21.324386 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.005 seconds
[0m10:22:21.325823 [debug] [Thread-2 (]: On test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c: ROLLBACK
[0m10:22:21.329740 [debug] [Thread-2 (]: On test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c: Close
[0m10:22:21.328786 [debug] [Thread-3 (]: On test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7: Close
[0m10:22:21.331725 [info ] [Thread-3 (]: 11 of 11 PASS unique_shipping_dim_ship_id ...................................... [[32mPASS[0m in 0.11s]
[0m10:22:21.333979 [debug] [Thread-3 (]: Finished running node test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m10:22:21.333145 [info ] [Thread-2 (]: 10 of 11 PASS unique_product_dim_prod_id ....................................... [[32mPASS[0m in 0.11s]
[0m10:22:21.335040 [debug] [Thread-2 (]: Finished running node test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m10:22:21.336566 [debug] [MainThread]: Using postgres connection "master"
[0m10:22:21.337285 [debug] [MainThread]: On master: BEGIN
[0m10:22:21.338492 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:22:21.353437 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m10:22:21.354005 [debug] [MainThread]: On master: COMMIT
[0m10:22:21.354462 [debug] [MainThread]: Using postgres connection "master"
[0m10:22:21.354857 [debug] [MainThread]: On master: COMMIT
[0m10:22:21.355401 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:22:21.355815 [debug] [MainThread]: On master: Close
[0m10:22:21.357759 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:22:21.358154 [debug] [MainThread]: Connection 'test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c' was properly closed.
[0m10:22:21.358783 [debug] [MainThread]: Connection 'test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2' was properly closed.
[0m10:22:21.359151 [debug] [MainThread]: Connection 'test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7' was properly closed.
[0m10:22:21.359585 [debug] [MainThread]: Connection 'test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279' was properly closed.
[0m10:22:21.360044 [info ] [MainThread]: 
[0m10:22:21.360567 [info ] [MainThread]: Finished running 11 data tests in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m10:22:21.362959 [debug] [MainThread]: Command end result
[0m10:22:21.389044 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/manifest.json
[0m10:22:21.391242 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/semantic_manifest.json
[0m10:22:21.405434 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dev/Downloads/pde_magistr/superstore_dwh/target/run_results.json
[0m10:22:21.406098 [info ] [MainThread]: 
[0m10:22:21.406791 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:22:21.407400 [info ] [MainThread]: 
[0m10:22:21.408051 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=11
[0m10:22:21.409264 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.4384898, "process_in_blocks": "0", "process_kernel_time": 0.180917, "process_mem_max_rss": "120412", "process_out_blocks": "2192", "process_user_time": 2.21899}
[0m10:22:21.409852 [debug] [MainThread]: Command `dbt test` succeeded at 10:22:21.409738 after 1.44 seconds
[0m10:22:21.410426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5a6aeb9960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5a687a1210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5a6ad7b970>]}
[0m10:22:21.411007 [debug] [MainThread]: Flushing usage events
[0m10:22:21.934417 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:39:47.123144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6119ca9990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6118c5c190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6118c5c130>]}


============================== 10:39:47.127137 | 63879448-079f-4b65-9050-fa271d5cb486 ==============================
[0m10:39:47.127137 [info ] [MainThread]: Running with dbt=1.10.11
[0m10:39:47.128082 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'static_parser': 'True', 'target_path': 'None', 'no_print': 'None', 'cache_selected_only': 'False', 'introspect': 'True', 'empty': 'None', 'debug': 'False', 'version_check': 'True', 'profiles_dir': '/home/dev/.dbt', 'log_path': '/home/dev/Downloads/pde_magistr/superstore_dwh/logs', 'log_format': 'default', 'write_json': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'quiet': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt docs serve', 'use_colors': 'True', 'indirect_selection': 'eager'}
[0m10:39:47.330928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63879448-079f-4b65-9050-fa271d5cb486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6118b3cf40>]}
[0m10:39:47.398186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63879448-079f-4b65-9050-fa271d5cb486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b61195274f0>]}
[0m11:07:53.955097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d024b7a9900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d024a768220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d024a7681c0>]}


============================== 11:07:53.958540 | 23c9d7f8-08fe-4c9f-8105-7b581ff7363e ==============================
[0m11:07:53.958540 [info ] [MainThread]: Running with dbt=1.10.11
[0m11:07:53.959614 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/home/dev/.dbt', 'introspect': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test', 'debug': 'False', 'printer_width': '80', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'fail_fast': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'log_path': '/home/dev/Downloads/pde_magistr/superstore_dwh/logs', 'target_path': 'None', 'warn_error': 'None', 'partial_parse': 'True', 'quiet': 'False', 'use_colors': 'True', 'static_parser': 'True', 'version_check': 'True', 'empty': 'None', 'use_experimental_parser': 'False'}
[0m11:07:54.139342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '23c9d7f8-08fe-4c9f-8105-7b581ff7363e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d024a70fa90>]}
[0m11:07:54.210659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '23c9d7f8-08fe-4c9f-8105-7b581ff7363e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d024a76a110>]}
[0m11:07:54.211867 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m11:07:54.304189 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m11:07:54.467130 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:07:54.467917 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:07:54.527617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '23c9d7f8-08fe-4c9f-8105-7b581ff7363e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0248b1dcf0>]}
[0m11:07:54.634450 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/manifest.json
[0m11:07:54.636218 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/semantic_manifest.json
[0m11:07:54.700826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '23c9d7f8-08fe-4c9f-8105-7b581ff7363e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0248b1fbb0>]}
[0m11:07:54.701594 [info ] [MainThread]: Found 8 models, 11 data tests, 1 source, 435 macros
[0m11:07:54.702590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23c9d7f8-08fe-4c9f-8105-7b581ff7363e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0248b1e770>]}
[0m11:07:54.705302 [info ] [MainThread]: 
[0m11:07:54.705827 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:07:54.706339 [info ] [MainThread]: 
[0m11:07:54.706968 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:07:54.712273 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore_dw_test'
[0m11:07:54.713092 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore_stg'
[0m11:07:54.765319 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_test"
[0m11:07:54.766099 [debug] [ThreadPool]: Using postgres connection "list_superstore_stg"
[0m11:07:54.766611 [debug] [ThreadPool]: On list_superstore_dw_test: BEGIN
[0m11:07:54.767125 [debug] [ThreadPool]: On list_superstore_stg: BEGIN
[0m11:07:54.767645 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:07:54.768442 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:07:54.780839 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m11:07:54.781496 [debug] [ThreadPool]: Using postgres connection "list_superstore_stg"
[0m11:07:54.781933 [debug] [ThreadPool]: On list_superstore_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore_stg"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'stg'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'stg'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'stg'
  
[0m11:07:54.783091 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m11:07:54.784775 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_test"
[0m11:07:54.785795 [debug] [ThreadPool]: On list_superstore_dw_test: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore_dw_test"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_test'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_test'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_test'
  
[0m11:07:54.787393 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.005 seconds
[0m11:07:54.789066 [debug] [ThreadPool]: On list_superstore_stg: ROLLBACK
[0m11:07:54.789846 [debug] [ThreadPool]: On list_superstore_stg: Close
[0m11:07:54.792354 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.005 seconds
[0m11:07:54.794090 [debug] [ThreadPool]: On list_superstore_dw_test: ROLLBACK
[0m11:07:54.795354 [debug] [ThreadPool]: On list_superstore_dw_test: Close
[0m11:07:54.803257 [debug] [MainThread]: Using postgres connection "master"
[0m11:07:54.803795 [debug] [MainThread]: On master: BEGIN
[0m11:07:54.804260 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:07:54.812297 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m11:07:54.813000 [debug] [MainThread]: Using postgres connection "master"
[0m11:07:54.813490 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m11:07:54.816586 [debug] [MainThread]: SQL status: SELECT 3 in 0.003 seconds
[0m11:07:54.818608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23c9d7f8-08fe-4c9f-8105-7b581ff7363e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0248b1c490>]}
[0m11:07:54.819239 [debug] [MainThread]: On master: ROLLBACK
[0m11:07:54.819874 [debug] [MainThread]: Using postgres connection "master"
[0m11:07:54.820328 [debug] [MainThread]: On master: BEGIN
[0m11:07:54.821200 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:07:54.821611 [debug] [MainThread]: On master: COMMIT
[0m11:07:54.822081 [debug] [MainThread]: Using postgres connection "master"
[0m11:07:54.822483 [debug] [MainThread]: On master: COMMIT
[0m11:07:54.823084 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:07:54.823501 [debug] [MainThread]: On master: Close
[0m11:07:54.826477 [debug] [Thread-1 (]: Began running node test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m11:07:54.827651 [debug] [Thread-2 (]: Began running node test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m11:07:54.827071 [info ] [Thread-1 (]: 1 of 11 START test not_null_customer_dim_cust_id ............................... [RUN]
[0m11:07:54.828727 [debug] [Thread-3 (]: Began running node test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029
[0m11:07:54.829403 [debug] [Thread-4 (]: Began running node test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209
[0m11:07:54.829966 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_superstore_dw_test, now test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42)
[0m11:07:54.828367 [info ] [Thread-2 (]: 2 of 11 START test not_null_geo_dim_geo_id ..................................... [RUN]
[0m11:07:54.831638 [debug] [Thread-1 (]: Began compiling node test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m11:07:54.830717 [info ] [Thread-3 (]: 3 of 11 START test not_null_mart_order_processing_time_avg_processing_days ..... [RUN]
[0m11:07:54.841273 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029'
[0m11:07:54.831230 [info ] [Thread-4 (]: 4 of 11 START test not_null_mart_order_processing_time_sub_category ............ [RUN]
[0m11:07:54.854059 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209'
[0m11:07:54.832609 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_superstore_stg, now test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d)
[0m11:07:54.855123 [debug] [Thread-4 (]: Began compiling node test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209
[0m11:07:54.856725 [debug] [Thread-1 (]: Writing injected SQL for node "test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42"
[0m11:07:54.841882 [debug] [Thread-3 (]: Began compiling node test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029
[0m11:07:54.857342 [debug] [Thread-2 (]: Began compiling node test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m11:07:54.862868 [debug] [Thread-4 (]: Writing injected SQL for node "test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209"
[0m11:07:54.877218 [debug] [Thread-4 (]: Began executing node test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209
[0m11:07:54.876186 [debug] [Thread-1 (]: Began executing node test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m11:07:54.885228 [debug] [Thread-3 (]: Writing injected SQL for node "test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029"
[0m11:07:54.891971 [debug] [Thread-2 (]: Writing injected SQL for node "test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d"
[0m11:07:54.915320 [debug] [Thread-3 (]: Began executing node test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029
[0m11:07:54.925641 [debug] [Thread-1 (]: Writing runtime sql for node "test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42"
[0m11:07:54.937606 [debug] [Thread-3 (]: Writing runtime sql for node "test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029"
[0m11:07:54.930165 [debug] [Thread-2 (]: Began executing node test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m11:07:54.928852 [debug] [Thread-4 (]: Writing runtime sql for node "test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209"
[0m11:07:54.940906 [debug] [Thread-2 (]: Writing runtime sql for node "test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d"
[0m11:07:54.942100 [debug] [Thread-2 (]: Using postgres connection "test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d"
[0m11:07:54.942564 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d: BEGIN
[0m11:07:54.942988 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:07:54.945220 [debug] [Thread-3 (]: Using postgres connection "test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029"
[0m11:07:54.945849 [debug] [Thread-3 (]: On test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029: BEGIN
[0m11:07:54.946354 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:07:54.947743 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42"
[0m11:07:54.948270 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42: BEGIN
[0m11:07:54.948686 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:07:54.950402 [debug] [Thread-4 (]: Using postgres connection "test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209"
[0m11:07:54.951944 [debug] [Thread-4 (]: On test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209: BEGIN
[0m11:07:54.952441 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:07:54.955537 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m11:07:54.958587 [debug] [Thread-2 (]: Using postgres connection "test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d"
[0m11:07:54.959135 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select geo_id
from "superstore"."dw_test"."geo_dim"
where geo_id is null



  
  
      
    ) dbt_internal_test
[0m11:07:54.962996 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m11:07:54.967671 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d: ROLLBACK
[0m11:07:54.968791 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d: Close
[0m11:07:54.971064 [info ] [Thread-2 (]: 2 of 11 PASS not_null_geo_dim_geo_id ........................................... [[32mPASS[0m in 0.14s]
[0m11:07:54.975074 [debug] [Thread-2 (]: Finished running node test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m11:07:54.977852 [debug] [Thread-2 (]: Began running node test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688
[0m11:07:54.988047 [debug] [Thread-3 (]: SQL status: BEGIN in 0.041 seconds
[0m11:07:54.988809 [debug] [Thread-3 (]: Using postgres connection "test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029"
[0m11:07:54.989500 [debug] [Thread-3 (]: On test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_processing_days
from "superstore"."dw_test"."mart_order_processing_time"
where avg_processing_days is null



  
  
      
    ) dbt_internal_test
[0m11:07:54.993283 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m11:07:54.986555 [info ] [Thread-2 (]: 5 of 11 START test not_null_product_dim_prod_id ................................ [RUN]
[0m11:07:54.997380 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42"
[0m11:07:54.999167 [debug] [Thread-4 (]: SQL status: BEGIN in 0.047 seconds
[0m11:07:55.003940 [debug] [Thread-4 (]: Using postgres connection "test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209"
[0m11:07:55.002403 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d, now test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688)
[0m11:07:55.003319 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select cust_id
from "superstore"."dw_test"."customer_dim"
where cust_id is null



  
  
      
    ) dbt_internal_test
[0m11:07:55.004508 [debug] [Thread-4 (]: On test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sub_category
from "superstore"."dw_test"."mart_order_processing_time"
where sub_category is null



  
  
      
    ) dbt_internal_test
[0m11:07:54.999723 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m11:07:55.005190 [debug] [Thread-2 (]: Began compiling node test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688
[0m11:07:55.009182 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m11:07:55.017192 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42: ROLLBACK
[0m11:07:55.008407 [debug] [Thread-3 (]: On test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029: ROLLBACK
[0m11:07:55.015112 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.008 seconds
[0m11:07:55.037197 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42: Close
[0m11:07:55.019091 [debug] [Thread-2 (]: Writing injected SQL for node "test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688"
[0m11:07:55.043149 [info ] [Thread-1 (]: 1 of 11 PASS not_null_customer_dim_cust_id ..................................... [[32mPASS[0m in 0.21s]
[0m11:07:55.045324 [debug] [Thread-1 (]: Finished running node test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m11:07:55.040185 [debug] [Thread-4 (]: On test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209: ROLLBACK
[0m11:07:55.045884 [debug] [Thread-1 (]: Began running node test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m11:07:55.038475 [debug] [Thread-3 (]: On test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029: Close
[0m11:07:55.044640 [debug] [Thread-2 (]: Began executing node test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688
[0m11:07:55.047297 [debug] [Thread-4 (]: On test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209: Close
[0m11:07:55.046749 [info ] [Thread-1 (]: 6 of 11 START test not_null_shipping_dim_ship_id ............................... [RUN]
[0m11:07:55.049893 [info ] [Thread-3 (]: 3 of 11 PASS not_null_mart_order_processing_time_avg_processing_days ........... [[32mPASS[0m in 0.21s]
[0m11:07:55.055547 [debug] [Thread-3 (]: Finished running node test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029
[0m11:07:55.056152 [debug] [Thread-3 (]: Began running node test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m11:07:55.053047 [debug] [Thread-2 (]: Writing runtime sql for node "test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688"
[0m11:07:55.054702 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42, now test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d)
[0m11:07:55.059244 [debug] [Thread-1 (]: Began compiling node test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m11:07:55.057147 [info ] [Thread-4 (]: 4 of 11 PASS not_null_mart_order_processing_time_sub_category .................. [[32mPASS[0m in 0.20s]
[0m11:07:55.058667 [debug] [Thread-2 (]: Using postgres connection "test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688"
[0m11:07:55.065504 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688: BEGIN
[0m11:07:55.057696 [info ] [Thread-3 (]: 7 of 11 START test relationships_sales_fact_cust_id__cust_id__ref_customer_dim_  [RUN]
[0m11:07:55.067402 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029, now test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279)
[0m11:07:55.063670 [debug] [Thread-1 (]: Writing injected SQL for node "test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d"
[0m11:07:55.066588 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:07:55.064830 [debug] [Thread-4 (]: Finished running node test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209
[0m11:07:55.067949 [debug] [Thread-3 (]: Began compiling node test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m11:07:55.069017 [debug] [Thread-1 (]: Began executing node test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m11:07:55.070368 [debug] [Thread-4 (]: Began running node test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721
[0m11:07:55.083334 [debug] [Thread-1 (]: Writing runtime sql for node "test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d"
[0m11:07:55.085128 [info ] [Thread-4 (]: 8 of 11 START test unique_customer_dim_cust_id ................................. [RUN]
[0m11:07:55.091332 [debug] [Thread-3 (]: Writing injected SQL for node "test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"
[0m11:07:55.095248 [debug] [Thread-3 (]: Began executing node test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m11:07:55.092620 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209, now test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721)
[0m11:07:55.095838 [debug] [Thread-2 (]: SQL status: BEGIN in 0.030 seconds
[0m11:07:55.094107 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d"
[0m11:07:55.104313 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d: BEGIN
[0m11:07:55.104769 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:07:55.100856 [debug] [Thread-4 (]: Began compiling node test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721
[0m11:07:55.103538 [debug] [Thread-2 (]: Using postgres connection "test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688"
[0m11:07:55.111719 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select prod_id
from "superstore"."dw_test"."product_dim"
where prod_id is null



  
  
      
    ) dbt_internal_test
[0m11:07:55.100203 [debug] [Thread-3 (]: Writing runtime sql for node "test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"
[0m11:07:55.118752 [debug] [Thread-4 (]: Writing injected SQL for node "test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721"
[0m11:07:55.119788 [debug] [Thread-4 (]: Began executing node test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721
[0m11:07:55.127582 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.015 seconds
[0m11:07:55.130338 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688: ROLLBACK
[0m11:07:55.131332 [debug] [Thread-3 (]: Using postgres connection "test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"
[0m11:07:55.134215 [debug] [Thread-3 (]: On test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279: BEGIN
[0m11:07:55.132344 [debug] [Thread-4 (]: Writing runtime sql for node "test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721"
[0m11:07:55.132858 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m11:07:55.137091 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d"
[0m11:07:55.137640 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ship_id
from "superstore"."dw_test"."shipping_dim"
where ship_id is null



  
  
      
    ) dbt_internal_test
[0m11:07:55.135815 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:07:55.140403 [debug] [Thread-4 (]: Using postgres connection "test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721"
[0m11:07:55.140921 [debug] [Thread-4 (]: On test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721: BEGIN
[0m11:07:55.141463 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:07:55.134741 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688: Close
[0m11:07:55.143253 [info ] [Thread-2 (]: 5 of 11 PASS not_null_product_dim_prod_id ...................................... [[32mPASS[0m in 0.14s]
[0m11:07:55.144210 [debug] [Thread-2 (]: Finished running node test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688
[0m11:07:55.146318 [debug] [Thread-2 (]: Began running node test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m11:07:55.148158 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.010 seconds
[0m11:07:55.158768 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d: ROLLBACK
[0m11:07:55.153504 [info ] [Thread-2 (]: 9 of 11 START test unique_geo_dim_geo_id ....................................... [RUN]
[0m11:07:55.165620 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688, now test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2)
[0m11:07:55.167056 [debug] [Thread-2 (]: Began compiling node test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m11:07:55.162534 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d: Close
[0m11:07:55.167607 [debug] [Thread-4 (]: SQL status: BEGIN in 0.026 seconds
[0m11:07:55.180390 [debug] [Thread-4 (]: Using postgres connection "test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721"
[0m11:07:55.180927 [debug] [Thread-4 (]: On test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    cust_id as unique_field,
    count(*) as n_records

from "superstore"."dw_test"."customer_dim"
where cust_id is not null
group by cust_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:07:55.164970 [debug] [Thread-3 (]: SQL status: BEGIN in 0.029 seconds
[0m11:07:55.181586 [debug] [Thread-3 (]: Using postgres connection "test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"
[0m11:07:55.174274 [debug] [Thread-2 (]: Writing injected SQL for node "test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2"
[0m11:07:55.184224 [debug] [Thread-3 (]: On test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select cust_id as from_field
    from "superstore"."dw_test"."sales_fact"
    where cust_id is not null
),

parent as (
    select cust_id as to_field
    from "superstore"."dw_test"."customer_dim"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m11:07:55.177913 [info ] [Thread-1 (]: 6 of 11 PASS not_null_shipping_dim_ship_id ..................................... [[32mPASS[0m in 0.12s]
[0m11:07:55.192352 [debug] [Thread-1 (]: Finished running node test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m11:07:55.188319 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.007 seconds
[0m11:07:55.187534 [debug] [Thread-2 (]: Began executing node test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m11:07:55.192970 [debug] [Thread-1 (]: Began running node test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m11:07:55.195004 [debug] [Thread-4 (]: On test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721: ROLLBACK
[0m11:07:55.202290 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.014 seconds
[0m11:07:55.204876 [debug] [Thread-3 (]: On test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279: ROLLBACK
[0m11:07:55.205895 [debug] [Thread-4 (]: On test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721: Close
[0m11:07:55.206435 [debug] [Thread-2 (]: Writing runtime sql for node "test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2"
[0m11:07:55.201373 [info ] [Thread-1 (]: 10 of 11 START test unique_product_dim_prod_id ................................. [RUN]
[0m11:07:55.209070 [info ] [Thread-4 (]: 8 of 11 PASS unique_customer_dim_cust_id ....................................... [[32mPASS[0m in 0.12s]
[0m11:07:55.212111 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d, now test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c)
[0m11:07:55.215121 [debug] [Thread-1 (]: Began compiling node test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m11:07:55.213146 [debug] [Thread-4 (]: Finished running node test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721
[0m11:07:55.222328 [debug] [Thread-4 (]: Began running node test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m11:07:55.210950 [debug] [Thread-3 (]: On test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279: Close
[0m11:07:55.214596 [debug] [Thread-2 (]: Using postgres connection "test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2"
[0m11:07:55.224633 [debug] [Thread-2 (]: On test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2: BEGIN
[0m11:07:55.224036 [debug] [Thread-1 (]: Writing injected SQL for node "test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c"
[0m11:07:55.228197 [debug] [Thread-1 (]: Began executing node test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m11:07:55.225133 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:07:55.222908 [info ] [Thread-4 (]: 11 of 11 START test unique_shipping_dim_ship_id ................................ [RUN]
[0m11:07:55.234925 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721, now test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7)
[0m11:07:55.235611 [debug] [Thread-4 (]: Began compiling node test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m11:07:55.223638 [info ] [Thread-3 (]: 7 of 11 PASS relationships_sales_fact_cust_id__cust_id__ref_customer_dim_ ...... [[32mPASS[0m in 0.16s]
[0m11:07:55.246877 [debug] [Thread-3 (]: Finished running node test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m11:07:55.234098 [debug] [Thread-1 (]: Writing runtime sql for node "test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c"
[0m11:07:55.248287 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c"
[0m11:07:55.248774 [debug] [Thread-1 (]: On test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c: BEGIN
[0m11:07:55.258162 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:07:55.268015 [debug] [Thread-2 (]: SQL status: BEGIN in 0.043 seconds
[0m11:07:55.268697 [debug] [Thread-2 (]: Using postgres connection "test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2"
[0m11:07:55.264711 [debug] [Thread-4 (]: Writing injected SQL for node "test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7"
[0m11:07:55.272627 [debug] [Thread-2 (]: On test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    geo_id as unique_field,
    count(*) as n_records

from "superstore"."dw_test"."geo_dim"
where geo_id is not null
group by geo_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:07:55.274126 [debug] [Thread-4 (]: Began executing node test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m11:07:55.274594 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m11:07:55.283888 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c"
[0m11:07:55.281873 [debug] [Thread-4 (]: Writing runtime sql for node "test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7"
[0m11:07:55.277273 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m11:07:55.284494 [debug] [Thread-1 (]: On test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    prod_id as unique_field,
    count(*) as n_records

from "superstore"."dw_test"."product_dim"
where prod_id is not null
group by prod_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:07:55.287669 [debug] [Thread-2 (]: On test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2: ROLLBACK
[0m11:07:55.289742 [debug] [Thread-4 (]: Using postgres connection "test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7"
[0m11:07:55.292572 [debug] [Thread-4 (]: On test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7: BEGIN
[0m11:07:55.294248 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:07:55.293167 [debug] [Thread-2 (]: On test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2: Close
[0m11:07:55.296053 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m11:07:55.297644 [debug] [Thread-1 (]: On test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c: ROLLBACK
[0m11:07:55.295628 [info ] [Thread-2 (]: 9 of 11 PASS unique_geo_dim_geo_id ............................................. [[32mPASS[0m in 0.13s]
[0m11:07:55.299037 [debug] [Thread-2 (]: Finished running node test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m11:07:55.299781 [debug] [Thread-1 (]: On test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c: Close
[0m11:07:55.302259 [info ] [Thread-1 (]: 10 of 11 PASS unique_product_dim_prod_id ....................................... [[32mPASS[0m in 0.09s]
[0m11:07:55.306218 [debug] [Thread-1 (]: Finished running node test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m11:07:55.314325 [debug] [Thread-4 (]: SQL status: BEGIN in 0.020 seconds
[0m11:07:55.315248 [debug] [Thread-4 (]: Using postgres connection "test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7"
[0m11:07:55.315849 [debug] [Thread-4 (]: On test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    ship_id as unique_field,
    count(*) as n_records

from "superstore"."dw_test"."shipping_dim"
where ship_id is not null
group by ship_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:07:55.321790 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m11:07:55.324289 [debug] [Thread-4 (]: On test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7: ROLLBACK
[0m11:07:55.326700 [debug] [Thread-4 (]: On test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7: Close
[0m11:07:55.328394 [info ] [Thread-4 (]: 11 of 11 PASS unique_shipping_dim_ship_id ...................................... [[32mPASS[0m in 0.09s]
[0m11:07:55.330789 [debug] [Thread-4 (]: Finished running node test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m11:07:55.334948 [debug] [MainThread]: Using postgres connection "master"
[0m11:07:55.335556 [debug] [MainThread]: On master: BEGIN
[0m11:07:55.336200 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:07:55.352977 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m11:07:55.356411 [debug] [MainThread]: On master: COMMIT
[0m11:07:55.356840 [debug] [MainThread]: Using postgres connection "master"
[0m11:07:55.358155 [debug] [MainThread]: On master: COMMIT
[0m11:07:55.360107 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:07:55.362215 [debug] [MainThread]: On master: Close
[0m11:07:55.365414 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:07:55.366140 [debug] [MainThread]: Connection 'test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c' was properly closed.
[0m11:07:55.366592 [debug] [MainThread]: Connection 'test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2' was properly closed.
[0m11:07:55.367081 [debug] [MainThread]: Connection 'test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279' was properly closed.
[0m11:07:55.367475 [debug] [MainThread]: Connection 'test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7' was properly closed.
[0m11:07:55.368134 [info ] [MainThread]: 
[0m11:07:55.368699 [info ] [MainThread]: Finished running 11 data tests in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m11:07:55.372615 [debug] [MainThread]: Command end result
[0m11:07:55.411357 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/manifest.json
[0m11:07:55.413376 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/semantic_manifest.json
[0m11:07:55.430647 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dev/Downloads/pde_magistr/superstore_dwh/target/run_results.json
[0m11:07:55.431242 [info ] [MainThread]: 
[0m11:07:55.432059 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:07:55.433718 [info ] [MainThread]: 
[0m11:07:55.434390 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=11
[0m11:07:55.435665 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.5439292, "process_in_blocks": "312", "process_kernel_time": 0.216882, "process_mem_max_rss": "120152", "process_out_blocks": "2200", "process_user_time": 2.375523}
[0m11:07:55.437758 [debug] [MainThread]: Command `dbt test` succeeded at 11:07:55.436421 after 1.55 seconds
[0m11:07:55.438318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d024b7a9900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0249f85ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d024a76a110>]}
[0m11:07:55.438792 [debug] [MainThread]: Flushing usage events
[0m11:07:56.129591 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:08:21.106123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71eb080b9900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71eb0707c220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71eb0707c1c0>]}


============================== 11:08:21.108877 | c7f825ae-28b4-4443-8fce-646c5af544fb ==============================
[0m11:08:21.108877 [info ] [MainThread]: Running with dbt=1.10.11
[0m11:08:21.109608 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt test', 'warn_error': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'use_colors': 'True', 'debug': 'False', 'profiles_dir': '/home/dev/.dbt', 'write_json': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'empty': 'None', 'introspect': 'True', 'log_format': 'default', 'partial_parse': 'True', 'log_path': '/home/dev/Downloads/pde_magistr/superstore_dwh/logs', 'quiet': 'False', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'printer_width': '80'}
[0m11:08:21.284253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7f825ae-28b4-4443-8fce-646c5af544fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71eb0701fa90>]}
[0m11:08:21.352795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7f825ae-28b4-4443-8fce-646c5af544fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71eb0707e110>]}
[0m11:08:21.353705 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m11:08:21.457698 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m11:08:21.598003 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:08:21.598902 [debug] [MainThread]: Partial parsing: updated file: superstore_dwh://models/marts/schema.yml
[0m11:08:22.104113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7f825ae-28b4-4443-8fce-646c5af544fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71eb04d81510>]}
[0m11:08:22.203076 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/manifest.json
[0m11:08:22.205290 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/semantic_manifest.json
[0m11:08:22.226507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7f825ae-28b4-4443-8fce-646c5af544fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71eb04d6a290>]}
[0m11:08:22.227213 [info ] [MainThread]: Found 8 models, 12 data tests, 1 source, 435 macros
[0m11:08:22.227713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7f825ae-28b4-4443-8fce-646c5af544fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71eb04d6b0a0>]}
[0m11:08:22.229892 [info ] [MainThread]: 
[0m11:08:22.230404 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:08:22.230839 [info ] [MainThread]: 
[0m11:08:22.231493 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:08:22.236612 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore_dw_test'
[0m11:08:22.247540 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore_stg'
[0m11:08:22.272826 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_test"
[0m11:08:22.273441 [debug] [ThreadPool]: On list_superstore_dw_test: BEGIN
[0m11:08:22.274185 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:08:22.277357 [debug] [ThreadPool]: Using postgres connection "list_superstore_stg"
[0m11:08:22.277902 [debug] [ThreadPool]: On list_superstore_stg: BEGIN
[0m11:08:22.278352 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:08:22.283036 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m11:08:22.283709 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_test"
[0m11:08:22.284208 [debug] [ThreadPool]: On list_superstore_dw_test: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore_dw_test"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_test'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_test'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_test'
  
[0m11:08:22.287018 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m11:08:22.288549 [debug] [ThreadPool]: On list_superstore_dw_test: ROLLBACK
[0m11:08:22.291290 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m11:08:22.294223 [debug] [ThreadPool]: Using postgres connection "list_superstore_stg"
[0m11:08:22.294682 [debug] [ThreadPool]: On list_superstore_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore_stg"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'stg'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'stg'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'stg'
  
[0m11:08:22.293711 [debug] [ThreadPool]: On list_superstore_dw_test: Close
[0m11:08:22.298268 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m11:08:22.299710 [debug] [ThreadPool]: On list_superstore_stg: ROLLBACK
[0m11:08:22.302551 [debug] [ThreadPool]: On list_superstore_stg: Close
[0m11:08:22.309904 [debug] [MainThread]: Using postgres connection "master"
[0m11:08:22.310390 [debug] [MainThread]: On master: BEGIN
[0m11:08:22.310816 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:08:22.318388 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m11:08:22.318977 [debug] [MainThread]: Using postgres connection "master"
[0m11:08:22.319551 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m11:08:22.323508 [debug] [MainThread]: SQL status: SELECT 3 in 0.003 seconds
[0m11:08:22.325611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7f825ae-28b4-4443-8fce-646c5af544fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71eb04d6b5e0>]}
[0m11:08:22.326319 [debug] [MainThread]: On master: ROLLBACK
[0m11:08:22.327143 [debug] [MainThread]: Using postgres connection "master"
[0m11:08:22.327632 [debug] [MainThread]: On master: BEGIN
[0m11:08:22.328485 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:08:22.329054 [debug] [MainThread]: On master: COMMIT
[0m11:08:22.329481 [debug] [MainThread]: Using postgres connection "master"
[0m11:08:22.329952 [debug] [MainThread]: On master: COMMIT
[0m11:08:22.330635 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:08:22.331094 [debug] [MainThread]: On master: Close
[0m11:08:22.336685 [debug] [Thread-1 (]: Began running node test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m11:08:22.338138 [debug] [Thread-2 (]: Began running node test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m11:08:22.339182 [debug] [Thread-3 (]: Began running node test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029
[0m11:08:22.339915 [debug] [Thread-4 (]: Began running node test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209
[0m11:08:22.337439 [info ] [Thread-1 (]: 1 of 12 START test not_null_customer_dim_cust_id ............................... [RUN]
[0m11:08:22.344379 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_superstore_dw_test, now test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42)
[0m11:08:22.344993 [debug] [Thread-1 (]: Began compiling node test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m11:08:22.338681 [info ] [Thread-2 (]: 2 of 12 START test not_null_geo_dim_geo_id ..................................... [RUN]
[0m11:08:22.340494 [info ] [Thread-3 (]: 3 of 12 START test not_null_mart_order_processing_time_avg_processing_days ..... [RUN]
[0m11:08:22.354072 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029'
[0m11:08:22.353162 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_superstore_stg, now test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d)
[0m11:08:22.342886 [info ] [Thread-4 (]: 4 of 12 START test not_null_mart_order_processing_time_sub_category ............ [RUN]
[0m11:08:22.354647 [debug] [Thread-3 (]: Began compiling node test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029
[0m11:08:22.367836 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209'
[0m11:08:22.367051 [debug] [Thread-2 (]: Began compiling node test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m11:08:22.366424 [debug] [Thread-1 (]: Writing injected SQL for node "test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42"
[0m11:08:22.380396 [debug] [Thread-1 (]: Began executing node test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m11:08:22.373222 [debug] [Thread-3 (]: Writing injected SQL for node "test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029"
[0m11:08:22.373879 [debug] [Thread-4 (]: Began compiling node test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209
[0m11:08:22.392232 [debug] [Thread-4 (]: Writing injected SQL for node "test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209"
[0m11:08:22.394225 [debug] [Thread-2 (]: Writing injected SQL for node "test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d"
[0m11:08:22.402774 [debug] [Thread-2 (]: Began executing node test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m11:08:22.401610 [debug] [Thread-3 (]: Began executing node test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029
[0m11:08:22.412156 [debug] [Thread-1 (]: Writing runtime sql for node "test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42"
[0m11:08:22.415831 [debug] [Thread-4 (]: Began executing node test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209
[0m11:08:22.416758 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42"
[0m11:08:22.422839 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42: BEGIN
[0m11:08:22.423302 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:08:22.418435 [debug] [Thread-2 (]: Writing runtime sql for node "test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d"
[0m11:08:22.414781 [debug] [Thread-3 (]: Writing runtime sql for node "test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029"
[0m11:08:22.426258 [debug] [Thread-3 (]: Using postgres connection "test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029"
[0m11:08:22.426770 [debug] [Thread-3 (]: On test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029: BEGIN
[0m11:08:22.427256 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:08:22.421584 [debug] [Thread-4 (]: Writing runtime sql for node "test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209"
[0m11:08:22.428949 [debug] [Thread-4 (]: Using postgres connection "test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209"
[0m11:08:22.429717 [debug] [Thread-4 (]: On test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209: BEGIN
[0m11:08:22.424422 [debug] [Thread-2 (]: Using postgres connection "test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d"
[0m11:08:22.433111 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d: BEGIN
[0m11:08:22.433571 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:08:22.430142 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:08:22.441941 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m11:08:22.444453 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42"
[0m11:08:22.444917 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select cust_id
from "superstore"."dw_test"."customer_dim"
where cust_id is null



  
  
      
    ) dbt_internal_test
[0m11:08:22.453070 [debug] [Thread-3 (]: SQL status: BEGIN in 0.026 seconds
[0m11:08:22.453708 [debug] [Thread-3 (]: Using postgres connection "test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029"
[0m11:08:22.456867 [debug] [Thread-3 (]: On test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_processing_days
from "superstore"."dw_test"."mart_order_processing_time"
where avg_processing_days is null



  
  
      
    ) dbt_internal_test
[0m11:08:22.457883 [debug] [Thread-4 (]: SQL status: BEGIN in 0.028 seconds
[0m11:08:22.459491 [debug] [Thread-2 (]: SQL status: BEGIN in 0.026 seconds
[0m11:08:22.460648 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.011 seconds
[0m11:08:22.461187 [debug] [Thread-4 (]: Using postgres connection "test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209"
[0m11:08:22.460165 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m11:08:22.461810 [debug] [Thread-2 (]: Using postgres connection "test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d"
[0m11:08:22.467719 [debug] [Thread-4 (]: On test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sub_category
from "superstore"."dw_test"."mart_order_processing_time"
where sub_category is null



  
  
      
    ) dbt_internal_test
[0m11:08:22.466931 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42: ROLLBACK
[0m11:08:22.470879 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select geo_id
from "superstore"."dw_test"."geo_dim"
where geo_id is null



  
  
      
    ) dbt_internal_test
[0m11:08:22.470147 [debug] [Thread-3 (]: On test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029: ROLLBACK
[0m11:08:22.472611 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42: Close
[0m11:08:22.473813 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m11:08:22.474447 [debug] [Thread-3 (]: On test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029: Close
[0m11:08:22.476230 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m11:08:22.478531 [debug] [Thread-4 (]: On test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209: ROLLBACK
[0m11:08:22.475537 [info ] [Thread-1 (]: 1 of 12 PASS not_null_customer_dim_cust_id ..................................... [[32mPASS[0m in 0.13s]
[0m11:08:22.481334 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d: ROLLBACK
[0m11:08:22.479676 [info ] [Thread-3 (]: 3 of 12 PASS not_null_mart_order_processing_time_avg_processing_days ........... [[32mPASS[0m in 0.13s]
[0m11:08:22.483580 [debug] [Thread-4 (]: On test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209: Close
[0m11:08:22.484557 [debug] [Thread-1 (]: Finished running node test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m11:08:22.485410 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d: Close
[0m11:08:22.488499 [info ] [Thread-4 (]: 4 of 12 PASS not_null_mart_order_processing_time_sub_category .................. [[32mPASS[0m in 0.12s]
[0m11:08:22.489230 [debug] [Thread-4 (]: Finished running node test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209
[0m11:08:22.487130 [debug] [Thread-1 (]: Began running node test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688
[0m11:08:22.486260 [debug] [Thread-3 (]: Finished running node test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029
[0m11:08:22.492515 [debug] [Thread-3 (]: Began running node test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m11:08:22.489738 [debug] [Thread-4 (]: Began running node test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m11:08:22.491409 [info ] [Thread-1 (]: 5 of 12 START test not_null_product_dim_prod_id ................................ [RUN]
[0m11:08:22.494670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42, now test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688)
[0m11:08:22.495463 [debug] [Thread-1 (]: Began compiling node test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688
[0m11:08:22.503891 [debug] [Thread-1 (]: Writing injected SQL for node "test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688"
[0m11:08:22.493016 [info ] [Thread-3 (]: 7 of 12 START test relationships_sales_fact_cust_id__cust_id__ref_customer_dim_  [RUN]
[0m11:08:22.506331 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_mart_order_processing_time_avg_processing_days.0bee138029, now test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279)
[0m11:08:22.506845 [debug] [Thread-3 (]: Began compiling node test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m11:08:22.493606 [info ] [Thread-2 (]: 2 of 12 PASS not_null_geo_dim_geo_id ........................................... [[32mPASS[0m in 0.14s]
[0m11:08:22.512729 [debug] [Thread-2 (]: Finished running node test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m11:08:22.493993 [info ] [Thread-4 (]: 6 of 12 START test not_null_shipping_dim_ship_id ............................... [RUN]
[0m11:08:22.525316 [debug] [Thread-3 (]: Writing injected SQL for node "test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"
[0m11:08:22.513366 [debug] [Thread-1 (]: Began executing node test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688
[0m11:08:22.526029 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_mart_order_processing_time_sub_category.04d9956209, now test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d)
[0m11:08:22.536398 [debug] [Thread-4 (]: Began compiling node test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m11:08:22.531457 [debug] [Thread-1 (]: Writing runtime sql for node "test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688"
[0m11:08:22.532546 [debug] [Thread-3 (]: Began executing node test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m11:08:22.525619 [debug] [Thread-2 (]: Began running node test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721
[0m11:08:22.543963 [debug] [Thread-4 (]: Writing injected SQL for node "test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d"
[0m11:08:22.549082 [debug] [Thread-4 (]: Began executing node test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m11:08:22.546952 [debug] [Thread-3 (]: Writing runtime sql for node "test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"
[0m11:08:22.547696 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688"
[0m11:08:22.548215 [info ] [Thread-2 (]: 8 of 12 START test unique_customer_dim_cust_id ................................. [RUN]
[0m11:08:22.551642 [debug] [Thread-4 (]: Writing runtime sql for node "test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d"
[0m11:08:22.553696 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d, now test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721)
[0m11:08:22.552523 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688: BEGIN
[0m11:08:22.554865 [debug] [Thread-4 (]: Using postgres connection "test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d"
[0m11:08:22.557889 [debug] [Thread-4 (]: On test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d: BEGIN
[0m11:08:22.558697 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:08:22.556295 [debug] [Thread-3 (]: Using postgres connection "test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"
[0m11:08:22.559554 [debug] [Thread-3 (]: On test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279: BEGIN
[0m11:08:22.556799 [debug] [Thread-2 (]: Began compiling node test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721
[0m11:08:22.557322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:08:22.560109 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:08:22.575118 [debug] [Thread-2 (]: Writing injected SQL for node "test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721"
[0m11:08:22.579021 [debug] [Thread-2 (]: Began executing node test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721
[0m11:08:22.576305 [debug] [Thread-4 (]: SQL status: BEGIN in 0.018 seconds
[0m11:08:22.585880 [debug] [Thread-2 (]: Writing runtime sql for node "test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721"
[0m11:08:22.586703 [debug] [Thread-4 (]: Using postgres connection "test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d"
[0m11:08:22.589721 [debug] [Thread-4 (]: On test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ship_id
from "superstore"."dw_test"."shipping_dim"
where ship_id is null



  
  
      
    ) dbt_internal_test
[0m11:08:22.589110 [debug] [Thread-2 (]: Using postgres connection "test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721"
[0m11:08:22.591418 [debug] [Thread-2 (]: On test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721: BEGIN
[0m11:08:22.592083 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:08:22.595675 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m11:08:22.609615 [debug] [Thread-4 (]: On test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d: ROLLBACK
[0m11:08:22.615336 [debug] [Thread-4 (]: On test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d: Close
[0m11:08:22.614197 [debug] [Thread-3 (]: SQL status: BEGIN in 0.054 seconds
[0m11:08:22.613617 [debug] [Thread-1 (]: SQL status: BEGIN in 0.056 seconds
[0m11:08:22.616172 [debug] [Thread-2 (]: SQL status: BEGIN in 0.024 seconds
[0m11:08:22.618686 [debug] [Thread-3 (]: Using postgres connection "test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"
[0m11:08:22.624391 [debug] [Thread-3 (]: On test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select cust_id as from_field
    from "superstore"."dw_test"."sales_fact"
    where cust_id is not null
),

parent as (
    select cust_id as to_field
    from "superstore"."dw_test"."customer_dim"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m11:08:22.621107 [info ] [Thread-4 (]: 6 of 12 PASS not_null_shipping_dim_ship_id ..................................... [[32mPASS[0m in 0.10s]
[0m11:08:22.619688 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688"
[0m11:08:22.628197 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select prod_id
from "superstore"."dw_test"."product_dim"
where prod_id is null



  
  
      
    ) dbt_internal_test
[0m11:08:22.623712 [debug] [Thread-2 (]: Using postgres connection "test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721"
[0m11:08:22.629185 [debug] [Thread-2 (]: On test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    cust_id as unique_field,
    count(*) as n_records

from "superstore"."dw_test"."customer_dim"
where cust_id is not null
group by cust_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:08:22.625258 [debug] [Thread-4 (]: Finished running node test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m11:08:22.630487 [debug] [Thread-4 (]: Began running node test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m11:08:22.631056 [info ] [Thread-4 (]: 9 of 12 START test unique_geo_dim_geo_id ....................................... [RUN]
[0m11:08:22.633174 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d, now test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2)
[0m11:08:22.635142 [debug] [Thread-4 (]: Began compiling node test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m11:08:22.636226 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.006 seconds
[0m11:08:22.637282 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.012 seconds
[0m11:08:22.651913 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.023 seconds
[0m11:08:22.653778 [debug] [Thread-2 (]: On test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721: ROLLBACK
[0m11:08:22.647138 [debug] [Thread-4 (]: Writing injected SQL for node "test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2"
[0m11:08:22.666569 [debug] [Thread-4 (]: Began executing node test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m11:08:22.659961 [debug] [Thread-3 (]: On test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279: ROLLBACK
[0m11:08:22.663663 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688: ROLLBACK
[0m11:08:22.677225 [debug] [Thread-2 (]: On test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721: Close
[0m11:08:22.678111 [debug] [Thread-4 (]: Writing runtime sql for node "test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2"
[0m11:08:22.679938 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688: Close
[0m11:08:22.681341 [info ] [Thread-2 (]: 8 of 12 PASS unique_customer_dim_cust_id ....................................... [[32mPASS[0m in 0.13s]
[0m11:08:22.680460 [debug] [Thread-3 (]: On test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279: Close
[0m11:08:22.683175 [debug] [Thread-4 (]: Using postgres connection "test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2"
[0m11:08:22.692406 [debug] [Thread-4 (]: On test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2: BEGIN
[0m11:08:22.684314 [info ] [Thread-1 (]: 5 of 12 PASS not_null_product_dim_prod_id ...................................... [[32mPASS[0m in 0.19s]
[0m11:08:22.697965 [debug] [Thread-1 (]: Finished running node test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688
[0m11:08:22.685004 [debug] [Thread-2 (]: Finished running node test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721
[0m11:08:22.702397 [debug] [Thread-2 (]: Began running node test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m11:08:22.691696 [info ] [Thread-3 (]: 7 of 12 PASS relationships_sales_fact_cust_id__cust_id__ref_customer_dim_ ...... [[32mPASS[0m in 0.19s]
[0m11:08:22.700253 [debug] [Thread-1 (]: Began running node test.superstore_dwh.unique_mart_order_processing_time_sub_category.4a0f8bf28a
[0m11:08:22.697097 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:08:22.703087 [info ] [Thread-2 (]: 11 of 12 START test unique_product_dim_prod_id ................................. [RUN]
[0m11:08:22.703944 [debug] [Thread-3 (]: Finished running node test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m11:08:22.709906 [debug] [Thread-3 (]: Began running node test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m11:08:22.704780 [info ] [Thread-1 (]: 10 of 12 START test unique_mart_order_processing_time_sub_category ............. [RUN]
[0m11:08:22.707915 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721, now test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c)
[0m11:08:22.714058 [debug] [Thread-2 (]: Began compiling node test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m11:08:22.713443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688, now test.superstore_dwh.unique_mart_order_processing_time_sub_category.4a0f8bf28a)
[0m11:08:22.711473 [info ] [Thread-3 (]: 12 of 12 START test unique_shipping_dim_ship_id ................................ [RUN]
[0m11:08:22.721816 [debug] [Thread-1 (]: Began compiling node test.superstore_dwh.unique_mart_order_processing_time_sub_category.4a0f8bf28a
[0m11:08:22.725714 [debug] [Thread-2 (]: Writing injected SQL for node "test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c"
[0m11:08:22.726518 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279, now test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7)
[0m11:08:22.731451 [debug] [Thread-1 (]: Writing injected SQL for node "test.superstore_dwh.unique_mart_order_processing_time_sub_category.4a0f8bf28a"
[0m11:08:22.732319 [debug] [Thread-4 (]: SQL status: BEGIN in 0.038 seconds
[0m11:08:22.732947 [debug] [Thread-2 (]: Began executing node test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m11:08:22.733785 [debug] [Thread-3 (]: Began compiling node test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m11:08:22.735073 [debug] [Thread-4 (]: Using postgres connection "test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2"
[0m11:08:22.759578 [debug] [Thread-4 (]: On test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    geo_id as unique_field,
    count(*) as n_records

from "superstore"."dw_test"."geo_dim"
where geo_id is not null
group by geo_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:08:22.757364 [debug] [Thread-1 (]: Began executing node test.superstore_dwh.unique_mart_order_processing_time_sub_category.4a0f8bf28a
[0m11:08:22.746116 [debug] [Thread-2 (]: Writing runtime sql for node "test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c"
[0m11:08:22.758754 [debug] [Thread-3 (]: Writing injected SQL for node "test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7"
[0m11:08:22.764674 [debug] [Thread-1 (]: Writing runtime sql for node "test.superstore_dwh.unique_mart_order_processing_time_sub_category.4a0f8bf28a"
[0m11:08:22.765374 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m11:08:22.767512 [debug] [Thread-4 (]: On test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2: ROLLBACK
[0m11:08:22.768762 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.unique_mart_order_processing_time_sub_category.4a0f8bf28a"
[0m11:08:22.770027 [debug] [Thread-1 (]: On test.superstore_dwh.unique_mart_order_processing_time_sub_category.4a0f8bf28a: BEGIN
[0m11:08:22.771031 [debug] [Thread-4 (]: On test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2: Close
[0m11:08:22.774235 [debug] [Thread-3 (]: Began executing node test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m11:08:22.772042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:08:22.772830 [debug] [Thread-2 (]: Using postgres connection "test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c"
[0m11:08:22.780191 [debug] [Thread-2 (]: On test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c: BEGIN
[0m11:08:22.779253 [info ] [Thread-4 (]: 9 of 12 PASS unique_geo_dim_geo_id ............................................. [[32mPASS[0m in 0.15s]
[0m11:08:22.778494 [debug] [Thread-3 (]: Writing runtime sql for node "test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7"
[0m11:08:22.786985 [debug] [Thread-3 (]: Using postgres connection "test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7"
[0m11:08:22.782325 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:08:22.783971 [debug] [Thread-4 (]: Finished running node test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m11:08:22.787723 [debug] [Thread-3 (]: On test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7: BEGIN
[0m11:08:22.792756 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:08:22.796475 [debug] [Thread-1 (]: SQL status: BEGIN in 0.025 seconds
[0m11:08:22.797075 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.unique_mart_order_processing_time_sub_category.4a0f8bf28a"
[0m11:08:22.798092 [debug] [Thread-1 (]: On test.superstore_dwh.unique_mart_order_processing_time_sub_category.4a0f8bf28a: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.unique_mart_order_processing_time_sub_category.4a0f8bf28a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    sub_category as unique_field,
    count(*) as n_records

from "superstore"."dw_test"."mart_order_processing_time"
where sub_category is not null
group by sub_category
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:08:22.801170 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m11:08:22.802706 [debug] [Thread-1 (]: On test.superstore_dwh.unique_mart_order_processing_time_sub_category.4a0f8bf28a: ROLLBACK
[0m11:08:22.805833 [debug] [Thread-1 (]: On test.superstore_dwh.unique_mart_order_processing_time_sub_category.4a0f8bf28a: Close
[0m11:08:22.812454 [info ] [Thread-1 (]: 10 of 12 PASS unique_mart_order_processing_time_sub_category ................... [[32mPASS[0m in 0.10s]
[0m11:08:22.817370 [debug] [Thread-1 (]: Finished running node test.superstore_dwh.unique_mart_order_processing_time_sub_category.4a0f8bf28a
[0m11:08:22.815703 [debug] [Thread-3 (]: SQL status: BEGIN in 0.023 seconds
[0m11:08:22.814585 [debug] [Thread-2 (]: SQL status: BEGIN in 0.032 seconds
[0m11:08:22.819499 [debug] [Thread-2 (]: Using postgres connection "test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c"
[0m11:08:22.823196 [debug] [Thread-2 (]: On test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    prod_id as unique_field,
    count(*) as n_records

from "superstore"."dw_test"."product_dim"
where prod_id is not null
group by prod_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:08:22.818570 [debug] [Thread-3 (]: Using postgres connection "test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7"
[0m11:08:22.824234 [debug] [Thread-3 (]: On test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    ship_id as unique_field,
    count(*) as n_records

from "superstore"."dw_test"."shipping_dim"
where ship_id is not null
group by ship_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:08:22.827416 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m11:08:22.828197 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m11:08:22.829775 [debug] [Thread-3 (]: On test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7: ROLLBACK
[0m11:08:22.831252 [debug] [Thread-2 (]: On test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c: ROLLBACK
[0m11:08:22.832090 [debug] [Thread-3 (]: On test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7: Close
[0m11:08:22.835861 [debug] [Thread-2 (]: On test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c: Close
[0m11:08:22.834742 [info ] [Thread-3 (]: 12 of 12 PASS unique_shipping_dim_ship_id ...................................... [[32mPASS[0m in 0.11s]
[0m11:08:22.837587 [debug] [Thread-3 (]: Finished running node test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m11:08:22.838768 [info ] [Thread-2 (]: 11 of 12 PASS unique_product_dim_prod_id ....................................... [[32mPASS[0m in 0.13s]
[0m11:08:22.840392 [debug] [Thread-2 (]: Finished running node test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m11:08:22.844774 [debug] [MainThread]: Using postgres connection "master"
[0m11:08:22.845469 [debug] [MainThread]: On master: BEGIN
[0m11:08:22.845867 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:08:22.854622 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m11:08:22.855439 [debug] [MainThread]: On master: COMMIT
[0m11:08:22.855936 [debug] [MainThread]: Using postgres connection "master"
[0m11:08:22.856520 [debug] [MainThread]: On master: COMMIT
[0m11:08:22.859223 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m11:08:22.859870 [debug] [MainThread]: On master: Close
[0m11:08:22.863670 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:08:22.867714 [debug] [MainThread]: Connection 'test.superstore_dwh.unique_mart_order_processing_time_sub_category.4a0f8bf28a' was properly closed.
[0m11:08:22.868300 [debug] [MainThread]: Connection 'test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c' was properly closed.
[0m11:08:22.871626 [debug] [MainThread]: Connection 'test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7' was properly closed.
[0m11:08:22.872152 [debug] [MainThread]: Connection 'test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2' was properly closed.
[0m11:08:22.872670 [info ] [MainThread]: 
[0m11:08:22.874314 [info ] [MainThread]: Finished running 12 data tests in 0 hours 0 minutes and 0.64 seconds (0.64s).
[0m11:08:22.882841 [debug] [MainThread]: Command end result
[0m11:08:22.953347 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/manifest.json
[0m11:08:22.962940 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/semantic_manifest.json
[0m11:08:23.000910 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dev/Downloads/pde_magistr/superstore_dwh/target/run_results.json
[0m11:08:23.001563 [info ] [MainThread]: 
[0m11:08:23.008536 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:08:23.009198 [info ] [MainThread]: 
[0m11:08:23.011419 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=12
[0m11:08:23.012478 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.9699538, "process_in_blocks": "16", "process_kernel_time": 0.21182, "process_mem_max_rss": "125484", "process_out_blocks": "3128", "process_user_time": 2.657565}
[0m11:08:23.019065 [debug] [MainThread]: Command `dbt test` succeeded at 11:08:23.012901 after 1.97 seconds
[0m11:08:23.019775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71eb080b9900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71eb05571630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71eb08c340d0>]}
[0m11:08:23.020338 [debug] [MainThread]: Flushing usage events
[0m11:08:23.686769 [debug] [MainThread]: An error was encountered while trying to flush usage events
